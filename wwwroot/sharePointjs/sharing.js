function $_global_sharing(){if("undefined"==typeof g_all_modules)g_all_modules={};g_all_modules["sharing.js"]={version:{rmj:16,rmm:0,rup:24016,rpr:12006}};typeof spWriteProfilerMark=="function"&&spWriteProfilerMark("perfMarkBegin_sharing.js");if(typeof ElementCreator==="undefined")ElementCreator=function(d,b){var a=Boolean(b)?b:document.createElement("textarea");switch(d.toLowerCase()){case"textarea":c()}return a;function c(){var i="placeholder"in a,e;if(i){var g=document.createElement("div");g.className="ms-helperText ms-hide";document.body.appendChild(g);var j=CSSUtil.getCurrentStyleCorrect(g,"color","color");document.body.removeChild(g);var h=false,o=document.getElementsByTagName("head")[0],b=document.createElement("style");b.type="text/css";var c="::-webkit-input-placeholder { color:#color; } ::-moz-placeholder { color:#color; opacity:1; } :-ms-input-placeholder { color:#color; } input:-moz-placeholder { color:#color; opacity:1; }";c=c.replace(/#color/g,j);try{if(typeof b.styleSheet!="undefined"&&b.styleSheet!=null&&typeof b.styleSheet.cssText!="undefined"){b.styleSheet.cssText=c;h=true}}catch(p){}!h&&b.appendChild(document.createTextNode(c));o.appendChild(b)}else{var f=true,d="";a.setAttribute("value","");Object.defineProperty(Object(a),"placeholder",{"get":function(){return d},"set":function(b){d=b;e(a.value);return d}});Object.defineProperty(Object(a),"value",{"get":function(){return f?"":a.innerText},"set":function(b){e(b);return a.value}});var m=a.getAttribute;a.getAttribute=function(b){var c=b!=null?b.toLowerCase():null;return c=="value"?this.value:m.call(a,b)};var n=a.setAttribute;a.setAttribute=function(b,c){var d=b!=null?b.toLowerCase():null;if(d=="placeholder")this.placeholder=c;else n.call(a,b,c)};e=function(b){f=b==""||b==null;if(f){CSSUtil.AddClass(a,"ms-helperText");a.innerText=d}else{CSSUtil.RemoveClass(a,"ms-helperText");a.innerText=b}};var k=function(){if(f){CSSUtil.RemoveClass(a,"ms-helperText");a.innerText=""}},l=function(){e(a.innerText)};AddEvtHandler(a,"onfocus",k,false);AddEvtHandler(a,"onblur",l,false)}}};HtmlStrings={Empty:"",Quot:"&quot;",Amp:"&amp;",Apostrophe:"&#39;",Lt:"&lt;",Gt:"&gt;",Space:" ",Br:"<br />",Nbsp:"&#160;",B:"<b>",I:"<i>",U:"<u>",BClose:"</b>",IClose:"</i>",UClose:"</u>",Wbr:"<wbr />",Style:"<style>",StyleClose:"</style>",Cdata:"<![CDATA[",CdataClose:"]\]>"};simpleSiteSharingFeature=Flighting.VariantConfiguration.IsExpFeatureClientEnabled(451);oversharingMitigation=Flighting.VariantConfiguration.IsExpFeatureClientEnabled(724);enforceRequiredAnonymousLinksExpiration=false;SharingTabToShow={SharingDialog:0,GetLinks:1,SharedWith:2};SharingDialogReturnCode={Success:0,Cancel:1,Error:2};SharingRole={None:0,View:1,Edit:2,Owner:3,Review:6};SharingLinkKind={Uninitialized:0,Direct:1,OrganizationView:2,OrganizationEdit:3,AnonymousView:4,AnonymousEdit:5};SharingLinkExpirationValues={};(function(){function i(b){var d=null,a=null,c=null,p=b,e=new Renderer;j(e);g();this.open=function(){h();l();o()};this.close=function(){m();k()};this.setPendingState=function(d){if(!Boolean(a))return;var e=a.querySelector(".ms-confirmDialog-loadingImg");e.style.display=d?"inline":"none";for(var c=a.querySelectorAll(".ms-confirmDialog-button"),b=0;b<c.length;b++)c[b].disabled=d};function j(a){a.SetTemplate("overlay",'{%version 2.0}<div class="ms-confirmDialog-overlay"></div>');a.SetTemplate("root",'{%version 2.0}<div class="ms-confirmDialog-container ms-absoluteCenter" role="dialog"><div class="ms-confirmDialog-content"><div class="ms-confirmDialog-title">{=title}</div><div class="ms-confirmDialog-body">{=message}</div><div class="ms-confirmDialog-commandBar">{%template loadingImg}{%foreach buttonTemplate buttons}</div></div></div>');a.SetTemplate("loadingImg",'{%version 2.0}<img src="{=loadingImgUrl}" class="ms-confirmDialog-loadingImg" onclick="{+hideLoadingImage}" />');a.SetTemplate("buttonTemplate",'{%version 2.0}<input class="ms-confirmDialog-button" onclick="{+buttonClick .}" type="button" value="{=text}"></input>')}function g(){e.RegisterHandler("buttonClick",a);e.RegisterHandler("hideLoadingImage",b);function a(b,a){return a.onclick(b)}function b(){this.style.display="none"}}function n(b,c){var a=document.createElement("div");a.innerHTML=e.Render(b,c);return a.removeChild(a.firstChild)}function h(){if(Boolean(c))return;c=n("overlay");document.body.appendChild(c)}function k(){if(!Boolean(c))return;document.body.removeChild(c);c=null}function l(){d=document.createElement("div");var b=Accessibility.CreateTabLoopContainer(d),c=f();b.innerHTML=e.Render("root",c);a=b.firstChild;document.body.appendChild(d);Accessibility.FocusFirstTabStop(a)}function m(){document.body.removeChild(d);d=null;a=null}function f(){var a={};a.title=Encoding.HtmlEncode(b.title);a.message=Encoding.HtmlEncode(b.message);for(var d=[],c=0;c<b.buttons.length;c++){var f=Encoding.HtmlEncode(String(b.buttons[c].text)),e=b.buttons[c].onclick;d.push({text:f,onclick:e})}a.buttons=d;a.loadingImgUrl=i.Resources.LoadingImgUrl;return a}function o(){if(!Boolean(a))return;var b=a.querySelector(".ms-confirmDialog-content"),d=b.offsetWidth,c=b.offsetHeight;a.style.width=String(d)+"px";a.style.height=String(c)+"px"}}i.CreateStandardSettings=function(g,f,a,b){var c={text:i.Resources.GetString("L_ConfirmDialogDefaultConfirmText"),onclick:a},d={text:i.Resources.GetString("L_ConfirmDialogDefaultCancelText"),onclick:b},e={title:g,message:f,buttons:[c,d]};return e};i.Resources={};i.Resources.GetString=function(a){return window.Strings.STS[a]};i.Resources.LoadingImgUrl="/_layouts/15/images/loadingcirclests16.gif?rev=47";function sb(o,r,q,p){var c=o,f=r,e=q,d=p,b=false,a=null;this.Initialize=function(a){b=Boolean(a.CanBeUnshared);if(b){g();l()}};this.ShowLinkIfNeeded=function(){if(b)c.style.display="inline"};function g(){var b=k();a=new i(b)}function l(){c.addEventListener("click",h,false)}function h(){a.open()}function k(){var a=i.CreateStandardSettings(Strings.STS.L_StopSharingDialogTitle,Strings.STS.L_StopSharingDialogText,m,n);a.buttons[0].text=Strings.STS.L_StopSharing;a.buttons[1].text=Strings.STS.L_CancelButtonCaption;return a}function m(){a.setPendingState(true);UnshareObject(g,c,f,e,d);function g(){h();mb();a.close();DisplaySharedWithDialog(f,e,d);b()}function c(){a.close();DisplaySharedWithDialog(f,e,d);b()}function b(){var a=document.getElementById("lnkSharedWithDlg");Boolean(a)&&a.focus()}function h(){L_AnonymousViewLink=null;L_AnonymousEditLink=null;var a=GetManageLinkParams();j(a,SharingLinkKind.OrganizationView,null);j(a,SharingLinkKind.OrganizationEdit,null);j(a,SharingLinkKind.AnonymousView,null);j(a,SharingLinkKind.AnonymousEdit,null)}}function n(){a.close();c.focus()}}var X=function(){};X.prototype={showSharingHintImages:false,showSharedWithNoneLink:false,appendCountToSharedWithListUserLinkId:false,appendCountToSharedWithMoreLinkId:false,sharedWithListDivId:"",sharedWithListDivClass:"",sharedWithListImageId:"",sharedWithListImageClass:"",sharedWithListInnerSpanId:"",sharedWithListInnerSpanClass:"",sharedWithListUserLinkId:"",sharedWithListUserLinkClass:"",sharedWithNoneLinkId:"",sharedWithNoneLinkClass:"",sharedWithMoreLinkId:"",sharedWithMoreLinkClass:"",sharedWithManyLinkId:"",sharedWithManyLinkClass:"",guestLinkDivId:"",guestLinkDivClass:"",guestLinkImageId:"",guestLinkImageClass:"",guestLinkInnerSpanId:"",guestLinkInnerSpanClass:"",guestLinkId:"",guestLinkClass:"",guestLinkOnClickCallback:""};function jb(d,c){var a=new X;if(d){a.showSharingHintImages=!oversharingMitigation;a.showSharedWithNoneLink=true;a.appendCountToSharedWithListUserLinkId=true;a.appendCountToSharedWithMoreLinkId=true;a.sharedWithListDivClass="ms-core-form-line ms-textSmall";a.sharedWithListImageId="js-sharingdlg-imageUserAccess";a.sharedWithListImageClass="ms-verticalAlignTop";a.sharedWithListInnerSpanId="js-sharingdlg-labelUserAccess";a.sharedWithListInnerSpanClass="ms-aclinv-label ms-verticalAlignTop ms-soften";a.sharedWithListUserLinkId="js-sharingdlg-user";a.sharedWithNoneLinkId="js-sharingdlg-notshared";a.sharedWithNoneLinkClass="js-sharingdlg-sharedWithLink";a.sharedWithMoreLinkId="js-sharingdlg-nmore-";a.sharedWithMoreLinkClass="js-sharingdlg-sharedWithLink";a.sharedWithManyLinkId="js-sharingdlg-lotspeople";a.sharedWithManyLinkClass="js-sharingdlg-sharedWithLink";a.guestLinkDivId="js-sharingdlg-guestLinkDiv";a.guestLinkDivClass="ms-core-form-line ms-textSmall";a.guestLinkImageId="js-sharingdlg-imageGuestLink";a.guestLinkImageClass="ms-verticalAlignTop";a.guestLinkInnerSpanId="js-sharingdlg-labelGuestLink";a.guestLinkInnerSpanClass="ms-aclinv-label ms-verticalAlignTop ms-soften";a.guestLinkId="js-sharingdlg-guestLink";a.guestLinkClass="js-sharingdlg-guestLink";a.guestLinkOnClickCallback="ResizeDialogSuppressScrollBar(ManageLink);"}else{var b="";if(m$.isDefinedAndNotNull(c))b=GetCalloutElementIDFromCallout(c);a.sharedWithListDivClass="js-callout-sharedWithList";a.sharedWithListUserLinkClass="js-callout-sharedWithDisplayNameLink";a.showSharedWithNoneLink=true;a.sharedWithNoneLinkId=b+"js-callout-notshared";a.sharedWithNoneLinkClass="js-callout-sharedWithLink";a.sharedWithMoreLinkId=b+"SharedWithLink";a.sharedWithMoreLinkClass="js-callout-sharedWithLink";a.sharedWithManyLinkId=b+"SharedWithLink";a.sharedWithManyLinkClass="js-callout-sharedWithLink";a.guestLinkDivClass="js-callout-sharedWithManageLinks";a.guestLinkId=b+"GuestLink";a.guestLinkClass="js-callout-sharedWithGuestLink"}return a}function a(c,a){var b="";if(m$.isDefinedAndNotNull(a)&&a.length>0)b=" "+c+"="+StAttrQuote(a)+" ";return b}function tb(){return false}GetSharingStatusHtml=function(d,n,l,u,G,O,A,p,C,z,o,B,v){var b=jb(G,C),c=[],m="";if(d.length===0&&!l&&!n){if(!u){var r="",q="";if(b.showSharedWithNoneLink){r='<a href="#" onclick="return false;"'+a("id",b.sharedWithNoneLinkId)+a("class",b.sharedWithNoneLinkClass)+">";q="</a>"}c.push(r,Strings.STS.L_SharedWithNone,q);m="js-sharingHint-unshared"}}else{m="js-sharingHint-sharedDefault";var i="";if(isDefinedAndNotNullOrEmpty(A))i=StBuildParam(Strings.STS.L_SharedWithTooltip,A);if(Boolean(z)){var e=0,j=0,y=false;if(l||n){for(var k=0;k<d.length;k++)if(d[k].isDomainGroup){e++;if(tb(d[k])){y=true;break}}j=d.length-e}var g='<a tabIndex="999" href="#" onclick="return false;"'+a("id",b.sharedWithManyLinkId)+a("title",i)+a("class",b.sharedWithManyLinkClass)+">",f="</a>";if(y)c.push(StBuildParam(STSHtmlEncode(Strings.STS.L_SharedWithEveryOne),g,f));else if(e==0){var M=StBuildParam(SP.Utilities.LocUtility.getLocalizedCountValue(Encoding.HtmlEncode(Strings.STS.L_SharedWithNumPeople),Encoding.HtmlEncode(Strings.STS.L_SharedWithNumPeopleInterval),d.length),d.length);c.push(StBuildParam(STSHtmlEncode(Strings.STS.L_SharedWithGroupOrPeople),g+M+f))}else if(j==0){var N=StBuildParam(SP.Utilities.LocUtility.getLocalizedCountValue(Encoding.HtmlEncode(Strings.STS.L_SharedWithNumGroup),Encoding.HtmlEncode(Strings.STS.L_SharedWithNumGroupInterval),d.length),d.length);c.push(StBuildParam(STSHtmlEncode(Strings.STS.L_SharedWithGroupOrPeople),g+N+f))}else{var J=StBuildParam(SP.Utilities.LocUtility.getLocalizedCountValue(Encoding.HtmlEncode(Strings.STS.L_SharedWithNumGroup),Encoding.HtmlEncode(Strings.STS.L_SharedWithNumGroupInterval),e),e),I=StBuildParam(SP.Utilities.LocUtility.getLocalizedCountValue(Encoding.HtmlEncode(Strings.STS.L_SharedWithNumPeople),Encoding.HtmlEncode(Strings.STS.L_SharedWithNumPeopleInterval),j),j);c.push(StBuildParam(STSHtmlEncode(Strings.STS.L_SharedWithGroupPeople),g+J,I+f))}}else if(l||n){var E='<a href="#" onclick="return false;"'+a("id",b.sharedWithManyLinkId)+a("title",i)+a("class",b.sharedWithManyLinkClass)+">",D="</a>";c.push(StBuildParam(STSHtmlEncode(Strings.STS.L_SharedWithMany),E,D))}else{var L={HasUserLink:true,DefaultRender:true,AllowMultipleValues:true,InlineRender:true,InlineRenderMoreAsLink:true},P={EffectivePresenceEnabled:"1",PresenceAlt:Strings.STS.L_UserFieldNoUserPresenceAlt,UserDispUrl:O},F=GetReversedSharedWithUsers(d),H=d.length,h=document.createElement("div");EnsureScriptFunc("clienttemplates.js","UserFieldRenderer",function(){var f=new UserFieldRenderer("SharedWith");h.innerHTML=f.RenderField(p,L,{SharedWith:F},P);var d=0,a=m$(h).find(".ms-imnSpan");a.forEach(function(f){var e=b.sharedWithListUserLinkClass,c=b.sharedWithListUserLinkId;if(b.appendCountToSharedWithListUserLinkId)c+=String(a.length-d);if(m$.isDefinedAndNotNull(c)&&c.length>0)f.id=c;m$.isDefinedAndNotNull(e)&&e.length>0&&m$(f).addClass(e);d++});var e=m$(h).find(".ms-imnMoreLink");e.forEach(function(e){var g=H-3,f=b.sharedWithMoreLinkId;if(b.appendCountToSharedWithMoreLinkId)f+=String(g);var c=b.sharedWithMoreLinkClass,a=i,d=f;if(m$.isDefinedAndNotNull(d)&&d.length>0)e.id=d;m$.isDefinedAndNotNull(c)&&c.length>0&&m$(e).addClass(c);if(m$.isDefinedAndNotNull(a)&&a.length>0)e.title=a});c.push(StBuildParam(STSHtmlEncode(Strings.STS.L_SharedWithUsers),h.innerHTML))})}}if(c.length>0){c.unshift("<span",a("id",b.sharedWithListInnerSpanId),a("class",b.sharedWithListInnerSpanClass),">");c.push("</span>");var t="";if(b.showSharingHintImages){t=U(b.sharedWithListImageClass,m,b.sharedWithListImageId);c.unshift(t)}c.unshift("<div",a("id",b.sharedWithListDivId),a("class",b.sharedWithListDivClass),">");c.push("</div>")}if(oversharingMitigation)try{if(Boolean(B)&&B&&v>1){var K=Encoding.HtmlEncode(StBuildParam(Strings.STS.L_TotalFiles,v));c.unshift("<div",a("class",b.sharedWithListDivClass),">","<span",a("class",b.sharedWithListInnerSpanClass),">",K,"</span>","</div>")}}catch(R){}if(u){var s="";if(b.showSharingHintImages)s=U(b.guestLinkImageClass,"js-sharingHint-sharedAnonymously",b.guestLinkImageId);if(!m$.isDefinedAndNotNull(C))x=StBuildParam(STSHtmlEncode(Strings.STS.L_SharedWithGuest),"","");else var x=StBuildParam(STSHtmlEncode(Strings.STS.L_SharedWithGuest),'<a href="#"'+a("onclick",b.guestLinkOnClickCallback+"return false;")+a("id",b.guestLinkId)+a("title",Strings.STS.L_SharedWithGuestTooltip)+a("class",b.guestLinkClass)+">","</a>");c.push("<div",a("id",b.guestLinkDivId),a("class",b.guestLinkDivClass),">",s,"<span",a("id",b.guestLinkInnerSpanId),a("class",b.guestLinkInnerSpanClass),">",x,"</span>","</div>")}if(!z){var Q=Boolean(p)?p.listName:L_ListID;if(!Boolean(o))o=L_ItemID;w(Q,o)}return c.join("")};GetReversedSharedWithUsers=function(c){for(var b=[],d=c.length,a=0;a<d;a++)b.unshift(c[a]);return b};function U(d,b,e){var c=["<span ",a("class","js-sharingHint-iconContainer "+d),'><img alt="" role="presentation" ',a("class",b),a("id",e),a("src",GetThemedImageUrl("spcommon.png")),"></img></span>"];return c.join("")}ApplySharingListStyles=function(a,d){m$.isFunction(ProcessImn)&&ProcessImn();var b=function(){if(typeof a.calloutRenderCtx!=="undefined"&&a.calloutRenderCtx!==null){var l=d?null:CalloutManager.getFromCalloutDescendant(a),e=a.calloutRenderCtx,m=e.HttpRoot,r=e.RealHttpRoot,f=e.listName,c=e.CurrentItem.ID,q=function(){w(f,c)},k=function(a){Boolean(l)&&l.close();var b=a.get_canManagePermissions(),d=a.get_anonymousEditLink(),e=a.get_anonymousViewLink(),h=a.get_sharingLinks(),g=new ManageLinkParams(m,f,c,d,e,b,q,r,h);DisplayManageLinkDialog(g)};if(typeof a.objectSharingInformation!=="undefined"&&a.objectSharingInformation!==null)k(a.objectSharingInformation);else{var b=new SP.ClientContext(m),n=b.get_web(),h=n,j=null,i=null;if(f.length>0){j=n.get_lists().getById(f);if(c.length>0){i=j.getItemById(c);h=i}else{i=null;h=j}}var g=SP.ObjectSharingInformation.getObjectSharingInformation(b,h,false,false,false,true,false,false,false);b.load(g,"CanManagePermissions","AnonymousEditLink","AnonymousViewLink");b.load(g,"SharingLinks");var o=function(){k(g)},p=function(){};b.executeQueryAsync(o,p)}}return false};m$(a).find(".js-callout-sharedWithGuestLink").click(b);m$(a).css({display:"block"});m$(document.body).find(".js-sharingLinks-linkBoxLabelLink").click(b);var c=window.top.g_childDialog;m$.isDefinedAndNotNull(c)&&c.autoSize()};NavigateToRootLibraryWithoutQueryString=function(){var a=ajaxNavigate.get_href(),b=a.indexOf("?");if(b>-1){a=a.substring(0,b);Nav.navigate(a)}};DisplayUnthemedSharingDialog=function(d,c,a,b){DisplaySharingDialogCore(d,c,a,null,null,null,true,b)};DisplaySharingDialog=function(d,c,a,b){DisplaySharingDialogCore(d,c,a,null,null,null,false,b)};DisplaySharingDialogCore=function(e,d,a,j,c,i,g,h,f,l,m){var n=z(e,d,a,j,g),k=function(b){var k=new URI(ajaxNavigate.get_href()),j=k.getQueryParameter("sharingDialogForListItemId");if(Boolean(j))NavigateToRootLibraryWithoutQueryString();else if(b===100)DisplaySharedWithDialogCore(e,d,a,null,null,c,i,g,f);else if(b===SP.UI.DialogResult.OK)w(d,a);else b===SP.UI.DialogResult.cancel&&SP.QoS.WriteUserEngagement("SharingDialogDismissClicked");Boolean(h)&&h.focus()},b={};b.LaunchedWithCallback=true;if(Flighting.VariantConfiguration.IsExpFeatureClientEnabled(17)||m$.isDefinedAndNotNull(a)&&a.length>0&&(c=="0"||c=="1"&&i=="OneNote.Notebook"))b.SharingDialogWidth=595;else b.SharingDialogWidth=450;RenderSharingDialogByUrl(e,n,k,b,j,f,l,m)};RenderSharingDialogByUrl=function(b,d,f,a,l,c,i,k){if(b.charAt(0)=="/")b=e(b);if(!Boolean(d))d=b;var g=b;if(typeof c!="undefined"&&Boolean(c))g=c;var h=DisplayClientSharingDialog(g,d,null,function(b,c){var a=SP.UI.DialogResult.invalid;switch(b){case SharingDialogReturnCode.Success:a=SP.UI.DialogResult.OK;break;case SharingDialogReturnCode.Error:alert(c);a=SP.UI.DialogResult.cancel}typeof f=="function"&&f(a)},true,l,c,i,k);if(h)return;if(!Boolean(a))a={};a.LaunchedWithCallback=true;var j={url:d,dialogReturnValueCallback:f,args:a,autoSizeStartWidth:a.SharingDialogWidth};OpenPopUpPageWithDialogOptions(j)};var ib=450,db=300,cb=350;DisplaySharedWithDialog=function(f,e,d,c,a,b){typeof DisplaySharedWithDialogCore=="function"&&DisplaySharedWithDialogCore(f,e,d,c,a,null,null,false,b)};DisplaySharedWithDialogCore=function(f,b,a,i,j,m,n,l,h){var q=!m$.isUndefinedOrNull(h),d=Flighting.VariantConfiguration.IsExpFeatureClientEnabled(17)&&(window.OffSwitch==null||OffSwitch.IsActive("CDC4F725-353B-4205-912A-E191DDB93C70")||document.documentElement.className!=="ms-dialog"),g=!d?document.createElement("div"):document.getElementById("SharedWithDlg");if(!d){var k=_dlgWndTop();if(Boolean(k)&&k!=window&&typeof k.EnsureScriptParams=="function"){k.EnsureScriptParams("sharing.js","DisplaySharedWithDialog",f,b,a,i,j,h);return}}if(!f.endsWith("/"))f+="/";if(m$.isUndefinedOrNull(b))b="";if(m$.isUndefinedOrNull(a))a="";if(m$.isUndefinedOrNull(i))i=false;if(m$.isUndefinedOrNull(j))j=false;if(a.length>0)typeof CalloutManager!=="undefined"&&CalloutManager!==null&&CalloutManager.closeAll();var p=d&&Boolean(g);if(d&&!p)DisplaySharingDialogCore(f,b,a,2,"0",null,false,null,h);else EnsureScriptFunc("SP.js","SP.ClientContext",function(){EnsureScriptFunc("SP.UI.Dialog.js","SP.UI.ModalDialog.showModalDialog",function(){var eb="",pb='{%version 2.0}                            <img src="{=loadingCircleImage}" alt="{=/Strings/STS/L_Share_LoadingAltText}" class="js-sharing-fullListDialogWaitImg" id="sl-waitImg{=sharedlistItemId}" onclick="this.style.display=\'none\';" />                            <div class="js-sharing-fullListDialogStatusBar" id="sl-StatusBar{=sharedlistItemId}"></div>                            <div class="js-sharing-fullListDialogCommandsTop {=hideTopCommandsClass}">                                <span class="js-sharing-fullListDialogManageGuestLinks ms-textSmall ms-soften">                                    <span class="js-sharingHint-iconContainer ms-verticalAlignMiddle">                                        <img class="js-sharingHint-sharedAnonymously" alt="" role="presentation" src="{=sharingHintClusterImgSrc}"></img>                                    </span>                                    {=manageLinksHtml}                                </span>                            </div>                            <div class="{=fldSharingEntriesClass}"></div>                            <div id="sl-SharedWithList{=sharedlistItemId}" class="js-sharing-fullListDialogCommandsLeft">                                <a href="#" onclick="return false;" id="sl-InviteLink{=sharedlistItemId}" class="js-sharing-fullListDialogCommandInvite ms-calloutLink {=hideInviteLinkClass}">{=/Strings/STS/L_SharedWithDialogInvitePeople}</a>                                <a href="#" onclick="return false;" id="sl-StopSharingLink{=sharedlistItemId}" class="js-sharing-fullListDialogCommandStopSharing ms-calloutLink">{=/Strings/STS/L_StopSharing}</a>                                <a href="#" onclick="return false;" id="sl-EmailLink{=sharedlistItemId}" class="js-sharing-fullListDialogCommandEmail ms-calloutLink">{=/Strings/STS/L_SharedWithDialogEmailEveryone}</a>                                <a href="#" onclick="return false;" id="sl-AdvancedLink{=sharedlistItemId}" class="js-sharing-fullListDialogCommandAdvanced ms-calloutLink" target="_parent">{=/Strings/STS/L_SharedWithDialogAdvanced}</a>                            </div>                            <div class="js-sharing-fullListDialogCommandsRight">                                <span class="js-sharing-fullListDialogApplyText ms-textXSmall" id="sl-applyText{=sharedlistItemId}"></span>                                <img src="{=loadingCircleImageSmall}" alt="{=/Strings/STS/L_Share_LoadingAltText}" class="js-sharing-fullListDialogApplyWaitImg" id="sl-applyWaitImg{=sharedlistItemId}" onclick="this.style.display=\'none\';" />                                <button id="sl-OKButton{=sharedlistItemId}" class="js-sharing-fullListDialogCommandApply" disabled="disabled">{=/Strings/STS/L_SharedWithDialogApply}</button>                                <button id="sl-CloseBtn{=sharedlistItemId}" class="js-sharing-fullListDialogCommandCancel" onclick="DismissTopDlgAndLog(0);">{=/Strings/STS/L_SharedWithDialogCancel}</button>                            </div>',ub={loadingCircleImage:"/_layouts/15/images/progress-circle-24.gif?rev=47",loadingCircleImageSmall:"/_layouts/15/images/loadingcirclests16.gif?rev=47",sharedlistItemId:a,fldSharingEntriesClass:d?"js-sharing-tabFullListDialog":"js-sharing-fullListDialog",hideTopCommandsClass:d?"ms-hide":"",hideInviteLinkClass:d?"ms-hide":"",sharingHintClusterImgSrc:Boolean(l)?"/_layouts/15/images/spcommon.png?rev=47":GetThemedImageUrl("spcommon.png"),manageLinksHtml:StBuildParam(Encoding.HtmlEncode(Strings.STS.L_SharedWithGuest),'<a id="sl-ManageGuestLinks'+a+'" href="#" onclick="return false;">',"</a>")},gb=new Renderer;gb.SetTemplate("main",pb);eb=gb.Render("main",ub);g.innerHTML=eb;m$(g).click(MenuHtc_hide);m$(g).find(".js-sharing-fullListDialog").scroll(MenuHtc_hide);if(!d){DismissTopDlg(0);var H=null,rb={html:g,title:Strings.STS.L_SharedWithDialogTitle,allowMaximize:false,includeScrollBarPadding:false,autoSizeStartWidth:ib};g.className="js-sharing-fullListDialogContainer";g.id="sl-Container"+a;H=SP.UI.ModalDialog.showModalDialog(rb)}c();var N=document.getElementById("sl-waitImg"+a),z=document.getElementById("sl-applyText"+a),x=document.getElementById("sl-applyWaitImg"+a),t=document.getElementById("sl-InviteLink"+a),mb=document.getElementById("sl-StopSharingLink"+a),D=document.getElementById("sl-EmailLink"+a),ab=document.getElementById("sl-AdvancedLink"+a),v=document.getElementById("sl-OKButton"+a),L=document.getElementById("sl-CloseBtn"+a),W=document.getElementById("sl-ManageGuestLinks"+a),u=m$(g).find(".js-sharing-tabFullListDialog")[0],y=[],F=true,G=false,B="",C="",K="",fb=null,Z=new sb(mb,f,b,a);if(!d){u=m$(g).find(".js-sharing-fullListDialog")[0];m$(t).click(function(){SP.UI.ModalDialog.commonModalDialogClose(SP.UI.DialogResult.OK,null);var c=typeof window.top.g_childDialog!="undefined"?window.top.g_childDialog:undefined;Boolean(c)&&c.close(SP.UI.DialogResult.cancel);DisplaySharingDialogCore(f,b,a,0,m,n,l,null,h);return false});m$(L).click(function(){SP.QoS.WriteUserEngagement("SharingSharedWithTabCloseClicked");SP.UI.ModalDialog.commonModalDialogClose(SP.UI.DialogResult.OK,null)});L.focus()}m$(ab).click(function(){SP.QoS.WriteUserEngagement("SharingSharedWithAdvancedClick");var e=[f,"_layouts/15/User.aspx","?"];if(m$.isDefinedAndNotNull(b)&&b.length>0){e.push("List=",escapeProperly(b));m$.isDefinedAndNotNull(a)&&a.length>0&&e.push("&obj=",b,",",a,",LISTITEM")}var c=e.join("");c=AddSourceToUrl(c);if(d)window.parent.location.href=c;else Nav.navigate(c);return false});m$(v).click(function(){if(m$.isDefinedAndNotNull(x))x.style.display="inline";if(d)qb();else tb()});if(b.length>0)b=unescapeProperly(b);if(!d){var q=new SP.ClientContext(f),A=q.get_web(),M=A,r=null,p=null,E=null;if(b.length>0){r=A.get_lists().getById(b);if(a.length>0){p=r.getItemById(a);M=p}else{p=null;M=r}}else{r=null;p=null}q.load(A,"Title","ServerRelativeUrl");if(m$.isDefinedAndNotNull(r)){q.load(r,"BaseType","Title");E=r.get_rootFolder();m$.isDefinedAndNotNull(E)&&q.load(E,"ServerRelativeUrl")}m$.isDefinedAndNotNull(p)&&q.load(p,"ID","FileRef","FileLeafRef","FSObjType","Client_Title");var s=SP.ObjectSharingInformation.getObjectSharingInformation(q,M,false,false,false,true,true,true,!i),bb=s.getSharedWithUsers(q),T=[s,"IsSharedWithGuest","CanManagePermissions","AnonymousEditLink","AnonymousViewLink","HasPendingAccessRequests","PendingAccessRequestsLink","HasPermissionLevels"];T.push("CanBeShared");q.load.apply(q,T);q.load(bb)}var P=function(){var o=s.get_isSharedWithGuest(),i=s.get_hasPendingAccessRequests();G=s.get_canManagePermissions();B=s.get_anonymousEditLink();C=s.get_anonymousViewLink();var e=s.get_hasPermissionLevels(),j=s.get_canBeShared(),g=bb.getEnumerator(),h=0;!j&&Boolean(t)&&t.parentNode.removeChild(t);while(g.moveNext()){var a=g.get_current(),f=a.get_id(),E=a.get_name(),c=a.get_email(),A=a.get_picture(),D=a.get_jobTitle(),z=a.get_department(),H=a.get_sipAddress(),q=a.get_customRoleNames(),m=a.get_hasEditPermission(),k=a.get_hasReviewPermission(),n=a.get_hasViewPermission(),x=a.get_isSiteAdmin(),w=a.get_isDomainGroup(),l=S({id:f,title:E,email:c,pictureURL:A,sip:H,jobTitle:D,department:z,isDomainGrop:w},e),p=e?V(f,a,x,q,m,n,k):null,r=X(l,p,f);u.appendChild(r);m$.isDefinedAndNotNull(c)&&c.length>0&&y.push(escapeProperly(c));h++}var v=30;if(h>=v){var b=document.createElement("DIV");b.className="js-sharing-fullListDialogEntry js-sharing-fullListDialogEntrySharedWithMany ms-soften";b.id="sharingListEntry_many";b.innerHTML=STSHtmlEncode(Strings.STS.L_SharedWithDialogManyMessage);u.appendChild(b);F=false}if(i){K=s.get_pendingAccessRequestsLink();O()}o&&(Boolean(B)||Boolean(C))&&!d&&R();U(!e)},Q=function(d,b){if(m$.isDefinedAndNotNull(u)){var a=document.createElement("SPAN");a.innerHTML=b.get_message();u.appendChild(a);N.style.display="none";c()}},hb=function(L,b){var q=b.IsSharedWithGuest,k=b.HasPendingAccessRequests;fb=b.SharingLinks;G=b.CanManagePermissions;B=b.AnonymousEditLink;C=b.AnonymousViewLink;var f=b.HasPermissionLevels,l=b.CanBeShared,i=b.SharedWithUsersCollection.results,j=0;Z.Initialize(b);!l&&Boolean(t)&&t.parentNode.removeChild(t);for(var h=0,I=i.length;h<I;h++){var a=i[h],g=a.Id,H=a.Name,e=a.Email,D=a.Picture,E=a.JobTitle,A=a.Department,J=a.SipAddress,s=a.CustomRoleNames,o=a.HasEditPermission,m=a.HasReviewPermission,p=a.HasViewPermission,z=a.IsSiteAdmin,x=a.IsDomainGroup,n=S({id:g,title:H,email:e,pictureURL:D,sip:J,jobTitle:E,department:A,isDomainGroup:x},f),r=f?V(g,a,z,s,o,p,m):null,v=X(n,r,g);u.appendChild(v);m$.isDefinedAndNotNull(e)&&e.length>0&&y.push(escapeProperly(e));j++}var w=30;if(j>=w){var c=document.createElement("DIV");c.className="js-sharing-fullListDialogEntry js-sharing-fullListDialogEntrySharedWithMany ms-soften";c.id="sharingListEntry_many";c.innerHTML=STSHtmlEncode(Strings.STS.L_SharedWithDialogManyMessage);u.appendChild(c);F=false}if(k){K=b.PendingAccessRequestsLink;O()}q&&(Boolean(B)||Boolean(C))&&!d&&R();U(!f)},jb=function(d,b){if(Boolean(u)){var a=document.createElement("SPAN");a.innerHTML=b;u.appendChild(a);N.style.display="none";c()}},Y=function(j,g){if(!d)q.executeQueryAsync(j,g);else{var c,e=f;if(Boolean(h)){e=h;c="_api/SP.RemoteWeb(@url)";if(Boolean(b))c+="/GetListById(listGuid='"+b+"')";if(Boolean(a))c+="/GetItemById(id='"+a+"')";c+="?@url='"+f+"'"}else{c="_api/web";if(Boolean(b))c+="/Lists/GetById(id='"+b+"')";if(Boolean(a))c+="/GetItemById(id='"+a+"')"}GetObjectSharingInformation(hb,jb,e,c,false,false,false,true,true,true,!i)}};if(typeof SP!="undefined"&&typeof SP.QoS!="undefined")SP.QoS.ExecuteMonitoredAsync("SharingSharedWithTabRender","SharingSharedWithTabRenderStart","SharingSharedWithTabRenderSuccess","SharingSharedWithTabRenderFailure","SharingSharedWithTabRenderNoResult",Y,P,Q);else Y(P,Q);var O=function(){var d=[STSHtmlEncode(Strings.STS.L_SharedWithDialogPendingAccessRequests)," <a href=",StAttrQuote(K)," onclick=\"if (typeof(NavigateParentOrSelf) !== 'undefined') { NavigateParentOrSelf(this, this.href); return false; }\"",' target="_top">',STSHtmlEncode(Strings.STS.L_SharedWithDialogViewAccessRequests),"</a>"].join(""),e=_createStatusMarkup("",d,false),b=document.createElement("SPAN");b.className=StatusBarClassNames[StatusPriority.yellow]+" ms-status-msg";b.style.display="block";b.appendChild(e);var c=document.getElementById("sl-StatusBar"+a);c.appendChild(b);c.style.display="block"},R=function(){W.parentNode.style.display="inline-block";m$(W).click(function(){Boolean(H)&&H.close();var c=new ManageLinkParams(f,b,a,B,C,G,null,h,fb);DisplayManageLinkDialog(c,l);return false})},U=function(a){if(!d&&!j&&(m$.isUndefinedOrNull(r)||m$.isUndefinedOrNull(p)||m$.isDefinedAndNotNull(p)&&r.get_baseType()==1))t.style.display="inline";else if(!d)t.style.display="none";Z.ShowLinkIfNeeded();if(d)nb();else ob();if(a)v.style.visibility="hidden";else{v.style.visibility="visible";v.disabled=true}if(!a||G)ab.style.display="inline";L.style.visibility="visible";N.style.display="none";window.setTimeout(function(){m$.isFunction(ProcessImn)&&ProcessImn();Accessibility.FocusFirstTabStop(document.getElementById("SharedWithDlgCore"))},0);if(!d)H.autoSize();else o(function(){return false})},k={edit:"edit",review:"review",view:"view",custom:"custom",none:"none"},tb=function(){var a=[],c=0,b=0,e=0,d=0;m$(g).find(".js-sharing-fullListDialogEntryPermissionsInnerContainer").forEach(function(f){if(f.currentSelection!==f.initialSelection){var i=f.loginName,g;switch(f.currentSelection){case k.edit:g=SP.Sharing.Role.edit;c++;break;case k.review:g=SP.Sharing.Role.review;b++;break;case k.view:g=SP.Sharing.Role.view;e++;break;case k.none:g=SP.Sharing.Role.none;d++;break;default:return}}f.initialSelection=f.currentSelection;if(f.currentSelection!==k.custom)f.actualPermission=null;var h=new SP.Sharing.UserRoleAssignment;h.set_userId(i);h.set_role(g);a.push(h)});a.length>0&&lb(a,c,b,e,d,function(){v.disabled=true})},ob=function(){if(y.length>0&&F){var a=null,b=null;if(m$.isDefinedAndNotNull(p))if(r.get_baseType()==1||p.get_item("FSObjType")==="1"){a=p.get_item("FileLeafRef");b=getHostUrl(f)+Encoding.EncodePath(p.get_item("FileRef"),true)}else a=p.get_client_Title();else if(m$.isDefinedAndNotNull(r)){a=r.get_title();if(m$.isDefinedAndNotNull(E))b=getHostUrl(ajaxNavigate.get_href())+E.get_serverRelativeUrl()}else if(m$.isDefinedAndNotNull(A)){a=A.get_title();b=getHostUrl(ajaxNavigate.get_href())+A.get_serverRelativeUrl()}ConfigEmailLinkHelper(y,D,a,b)}},lb=function(a,c,b,e,d,g){var h=function(b,c){var d=getHostUrl(f)+p.get_item("FileRef");SP.Sharing.DocumentSharingManager.updateDocumentSharingInfo(q,d,a,false,false,false,null,false,false);q.executeQueryAsync(function(){b(g)},c)};SP.QoS.ExecuteMonitoredAsync("SharingSharedWithSave","SharingSharedWithSaveStart","SharingSharedWithSaveSuccess","SharingSharedWithSaveFailure","SharingSharedWithSaveNoResult",h,I,J,{EditChanges:c,ReviewChanges:b,ViewChanges:e,NoneChanges:d})},nb=function(){if(y.length>0&&F){D.style.display="inline";var a=[];a.push("mailto:");a.push(y.join(";"));var c=L_ItemName,b;if(Boolean(L_ItemUrl)){var d=L_ItemUrl.split("?");d[0]=Encoding.EncodePath(d[0],true);b=e(d.join("?"))}else b=e(L_ItemUrl);(Boolean(c)||Boolean(b))&&a.push("?");var g=false;if(Boolean(c)){a.push("subject=");a.push(escapeProperly(c));g=true}if(Boolean(b)){g&&a.push("&");a.push("body=");a.push(encodeURIComponent(b))}var f=function(){typeof SP!="undefined"&&typeof SP.QoS!="undefined"&&SP.QoS.WriteUserEngagement("SharingSharedWithEmailEveryoneClick");window.location.href=a.join("");return false};if(Boolean(D.addEventListener))D.addEventListener("click",f,false);else D.attachEvent("onclick",f)}},qb=function(){for(var c=[],j=0,i=0,m=0,l=0,f=g.querySelectorAll(".js-sharing-fullListDialogEntryPermissionsInnerContainer"),e=0,n=f.length;e<n;e++){var a=f[e];if(a.currentSelection!==a.initialSelection){var h=a.loginName,b;switch(a.currentSelection){case k.edit:b=SharingRole.Edit;j++;break;case k.review:b=SharingRole.Review;i++;break;case k.view:b=SharingRole.View;m++;break;case k.none:b=SharingRole.None;l++;break;default:typeof Sys!="undefined";return}}a.initialSelection=a.currentSelection;if(a.currentSelection!==k.custom)a.actualPermission=null;if(Boolean(h)&&!isNaN(b)){var d={};d.UserId=h;d.Role=b;c.push(d)}}c.length>0&&kb(c,j,i,m,l,function(){v.disabled=true})},kb=function(b,d,c,h,g,i){var a=function(a,c){UpdateDocumentSharingInfo(function(){a(i)},c,f,e(L_ItemUrl),b,false,false,false,null,false,false)};if(typeof SP!="undefined"&&typeof SP.QoS!="undefined")SP.QoS.ExecuteMonitoredAsync("SharingSharedWithSave","SharingSharedWithSaveStart","SharingSharedWithSaveSuccess","SharingSharedWithSaveFailure","SharingSharedWithSaveNoResult",a,I,J,{EditChanges:d,ReviewChanges:c,ViewChanges:h,NoneChanges:g});else a(I,J)},I=function(c){if(m$.isDefinedAndNotNull(x)){x.style.display="none";!z.hasChildNodes()&&z.appendChild(document.createTextNode(Strings.STS.L_SharedWithDialogApplySuccessText));z.style.display="inline";z.style.opacity=1;var d=function(){SPAnimationUtility.BasicAnimator.FadeOut(z,function(){z.style.display="none";x.style.display="none"})};window.setTimeout(d,500)}w(b,a);m$.isDefinedAndNotNull(c)&&c()},J=function(){if(m$.isDefinedAndNotNull(x))x.style.display="none";alert(Strings.STS.L_SharedWithDialogApplyUpdatedPermissionsFailed)},S=function(b,e){var c=document.createElement("div");c.className="js-sharing-fullListDialogEntryNameAndTitleContainer";var d=new ContextInfo;d.Templates={};d.Templates.Fields={};var g={Field:[{Name:"SharedWith",FieldType:"User",RealFieldName:"SharedWith",WithPicture:"1",PictureSize:"Size_48px",WithPictureDetail:"1",HasUserLink:"1",Type:"User",MaxWidth:e?db:cb}],EffectivePresenceEnabled:"1",PresenceAlt:Strings.STS.L_UserFieldNoUserPresenceAlt,UserDispUrl:f+"_layouts/15/userdisp.aspx"},h={ID:a,SharedWith:[{id:b.id,title:b.title,email:b.email,picture:b.pictureURL,sip:b.sip,jobTitle:b.jobTitle,department:b.department}]},i=spMgr.RenderFieldByName(d,"SharedWith",h,g);c.innerHTML=i;return c},V=function(h,c,i,f,l,m,j){var g=document.createElement("div");g.className="js-sharing-fullListDialogEntryPermissionsContainer";var n=Flighting.VariantConfiguration.IsExpFeatureClientEnabled(496)&&c.IsMemberOfGroup,a,b;if(i)a=document.createElement("span");else{a=document.createElement("a");a.href="#";a.onclick=function(){return false}}a.className="js-sharing-fullListDialogEntryPermissionsInnerContainer";a.id="sl-permissionsMenuElement"+h;g.appendChild(a);var e=0;if(i)a.innerHTML=STSHtmlEncode(Strings.STS.L_SharedWithDialogOwnerPermission);else if(n){m$(a).addClass("js-sharing-fullListDialogEntryPermissionsMenu");b=document.createElement("span");m$(b).addClass("js-sharing-fullListDialogEntryPermissionsText");a.appendChild(b);if(isDefinedAndNotNullOrEmpty(f))b.innerHTML=STSHtmlEncode(f);else if(l)b.innerHTML=STSHtmlEncode(Strings.STS.L_EditPermission);else if(j)b.innerHTML=STSHtmlEncode(Strings.STS.L_ReviewPermission);else if(m)b.innerHTML=STSHtmlEncode(Strings.STS.L_ViewPermission);m$(a).click(function(g){var b=m$(g.target).closest(".js-sharing-fullListDialogEntryPermissionsMenu")[0];e++;var d="sl-permissionsMenu"+h+e.toString(),f=CMenu(d);CAMOpt(f,"Check permissions for "+c.Name,'CheckPermissionsFor("'+c.Name+'");');var a=document.createElement("span");a.id=d;a.style.position="absolute";b.appendChild(a);var j=m$(b).offset().left,i=m$(b).offset().bottom;m$(a).offset({left:j,top:i});MenuHtc_hide();OMenu(f,a,undefined,false);g.stopPropagation();return false})}else{m$(a).addClass("js-sharing-fullListDialogEntryPermissionsMenu");b=document.createElement("span");m$(b).addClass("js-sharing-fullListDialogEntryPermissionsText");a.appendChild(b);var d=document.createElement("img");m$(d).addClass("js-sharing-fullListDialogEntryPermissionsMenuArrow");d.src="/_layouts/15/images/ecbarw.png?rev=47";d.alt=Strings.STS.L_OpenMenu_Text;a.appendChild(d);m$(a).click(function(j){var a=m$(j.target).closest(".js-sharing-fullListDialogEntryPermissionsMenu")[0];e++;var g="sl-permissionsMenu"+h+e.toString(),i=CMenu(g),c=function(c){var b="";switch(c){case k.edit:b=Strings.STS.L_EditPermission;break;case k.review:b=Strings.STS.L_ReviewPermission;break;case k.view:b=Strings.STS.L_ViewPermission;break;case k.custom:b=a.actualPermission;break;case k.none:b=Strings.STS.L_StopSharing}CAMOpt(i,b,'SetSelectedPermission("'+c+'", "'+a.id+'");')};c(k.edit);c(k.view);isDefinedAndNotNullOrEmpty(a.actualPermission)&&c(k.custom);c(k.none);var b=document.createElement("span");b.id=g;b.style.position="absolute";a.appendChild(b);var f=m$(a).offset().left;if(Flighting.VariantConfiguration.IsExpFeatureClientEnabled(17)){if(window.document.documentElement.getAttribute("dir")==="ltr")f=f+65;d=d+3}var d=m$(a).offset().bottom;m$(b).offset({left:f,top:d});MenuHtc_hide();OMenu(i,b,undefined,false);j.stopPropagation();return false});if(isDefinedAndNotNullOrEmpty(f)){a.initialSelection=k.custom;a.actualPermission=f}else if(l)b.innerHTML=STSHtmlEncode(Strings.STS.L_EditPermission);else if(j)b.innerHTML=STSHtmlEncode(Strings.STS.L_ReviewPermission);else if(m)a.initialSelection=k.view;a.loginName=Boolean(c.LoginName)?c.LoginName:c.get_loginName();SetSelectedPermission(a.initialSelection,a)}return g};SetSelectedPermission=function(c,a){if(!m$.isElement(a))a=document.getElementById(a);if(a.currentSelection!==c){var b="";switch(c){case k.edit:b=Strings.STS.L_EditPermission;break;case k.view:b=Strings.STS.L_ViewPermission;break;case k.review:b=Strings.STS.L_ReviewPermission;break;case k.custom:b=a.actualPermission;break;case k.none:b=Strings.STS.L_StopSharing}m$(a).find(".js-sharing-fullListDialogEntryPermissionsText")[0].innerHTML=STSHtmlEncode(b);a.currentSelection=c;v.disabled=false}a.focus()};CheckPermissionsFor=function(d){var e=b+","+a+",DOCUMENT",c="?obj="+e+"&users="+d,g=GetLayoutsPageUrl(f,"chkperm.aspx",c);OpenPopUpPage(g,null,null,null)};var X=function(d,b,c){var a=document.createElement("div");a.className="js-sharing-fullListDialogEntry";if(m$.isDefinedAndNotNull(c))a.id="sharingListEntry_"+c;a.appendChild(d);m$.isDefinedAndNotNull(b)&&a.appendChild(b);return a}})})};ConfigEmailLinkHelper=function(f,d,c,b){if(f.length>0){d.style.display="inline";var a=[];a.push("mailto:");a.push(f.join(";"));(m$.isDefinedAndNotNull(c)||m$.isDefinedAndNotNull(b))&&a.push("?");var g=false;if(m$.isDefinedAndNotNull(c)){a.push("subject=");a.push(escapeProperly(c));g=true}if(m$.isDefinedAndNotNull(b)){g&&a.push("&");a.push("body=");a.push(encodeURIComponent(e(b)))}m$(d).click(function(){window.location.href=a.join("");return false})}};var Jb='<div class="ms-table ms-manageLink-table">',bb=Flighting.VariantConfiguration.IsExpFeatureClientEnabled(40),y="",Y=Encoding.HtmlEncode(Strings.STS.L_Sharing_ManageLink_Disablelink);if(!bb)y='<div class="ms-tableRow ms-manageLink-url-div"> <div class="ms-tableCell"> <input type="text" oncopy="OnCopyLink(COPY_TAG);" class="ms-manageLink-url ms-noWrap ms-manageLink-tabbed-url-width" value="{1}" title="{2}" readonly="readonly" onmousedown="SelectOnFocus(this, event);"/>  </div> <div class="ms-tableCell ms-manageLink-disable" style="{3}"> <a id="{4}" href="#" class="ms-heroCommandLink ms-commandLink" onclick="OnDisableLink({5}, this, GetManageLinkParams());return false;">'+Y+"</a> </div> </div>";else{var Fb=GenQrImgLink("{1}","vertical-align:middle;");y='<div class="ms-tableRow ms-manageLink-url-div"> <div class="ms-tableCell"> <input type="text" oncopy="OnCopyLink(COPY_TAG);" class="ms-manageLink-url ms-noWrap ms-manageLink-tabbed-qr-url-width" value="{1}" title="{2}" readonly="readonly" onmousedown="SelectOnFocus(this, event);"/> '+Fb+' </div> <div class="ms-tableCell ms-manageLink-disable" style="{3}"> <a id="{4}" href="#" class="ms-heroCommandLink ms-commandLink" onclick="OnDisableLink({5}, this, GetManageLinkParams());return false;">'+Y+"</a> </div> </div>"}var Z='<div style="{0}" class="ms-manageLink-create"> <a id="{1}" href="#" class="ms-heroCommandLink ms-commandLink" onclick="OnCreateLink(GetManageLinkParams(), {2}, this);return false;">'+Encoding.HtmlEncode(Strings.STS.L_Sharing_ManageLink_CreateLink)+"</a> </div>",Pb='<div class="ms-tableRow"> <div class="ms-tableCell ms-manageLink-cell"> <div class="ms-manageLink-column">{0}</div> </div> </div> <div class="ms-tableRow"> <div class="ms-tableCell ms-manageLink-cell"> <div class="ms-manageLink-column ms-aclinv-linksSectionPadding" id="{1}"> {2} <div id="{3}" class="ms-aclinv-tabbedControlLinksSectionProgressBar ms-manageLink-progress"> <img class="ms-manageLink-progress-img" src="/_layouts/15/images/loadingcirclests16.gif?rev=47" onclick="this.style.display=\'none\';" alt="'+Encoding.HtmlEncode(Strings.STS.L_Sharing_ManageLink_ProgressTooltip)+'" /> <span> '+Encoding.HtmlEncode(Strings.STS.L_Sharing_ManageLink_ProgressText)+" </span> </div> </div> </div> </div>",Mb="js-manageLinkUrl-",Lb="js-manageLink-deletelink-",u="js-manageLinkPrgBr-";ManageLinkParams=function(b,a,l,j,k,f,g,h,i,e){if(!b.endsWith("/"))b+="/";var c=a.indexOf("{"),d=a.indexOf("}");if(c>=0&&d>=0)a=a.substring(c+1,d);this.webUrl=b;this.listId=a;this.itemId=l;this.editLink=j;this.viewLink=k;this.allowDisableLink=f;this.onReturnCallback=g;this.contextWebUrl=h;this.sharingLinks=i;this.requiredAnonymousLinkExpirationInDays=e};ManageLinkParams.prototype={webUrl:undefined,listId:undefined,itemId:undefined,editLink:undefined,viewLink:undefined,allowDisableLink:undefined,onReturnCallback:undefined,contextWebUrl:undefined,sharingLinks:undefined};function q(b){var a=document.getElementById("js-manageLink-progressText");if(Boolean(a)&&Boolean(b))a.innerHTML=Encoding.HtmlEncode(b)}function l(a){var d=document.getElementById("js-manageLink-expirationSelector");if(Boolean(d)){d.style.display=a?"none":"";var b=document.getElementById("js-manageLink-customExpirationDiv");if(Boolean(b)){b.style.display=a?"":"none";var e=document.getElementById("js-manageLink-expirationInput");Boolean(e)&&a&&e.select()}var f=document.getElementById("js-manageLink-expirationInputErrorDiv");if(Boolean(f)&&!a)b.style.display="none"}var c=document.getElementById("js-manageLink-expirationSelectorMessage");if(a&&Boolean(c))c.style.display="none"}function k(c,b){var a=c;while(a.length<b)a="0"+a;return a}function T(e){var g=null,b=SharingLinkExpirationValues[Encoding.HtmlDecode(e)];if(isNaN(b)){var h=24*60,d=parseInt(e);if(!isNaN(d)&&d>0)b=d*h;else b=null}if(b!=null){var a=new Date;a.setUTCMinutes(a.getUTCMinutes()+b);var o=a.getFullYear().toString(),n=k((a.getMonth()+1).toString(),2),p=k(a.getDate().toString(),2),m=k(a.getHours().toString(),2),j=k(a.getMinutes().toString(),2),l=k(a.getSeconds().toString(),2),c,f;c=a.getTimezoneOffset()<0?false:true;f=k(c?Math.floor(a.getTimezoneOffset()/60).toString():Math.ceil(a.getTimezoneOffset()/60).toString().replace("-",""),2);var i=k((a.getTimezoneOffset()%60).toString().replace("-",""),2);g=o+n+p+"T"+m+j+l+(c?"-":"+")+f+i}return g}function Q(e,f){var a="";if(!Boolean(L_SharingLinkProperties))return"";var c=L_SharingLinkProperties[e];if(Boolean(c)){var b=c.SupportsExpiration,d=b?GenerateExpiryTextHTML(f):"";a=b?Boolean(d)?Encoding.HtmlEncode(Strings.STS.L_Sharing_ManageLink_UpdateSharingLinkExpiration):Encoding.HtmlEncode(Strings.STS.L_Sharing_ManageLink_SetSharingLinkExpiration):""}return a}function D(g,f){var c=document.getElementById("js-manageLink-linkExpirationDate"),e=document.getElementById("js-manageLink-linkExpirationLabel"),b=document.getElementById("js-manageLink-expirationSelector"),a=Q(g,f);if(Boolean(b)&&Boolean(c)&&Boolean(e)){var d="";if(Boolean(a))d=GenerateExpiryTextHTML(f);c.style.display=Boolean(d)?"":"none";c.innerHTML=d;if(a!=null)e.innerHTML=Encoding.HtmlEncode(a);b.style.display=Boolean(a)?"":"none";b.style.display==""&&l(false)}}function fb(e){if(!enforceRequiredAnonymousLinksExpiration)return;var c=document.getElementById("js-manageLink-expirationInput");if(Boolean(c)){var d=Number(c.value),b=B(e),a=document.getElementById("js-manageLink-expirationSelectorMessage");if(b>0&&b<d){c.value=String(b);L_RequiredAnonymousLinkExpirationInDays=b;if(Boolean(a)){a.innerHTML=String.format(Strings.STS.L_Sharing_ManageLink_LinkExpiration_AdminRequiredValueMessage,String(b));a.style.display="";SP.QoS.WriteUserEngagement("ResetExpirationDateFromServerOverride")}}else if(Boolean(a))a.style.display="none"}}function B(d){var a=GetExpirationFromLink(d),b=0;if(Boolean(a)){var c=Math.abs(a.getTime()-+new Date);b=Math.ceil(c/(1e3*3600*24))}return b}function n(){var c=lb(),b=Boolean(c)?String.format(Strings.STS.L_Sharing_ManageLink_OrganizationTenantAccountRequired,c):Strings.STS.L_Sharing_ManageLink_OrganizationAccountRequired,a=0;L_SharingLinkProperties=[];L_SharingLinkProperties[SharingLinkKind.Direct]={SharingLabel:Strings.STS.L_Sharing_ManageLink_DirectLinkLabel,IsEditLink:true,LinkCopyTag:"DirectLinkCopied",Priority:a++,SupportsExpiration:false};L_SharingLinkProperties[SharingLinkKind.OrganizationView]={SharingLabel:String.format(Strings.STS.L_Sharing_ManageLink_DropdownViewOnlyLabel,b),IsEditLink:false,LinkCopyTag:"SharingOrganizationViewLinkCopied",Priority:a++,SupportsExpiration:false};L_SharingLinkProperties[SharingLinkKind.OrganizationEdit]={SharingLabel:String.format(Strings.STS.L_Sharing_ManageLink_DropdownEditLabel,b),IsEditLink:true,LinkCopyTag:"SharingOrganizationEditLinkCopied",Priority:a++,SupportsExpiration:false};L_SharingLinkProperties[SharingLinkKind.AnonymousView]={SharingLabel:String.format(Strings.STS.L_Sharing_ManageLink_DropdownViewOnlyLabel,Strings.STS.L_Sharing_ManageLink_NoSignInRequiredLabel),IsEditLink:false,LinkCopyTag:"SharingAnonymousViewLinkCopied",Priority:a++,SupportsExpiration:true,Expiration:""};L_SharingLinkProperties[SharingLinkKind.AnonymousEdit]={SharingLabel:String.format(Strings.STS.L_Sharing_ManageLink_DropdownEditLabel,Strings.STS.L_Sharing_ManageLink_NoSignInRequiredLabel),IsEditLink:true,LinkCopyTag:"SharingAnonymousEditLinkCopied",Priority:a++,SupportsExpiration:true,Expiration:""}}function yb(b){!Boolean(L_SharingLinkProperties)&&n();for(var d=-1,e=SharingLinkKind.Uninitialized,a=0,f=b.length;a<f;a++){var c=L_SharingLinkProperties[b[a].LinkKind];if(b[a].IsActive&&c.Priority>d){e=b[a].LinkKind;d=c.Priority}}return e}function s(e,c){var a=e.sharingLinks;if(!Boolean(a)||isNaN(c)||c<0)return null;for(var d=0,f=a.length;d<f;d++){var b=a[d];if(b.LinkKind==c&&b.IsActive)return b.Url}return null}function j(f,b,c){if(isNaN(b)||b<0)return;var a=f.sharingLinks;if(!Boolean(a))a=[];for(var g=false,e=0,i=a.length;e<i;e++){var d=a[e];if(d.LinkKind==b){d.Url=c;d.IsActive=Boolean(c);g=true}}if(!g){var h={LinkKind:b,Url:c,IsActive:Boolean(c)};a.push(h)}L_SharingLinks=f.sharingLinks}function N(e){var a=e.sharingLinks,g=SharingLinkKind.OrganizationEdit,c=document.getElementById("js-manageLink-linkTypeText");if(Boolean(c)&&Boolean(a)&&a.length>0)for(var b=0,f=a.length;b<f;b++)if(a[b].LinkKind==L_SelectedSharingLinkKind){var d=Encoding.HtmlEncode(a[b].LinkLabel);c.innerHTML=d;c.title=d}}function d(a){var i=document.getElementById("js-manageLink-linkTypeDropdown"),e=document.getElementById("js-manageLink-linkBox"),h=document.getElementById("js-manageLink-additionalHtmlDiv"),j=document.getElementById("CopySharingLinkBtn"),f=document.getElementById("idDisableSharingLnk"),c=document.getElementById("js-manageLink-linkExpirationDropdown"),d=document.getElementById("js-manageLink-expirationSave"),b=document.getElementById("js-manageLink-expirationCancel");if(Boolean(e))if(a)e.setAttribute("disabled","disabled");else{var g=s(GetManageLinkParams(),L_SelectedSharingLinkKind);e.value=g;e.title=g;e.removeAttribute("disabled")}if(Boolean(i))if(a)CSSUtil.AddClass(i,"ms-commandLinkDisabled");else CSSUtil.RemoveClass(i,"ms-commandLinkDisabled");if(Boolean(j))if(a)j.setAttribute("disabled","disabled");else j.removeAttribute("disabled");if(Boolean(f))if(a||L_SelectedSharingLinkKind==SharingLinkKind.Direct){f.setAttribute("disabled","disabled");CSSUtil.AddClass(f,"ms-commandLinkDisabled")}else{f.removeAttribute("disabled");CSSUtil.RemoveClass(f,"ms-commandLinkDisabled")}if(Boolean(c))if(a){c.setAttribute("disabled","true");CSSUtil.AddClass(c,"ms-commandLinkDisabled")}else{c.removeAttribute("disabled");CSSUtil.RemoveClass(c,"ms-commandLinkDisabled")}if(Boolean(d))if(a){d.setAttribute("disabled","disabled");CSSUtil.AddClass(d,"ms-commandLinkDisabled")}else{d.removeAttribute("disabled");CSSUtil.RemoveClass(d,"ms-commandLinkDisabled")}if(Boolean(b))if(a){b.setAttribute("disabled","disabled");CSSUtil.AddClass(b,"ms-commandLinkDisabled")}else{b.removeAttribute("disabled");CSSUtil.RemoveClass(b,"ms-commandLinkDisabled")}if(!a){(L_SelectedSharingLinkKind==SharingLinkKind.OrganizationEdit||L_SelectedSharingLinkKind==SharingLinkKind.OrganizationView)&&l(false);D(L_SelectedSharingLinkKind,g)}if(Boolean(h))if(a)for(var m=h.getElementsByTagName("A"),k=0,n=m.length;k<n;k++)m[k].removeAttribute("onclick");else if(Flighting.VariantConfiguration.IsExpFeatureClientEnabled(40))h.innerHTML=GenQrImgLink(g,"vertical-align:middle;");qb("js-manageLink-sharingProgressDiv",a)}function lb(){var a=SuiteNavCommon.ExtractSuiteProperty(OpenSuiteLinksJson(),"CompanyDisplayName");return Boolean(a)?a:null}function pb(a){if(window.OffSwitch==null||OffSwitch.IsActive("CC8E165C-7A86-43B6-AC8F-5C08125C5EE7"))L_SelectedSharingLinkKind=SharingLinkKind.OrganizationEdit;var V='{%version 2.0}             <div class="ms-manageLink-table">                 <div class="{=DialogContentDivClass}" id="dialogContent">                     {%templateSelect SharingLinksTemplate}                     {%foreach ManagedLinkRow LinksMetadata}                 </div>                 <div class="ms-core-form-bottomButtonBox">                     <input class="ms-ButtonHeightWidth" type="button" id="CloseBtn" onclick="{+onClickGetLinksDialogClose}; return false;" value="{=/Strings/STS/L_Sharing_ManageLink_CloseButton}" />                 </div>             </div>',M='{%version 2.0}             <div class="ms-aclinv-linksSectionPadding ms-manageLink-sharingLinkSelector">                 <div class="ms-table ms-manageLink-column ms-fullWidth">                     {%templateSelect SharingLinksMetadata/LinkTypeTemplate SharingLinksMetadata}                     {%template LinkBox SharingLinksMetadata}                     {%template LinkExpirationSelector SharingLinksMetadata}                     <div class="ms-tableRow ms-fullWidth">                         <div id="js-manageLink-sharingProgressDiv" class="ms-tableCell ms-aclinv-tabbedControlLinksSectionProgressBar ms-manageLink-progress">                             <img class="ms-manageLink-progress-img" src="{=SharingLinksMetadata/LoadingImageSrc}" onclick="this.style.display=\'none\';" alt="{=/Strings/STS/L_SPClientPeoplePickerWaitImgAlt}" />                             <span id="js-manageLink-progressText"></span>                         </div>                     </div>                 </div>             </div>',P='{%version 2.0} <span class="ms-metadata ms-manageLink-singleLinkLabel">{=SharingLinkTypeText}</span>',R='{%version 2.0}             <div class="ms-tableRow">                 <div class="ms-tableCell ms-manageLink-cell">                     <div class="ms-manageLink-column">{=ManageLinkLabelText}</div>                 </div>             </div>',hb="{%version 2.0}",S='{%version 2.0}             {%templateSelect LinkLabelTemplate}             <div class="ms-tableRow">                 <div class="ms-tableCell ms-manageLink-cell">                     <div class="ms-manageLink-column ms-aclinv-linksSectionPadding" id="{=ManageLinkUrlDivId}">                         {%templateSelect LinkTypeDescriptionTemplate}                         {%templateSelect GuestLinkTemplate}                         <div id="{=ManageLinkProgressBarDivId}" class="ms-aclinv-tabbedControlLinksSectionProgressBar ms-manageLink-progress">                             <img class="ms-manageLink-progress-img" src="{=LoadingImageSrc}" onclick="this.style.display=\'none\';" alt="{=/Strings/STS/L_Sharing_ManageLink_ProgressTooltip}" />                             <span>{=CreateLinkProgressText}</span>                         </div>                     </div>                 </div>             </div>',U='{%version 2.0}             <div style="{=ManageLinkStyle}" class="ms-manageLink-create">                 <a id="{=AddLinkId}" title="{=LinkTitleText}" href="javascript:;" class="ms-heroCommandLink ms-commandLink ms-anonymousLinkExpiration-addExternalLink" onclick="OnCreateLink(GetManageLinkParams(), {=IsEditLink}, this);return false;">                 {=AddOrCreateLinkText}</a>            </div>',W='{%version 2.0}             <div class="ms-table ms-fullWidth">                 <div class="ms-tableRow ms-fullWidth">                     <div class="ms-tableCell ms-fullWidth ms-manageLink-url-div">                         <input type="text" oncopy="OnCopyLink(\'{=CopyTag}\');" class="ms-manageLink-url ms-noWrap ms-fullWidth {=ManageLinkUrlClass}" id="{=ManageLinkUrlId}" value="{=LinkUrl}" title="{=LinkUrl}" readonly="readonly" onmousedown="SelectOnFocus(this, event);"/>                     </div>                     <div class="ms-tableCell" id="js-manageLink-additionalHtmlDiv">                         {=AdditionalHtml}                     </div>                     <div id="js-manageLink-CopyButtonDiv" class="ms-tableCell {=CopyButtonVisibilityClass}">                         <input class="ms-button-emphasize ms-ButtonHeightWidth ms-manageLink-copyButton" type="button" id="CopySharingLinkBtn" onclick="{+onClickCopySharingLink}; return false;" value="{=/Strings/STS/L_Copy_Text}" />                     </div>                     {%templateSelect DisableLinkTemplate}                 </div>             </div>',T='{%version 2.0}             <div class="ms-tableCell ms-manageLink-disable" style="{=ManageLinkStyle}">                 <a id="{=DisableLinkId}" title="{=LinkTitleText}" href="javascript:;" class="ms-heroCommandLink ms-commandLink" onclick="OnDisableLink({=IsEditLink}, this, GetManageLinkParams());return false;">                     {=DisableLinkText}</a>             </div>',L='{%version 2.0}             <label for="{=ManageLinkUrlId}" class="ms-metadata ms-manageLink-tabbed-url-width ms-aclinv-linksSectionDescPadding">{=Description}</label>',O='{%version 2.0}             <div class="ms-tableRow ms-fullWidth">                 <div class="ms-tableCell">                     <a id="js-manageLink-linkTypeDropdown" role="listbox" href="javascript:;" class="ms-manageLink-dropdownLinkContainer ms-core-defaultFont ms-lines ms-fullWidth" onclick="{+onClickSharingLinkMenu}">                         <span id="js-manageLink-linkTypeText" class="ms-manageLink-dropdownText ms-fullWidth" title="{=SharingLinkTypeText}">{=SharingLinkTypeText}</span>                         <img class="ms-manageLink-dropdownArrow" src="{=MenuDropdownArrowImgSrc}" alt="{=/Strings/STS/L_OpenMenu_Text}" />                     </a>                 </div>             </div>',K='{%version 2.0}             <div class="ms-table">                 <div class="ms-tableRow ms-fullWidth">                     <div class="ms-tableCell">                         <div id="js-manageLink-expirationSelector" style="{=SharingLinkExpirationSelectorStyle}">                             <span id="js-manageLink-linkExpirationDate" style="{=SharingLinkExpirationStyle}" class="ms-anonymousLinkExpiration-expirationText">{=SharingLinkExpirationDate}</span>                             <a id="js-manageLink-linkExpirationDropdown" href="javascript:;" class="ms-heroCommandLink ms-commandLink ms-anonymousLinkExpiration-dropdownLinkContainer" onClick="{+onClickExpirationMenu}">                                 <span id="js-manageLink-linkExpirationLabel" class="ms-anonymousLinkExpiration-dropdownText ms-uppercase">{=SharingLinkExpirationLabel}</span>                                 <img class="ms-anonymousLinkExpiration-dropdownArrow" src="{=MenuDropdownArrowImgSrc}" alt="{=/Strings/STS/L_OpenMenu_Text}" />                             </a>                         </div>                         <div id="js-manageLink-expirationSelectorMessage" class="ms-anonymousLinkExpiration-expirationError ms-error ms-fullWidth ms-normalWrap" style="display:none" role="alert">                         </div>                     </div>                 </div>                 <div id="js-manageLink-customExpirationDiv" class="ms-tableRow ms-fullWidth" style="display:none">                     <div class="ms-tableCell">                         <div class="ms-anonymousLinkExpiration-expirationText">{=SharingLinkExpirationCustomHtml}</div>                         <a href="javascript:;" id="js-manageLink-expirationSave" class="ms-heroCommandLink ms-commandLink ms-anonymousLinkExpiration-expirationSave" onClick="{+onClickCustomExpirationSave}">{=/Strings/STS/L_SaveButtonCaption}</a>                         <a href="javascript:;" id="js-manageLink-expirationCancel" class="ms-heroCommandLink ms-commandLink ms-anonymousLinkExpiration-expirationSave" onClick="{+onClickCustomExpirationCancel}">{=/Strings/STS/L_CancelButtonCaption}</a>                         <div id="js-manageLink-expirationInputErrorDiv" class="ms-anonymousLinkExpiration-expirationError ms-error ms-fullWidth ms-normalWrap" style="display:none" role="alert">                             {=/Strings/STS/L_Sharing_ManageLink_LinkExpiration_InvalidValueErrorMessage}                         </div>                     </div>                 </div>             </div>',J='{%version 2.0}             <input type="text" id="js-manageLink-expirationInput" class="ms-manageLink-expirationInput" onmousedown="SelectOnFocus(this, event);" value="{=CurrentExpirationValue}" title="{=/Strings/STS/L_Sharing_ManageLink_LinkExpiration_CustomValueTooltip}"></input>',F="{%version 2.0}",b=new Renderer;b.SetTemplate("main",V);b.SetTemplate("ManagedLinkRow",S);b.SetTemplate("SharingLinkSection",M);b.SetTemplate("SharingLinkTypeLabel",P);b.SetTemplate("CreateLink",U);b.SetTemplate("LinkBox",W);b.SetTemplate("ErrorMessage",F);b.SetTemplate("LinkTypeSelector",O);b.SetTemplate("LinkTypeDescription",L);b.SetTemplate("LinkLabel",R);b.SetTemplate("LinkExpirationSelector",K);b.SetTemplate("LinkExpirationCustomHTML",J);b.SetTemplate("BlankTemplate",F);b.SetTemplate("DisableLink",T);SharingLinkExpirationValues[Encoding.HtmlEncode(Strings.STS.L_Sharing_ManageLink_LinkExpiration_Never)]=null;for(var X=24*60,i=[1,30,60],h=0,db=i.length;h<db;h++){var ab=String.format(SP.Utilities.LocUtility.getLocalizedCountValue(Encoding.HtmlEncode(Strings.STS.L_DaysLabelForCallout),Encoding.HtmlEncode(Strings.STS.L_DaysLabelForCalloutIntervals),i[h]),i[h]);SharingLinkExpirationValues[ab]=i[h]*X}SharingLinkExpirationValues[Encoding.HtmlEncode(Strings.STS.L_Sharing_ManageLink_LinkExpiration_Custom)]="Custom";var C=function(b){var d=b.LinkUrl,c=b.IsEditLink,e=typeof sharingInfo=="object"&&typeof sharingInfo.HasEditRole=="boolean"&&typeof sharingInfo.HasViewRole=="boolean"&&(c?sharingInfo.HasEditRole:sharingInfo.HasViewRole);b.LoadingImageSrc="/_layouts/15/images/loadingcirclests16.gif?rev=47";b.DropdownArrowSrc=GetThemedImageUrl("ecbarw.png");b.CopyButtonVisibilityClass="ms-hide";b.AddOrCreateLinkText=Encoding.HtmlEncode(Strings.STS.L_Sharing_ManageLink_CreateLink);b.Description=c?Encoding.HtmlEncode(Strings.STS.L_Sharing_ManageLink_EditDesc):Encoding.HtmlEncode(Strings.STS.L_Sharing_ManageLink_ViewOnlyDesc);b.LinkTypeText=c?Encoding.HtmlEncode(Strings.STS.L_Sharing_ManageLink_EditLinkOptionDesc):Encoding.HtmlEncode(Strings.STS.L_Sharing_ManageLink_ViewLinkOptionDesc);b.LinkTypeDescriptionTemplate="LinkTypeDescription";b.LinkLabelTemplate="LinkLabel";b.DisableLinkTemplate="DisableLink";b.CreateLinkProgressText=Encoding.HtmlEncode(Strings.STS.L_Sharing_ManageLink_ProgressText);b.LinkTypeDescriptionLabel=Encoding.HtmlEncode(Strings.STS.L_Sharing_ManageLink_LinkAccess);b.CreateLinkText=Encoding.HtmlEncode(Strings.STS.L_Sharing_ManageLink_CreateLink);b.ViewLinkOptionDescription=Encoding.HtmlEncode(Strings.STS.L_Sharing_ManageLink_ViewLinkOptionDesc);b.DisableLinkProgressText=Encoding.HtmlEncode(Strings.STS.L_Sharing_ManageLink_DisableLinkProgress);b.DisableLinkText=Encoding.HtmlEncode(Strings.STS.L_Sharing_ManageLink_Disablelink);if(Boolean(d))b.GuestLinkTemplate="LinkBox";else b.GuestLinkTemplate="CreateLink";if(!a.allowDisableLink)if(!Boolean(d))b.Description=c?Strings.STS.L_Sharing_ManageLink_EditCantView_Message:Strings.STS.L_Sharing_ManageLink_ViewCantView_Message;if(!e){b.GuestLinkTemplate="ErrorMessage";b.Description=c?Strings.STS.L_Sharing_ManageLink_NoEditRole:Strings.STS.L_Sharing_ManageLink_NoViewRole}},v="",m=bb?GenQrImgLink("{0}","vertical-align:middle;"):"",w=!Boolean(a.allowDisableLink)?"display:none":"",Z={LinkUrl:a.viewLink,CopyTag:"SharingViewLinkCopied",ManageLinkUrlClass:v,AdditionalHtml:String.format(m,a.viewLink),ManageLinkStyle:w,DisableLinkId:"idDisableReadLnk",AddLinkId:"idReadLnk",LinkTitleText:Encoding.HtmlEncode(Strings.STS.L_Sharing_ManageLink_ViewOnlyDesc),ManageLinkUrlId:"ms-manageLink-url-read",IsEditLink:false,ManageLinkLabelText:Encoding.HtmlEncode(Strings.STS.L_Sharing_ManageLink_ViewOnlyLabel),ManageLinkUrlDivId:"js-manageLinkUrl-View",ManageLinkProgressBarDivId:"js-manageLinkPrgBr-View"};C(Z);var Y={LinkUrl:a.editLink,CopyTag:"SharingEditLinkCopied",ManageLinkUrlClass:v,AdditionalHtml:String.format(m,a.editLink),ManageLinkStyle:w,DisableLinkId:"idDisableReadWriteLnk",AddLinkId:"idReadWriteLnk",LinkTitleText:Encoding.HtmlEncode(Strings.STS.L_Sharing_ManageLink_EditDesc),ManageLinkUrlId:"ms-manageLink-url-readWrite",IsEditLink:true,ManageLinkLabelText:Encoding.HtmlEncode(Strings.STS.L_Sharing_ManageLink_EditLabel),ManageLinkUrlDivId:"js-manageLinkUrl-Edit",ManageLinkProgressBarDivId:"js-manageLinkPrgBr-Edit"};C(Y);var gb=false,H=false,o=false,c="",G="DirectLinkCopied",A=Strings.STS.L_Sharing_ManageLink_DirectLinkLabel,E=0,t="",u="",y="";if(typeof netscape!="undefined")o=typeof netscape.security.PrivilegeManager=="undefined";else if(typeof clipboardData=="undefined")o=true;!Boolean(L_SharingLinkProperties)&&n();if(window.OffSwitch==null||OffSwitch.IsActive("CC8E165C-7A86-43B6-AC8F-5C08125C5EE7"))L_SelectedSharingLinkKind=SharingLinkKind.Direct;if(Boolean(a.sharingLinks)){for(var k=0,fb=a.sharingLinks.length;k<fb;k++){var e=a.sharingLinks[k],g=L_SharingLinkProperties[e.LinkKind];if(Boolean(g)){a.sharingLinks[k].LinkLabel=g.SharingLabel;if(!(window.OffSwitch==null||OffSwitch.IsActive("CC8E165C-7A86-43B6-AC8F-5C08125C5EE7"))){if(e.IsActive)c=URI.getAbsolute(e.Url)}else if(e.IsActive&&!isNaN(g.Priority)&&g.Priority>E){L_SelectedSharingLinkKind=e.LinkKind;E=g.Priority;c=URI.getAbsolute(e.Url)}}}var f=L_SharingLinkProperties[L_SelectedSharingLinkKind];if(Boolean(f)){A=f.SharingLabel;G=f.LinkCopyTag;H=f.IsEditLink;u=f.SupportsExpiration?GenerateExpiryTextHTML(c):"";t=Q(L_SelectedSharingLinkKind,c)}}var cb=B(c);y=String.format(Strings.STS.L_Sharing_ManageLink_LinkExpiration_CustomValueLabel,b.Render("LinkExpirationCustomHTML",{CurrentExpirationValue:cb}));var eb={LinksMetadata:[],SharingLinksMetadata:{LinkTypeTemplate:Boolean(a.sharingLinks)&&a.sharingLinks.length>1?"LinkTypeSelector":"SharingLinkTypeLabel",SharingLinkTypeText:Encoding.HtmlEncode(A),MenuDropdownArrowImgSrc:GetThemedImageUrl("ecbarw.png"),LoadingImageSrc:"/_layouts/15/images/loadingcirclests16.gif?rev=47",ManageLinkUrlId:"js-manageLink-linkBox",CopyTag:G,ManageLinkUrlClass:v,LinkUrl:c,AdditionalHtml:String.format(m,c),CopyButtonVisibilityClass:o?"ms-hide":"",ManageLinkStyle:w,DisableLinkId:"idDisableSharingLnk",DisableLinkTemplate:"DisableLink",DisableLinkText:Encoding.HtmlEncode(Strings.STS.L_Sharing_ManageLink_RemoveLink),IsEditLink:H,SharingLinkExpirationSelectorStyle:Boolean(t)?"":"display:none",SharingLinkExpirationLabel:t,SharingLinkExpirationDate:u,SharingLinkExpirationStyle:Boolean(u)?"":"display:none",SharingLinkExpirationCustomHtml:y},SharingLinksTemplate:"SharingLinkSection",DialogContentDivClass:"ms-manageLink-dialogContent-expanded"};OnSharingLinksMenuChanged=function(b){if(isNaN(b)||b<0)return;var v=function(c){for(var b=0,d=a.sharingLinks.length;b<d;b++)if(a.sharingLinks[b].LinkKind==SharingLinkKind.Direct||a.sharingLinks[b].LinkKind==c)a.sharingLinks[b].IsActive=true;else if(c==SharingLinkKind.Direct)a.sharingLinks[b].IsActive=false},e=function(b){L_SelectedSharingLinkKind=b;N(a)},i=document.getElementById("js-manageLink-linkTypeDropdown"),o=document.getElementById("js-manageLink-linkBox"),w=document.getElementById("js-manageLink-additionalHtmlDiv"),A=document.getElementById("CopySharingLinkBtn"),y=document.getElementById("idDisableSharingLnk");if(Boolean(o)&&Boolean(i)&&Boolean(a.sharingLinks)&&a.sharingLinks.length>0){var t=z(a.webUrl,a.listId,a.itemId),u=Boolean(a.contextWebUrl)?a.contextWebUrl:a.webUrl;i.focus();if(window.OffSwitch==null||OffSwitch.IsActive("CC8E165C-7A86-43B6-AC8F-5C08125C5EE7"))if(b==L_SelectedSharingLinkKind)return;var h=L_SelectedSharingLinkKind;e(b);var c=s(a,b);if(Boolean(c)){var f=B(c),g=document.getElementById("js-manageLink-expirationInput");if(f>=0&&Boolean(g)&&Number(g.value)!=f)g.value=String(f);d(false);D(b,c);return}SP.QoS.WriteUserEngagement("SharingSwitchTo"+x(b)+"LinkType");if(b==SharingLinkKind.OrganizationView||b==SharingLinkKind.OrganizationEdit){var l=function(g,i,f){c=i.CreateOrganizationSharingLink;if(Boolean(c))j(a,b,c);else{r(true,null,a,g,f);e(h)}d(false)},k=function(c,f,b){r(true,null,a,c,b);e(h);d(false)};q(Strings.STS.L_Sharing_ManageLink_CreateLinkProgressText);d(true);CreateOrganizationSharingLink(l,k,u,t,b==SharingLinkKind.OrganizationEdit)}else if(b==SharingLinkKind.AnonymousView||b==SharingLinkKind.AnonymousEdit){var n=function(){e(b);d(false)},m=function(){e(h);d(false)};q(Strings.STS.L_Sharing_ManageLink_CreateLinkProgressText);d(true);p(null,null,b==SharingLinkKind.AnonymousEdit,a,true,null,n,m)}}};b.RegisterHandler("onClickGetLinksDialogClose",function(){HandleOnCloseClick();I(SP.UI.DialogResult.cancel)});b.RegisterHandler("onClickCopySharingLink",function(){var a=document.getElementById("js-manageLink-linkBox");if(Boolean(a)&&Boolean(a.value)){var b=TryCopyStringToClipboard(a.value);if(!b)alert("Failed to copy link URL to clipboard! Please use CTRL+C in the link box instead.");else OnCopyLink("")}});b.RegisterHandler("onSharingLinkDropDownChanged",OnSharingLinksMenuChanged);b.RegisterHandler("onClickSharingLinkMenu",function(g){var d=document.getElementById("js-manageLink-linkTypeDropdown");if(Boolean(d)&&!CSSUtil.HasClass(d,"ms-commandLinkDisabled")){for(var c=CMenu("js-manageLink-sharingLinksMenu"),b=0,f=a.sharingLinks.length;b<f;b++){var e=Boolean(a.sharingLinks[b].IsActive);CAMOpt(c,e?String.format(Strings.STS.L_Sharing_ManageLink_SharingLinkCreated,a.sharingLinks[b].LinkLabel):a.sharingLinks[b].LinkLabel,"OnSharingLinksMenuChanged("+a.sharingLinks[b].LinkKind+");")}c.setAttribute("largeiconmode","true");c.setAttribute("hideicons","true");MenuHtc_hide();OMenu(c,d,undefined,false)}DOM.CancelEvent(g);return false});b.RegisterHandler("onClickExpirationMenu",function(b){var a=document.getElementById("js-manageLink-linkExpirationDropdown");Boolean(a)&&!CSSUtil.HasClass(a,"ms-commandLinkDisabled")&&OnDropdownClick(b,a)});b.RegisterHandler("onClickCustomExpirationSave",function(f){var h=typeof f.target!="undefined"?f.target:f.srcElement,d=document.getElementById("js-manageLink-expirationInput");if(Boolean(d)&&!CSSUtil.HasClass(h,"ms-commandLinkDisabled")){var c=true,g=false,b=parseInt(d.value);if(isNaN(b)||String(b)!=d.value||b<0||b>730)c=false;else if(enforceRequiredAnonymousLinksExpiration&&(b<1||b>L_RequiredAnonymousLinkExpirationInDays)){g=true;c=false}c&&OnCreateLink(a,L_SelectedSharingLinkKind==SharingLinkKind.AnonymousEdit,null,d.value);var e=document.getElementById("js-manageLink-expirationInputErrorDiv");if(Boolean(e)){e.innerHTML=g?String.format(Strings.STS.L_Sharing_ManageLink_LinkExpiration_AdminRequiredValueErrorMessage,String(L_RequiredAnonymousLinkExpirationInDays)):Strings.STS.L_Sharing_ManageLink_LinkExpiration_InvalidValueErrorMessage;e.style.display=c?"none":"";!c&&SP.QoS.WriteUserEngagement("InvalidExpirationDaysFromAdminRequirement")}}});b.RegisterHandler("onClickCustomExpirationCancel",function(a){var c=typeof a.target!="undefined"?a.target:a.srcElement;if(!CSSUtil.HasClass(c,"ms-commandLinkDisabled")){var b=s(GetManageLinkParams(),L_SelectedSharingLinkKind);l(false);D(L_SelectedSharingLinkKind,b)}});return b.Render("main",eb)}DisplayManageLinkDialog=function(a,h,b,e){if(!Boolean(a))return;var f="",g=document.getElementById("GetLinksDialog");if(!Boolean(g)){DisplaySharingDialogCore(a.webUrl,a.listId,a.itemId,1,"0",null,h);return}typeof A=="function"&&A("GetLinksDialog",true);var i=function(i,l,e,h,g,d,k){var c='<div class="ms-metadata ms-manageLink-tabbed-url-width ms-aclinv-linksSectionDescPadding">{0}</div>',f=k?"":"display:none",n=typeof sharingInfo=="object"&&typeof sharingInfo.HasEditRole=="boolean"&&typeof sharingInfo.HasViewRole=="boolean"&&(d?sharingInfo.HasEditRole:sharingInfo.HasViewRole),j=d?"SharingEditLinkCopied":"SharingViewLinkCopied";if(n&&a.allowDisableLink){c=String.format(c,STSHtmlEncode(i));var b=c;if(Boolean(e))b=b+String.format(y,j,e,e,f,h,d);else b=b+String.format(Z,f,g,d);return b}else if(!a.allowDisableLink){if(Boolean(e)){c=String.format(c,STSHtmlEncode(i));b=c;b=b+String.format(y,j,e,e,f,h,d)}else{c=String.format(c,STSHtmlEncode(l));b=c;b=b+String.format(Z,f,g,d)}return b}else{var m=d?Strings.STS.L_Sharing_ManageLink_NoEditRole:Strings.STS.L_Sharing_ManageLink_NoViewRole;return String.format(c,Encoding.HtmlEncode(m))}};f=pb(a);enforceRequiredAnonymousLinksExpiration=a.requiredAnonymousLinkExpirationInDays>0;enforceRequiredAnonymousLinksExpiration&&SP.QoS.WriteUserEngagement("SharingDialogEnforceRequiredAnonymousLinksExpiration");f+="</div>";g.innerHTML=f;DOM.AddEventHandler(g,"onclick",HandleDocumentBodyClick);if(!(window.OffSwitch==null||OffSwitch.IsActive("CC8E165C-7A86-43B6-AC8F-5C08125C5EE7")))OnSharingLinksMenuChanged(L_SelectedSharingLinkKind);else d(false);if(typeof b!=="boolean")Accessibility.FocusFirstTabStop(document.getElementById("GetLinksDialogCore"));else if(!b&&!e)document.getElementById("idReadLnk").focus();else if(!b&&e)document.getElementById("idReadWriteLnk").focus();else if(b&&!e)SelectOnFocus(document.getElementById("ms-manageLink-url-read"),null);else b&&e&&SelectOnFocus(document.getElementById("ms-manageLink-url-readWrite"),null);c()};GetBestCsomSharingLink=function(b){!Boolean(L_SharingLinkProperties)&&n();for(var e=-1,c=null,a=0,f=b.length;a<f;a++){var d=L_SharingLinkProperties[b[a].get_linkKind()];if(b[a].get_isActive()&&b[a].get_linkKind()!=SharingLinkKind.Direct&&d.Priority>e){c=b[a];e=d.Priority}}return c};GetSharingLabelFromType=function(a){!Boolean(L_SharingLinkProperties)&&n();return L_SharingLinkProperties[a].SharingLabel};SelectOnFocus=function(a,b){Boolean(a)&&a.select();Boolean(b)&&cancelDefault(b)};DismissTopDlgAndLog=function(a){SP.QoS.WriteUserEngagement("SharingSharedWithTabCloseClicked");DismissTopDlg(a)};DismissTopDlg=function(b){var a=window.top.g_childDialog;if(Boolean(a))if(Flighting.VariantConfiguration.IsExpFeatureClientEnabled(103)&&Boolean(a.get_url())){var c=new URI(a.get_url());c.getPath().indexOf("aclinv.aspx")!=-1&&a.close(b)}else a.close(b)};OnCreateLink=function(f,g,h,e){var a=null,c=null,b=null;if(Boolean(e)){c=function(){d(false);l(false);if(enforceRequiredAnonymousLinksExpiration){var a=s(GetManageLinkParams(),L_SelectedSharingLinkKind);fb(a)}};b=function(){d(false)};a=T(e);q(Boolean(a)?Strings.STS.L_Sharing_ManageLink_AddExpirationProgressText:Strings.STS.L_Sharing_ManageLink_RemoveExpirationProgressText)}d(true);p(h,null,g,f,true,a,c,b)};OnCopyLink=function(a){a="Sharing"+x(L_SelectedSharingLinkKind)+"LinkCopied";SP.QoS.WriteUserEngagement(a)};OnDisableLink=function(c,b,a){var e=null;if(c!=null){var i="js-manageLinkUrl-"+(c?"Edit":"View");e=document.getElementById(i)}SP.QoS.WriteUserEngagement("SharingDisable"+x(L_SelectedSharingLinkKind)+"LinkClick");var g=function(){j(a,L_SelectedSharingLinkKind,null);var b=yb(a.sharingLinks),c=L_SharingLinkProperties[b];if(b==SharingLinkKind.Uninitialized)b=SharingLinkKind.Direct;L_SelectedSharingLinkKind=b;N(a);d(false)},f=function(c,e,b){d(false);r(false,null,a,c,b)},h=function(i){if(i==SP.UI.DialogResult.OK)if(Boolean(b)){if(Boolean(a))if(!isNaN(L_SelectedSharingLinkKind))switch(L_SelectedSharingLinkKind){case SharingLinkKind.OrganizationView:case SharingLinkKind.OrganizationEdit:var j=z(a.webUrl,a.listId,a.itemId),k=Boolean(a.contextWebUrl)?a.contextWebUrl:a.webUrl;q(Strings.STS.L_Sharing_ManageLink_RemoveLinkProgressText);d(true);DestroyOrganizationSharingLink(g,f,k,j,L_SelectedSharingLinkKind==SharingLinkKind.OrganizationEdit);break;case SharingLinkKind.AnonymousView:case SharingLinkKind.AnonymousEdit:q(Strings.STS.L_Sharing_ManageLink_RemoveLinkProgressText);d(true);p(b,e,L_SelectedSharingLinkKind==SharingLinkKind.AnonymousEdit,a,false,null,g,f)}else p(b,e,c,a,false,null,g,f)}else{V(b,e,c);Boolean(a)&&p(b,e,c,a,false,null)}var h;h=document.getElementById("CloseBtn");Boolean(h)&&h.focus()};!CSSUtil.HasClass(b,"ms-commandLinkDisabled")&&ob(h)};OnDropdownClick=function(k,b){if(enforceRequiredAnonymousLinksExpiration){l(true);return false}for(var e=Object.keys(SharingLinkExpirationValues),f="dropdown-menu",d=CMenu(f),c=0;c<e.length;c++){var i=new RegExp('"',"g"),j='SetExpirationDropdownItem("'+e[c].replace(i,'\\"')+'", "'+b.id+'");';CAMOpt(d,e[c],j)}var a=document.createElement("span");a.id=f;a.style.position="absolute";b.appendChild(a);var h=m$(b).offset().left,g=m$(b).offset().bottom;m$(a).offset({left:h,top:g});d.setAttribute("hideicons","true");MenuHtc_hide();OMenu(d,a,undefined,false);k.stopPropagation();return false};SetExpirationDropdownItem=function(b,a){if(!m$.isElement(a))a=document.getElementById(a);if(Boolean(b))if(String(SharingLinkExpirationValues[b]).toUpperCase()=="CUSTOM")l(true);else{OnCreateLink(GetManageLinkParams(),L_SelectedSharingLinkKind==SharingLinkKind.AnonymousEdit,null,b);a.focus()}};GenerateExpiryTextHTML=function(d){var a=GetExpirationFromLink(d);if(!Boolean(a))return"";var b="",c=a==null?Strings.STS.L_Sharing_ManageLink_LinkExpiration_Never:a.toLocaleDateString();b="<div class='ms-anonymousLinkExpiration-expiryDescription'>             <span class='ms-anonymousLinkExpiration-expiryDate ms-soften'>"+Encoding.HtmlEncode(String.format(Strings.STS.L_Sharing_ManageLink_LinkExpiration_DateDescription,c))+"</span>         </div>";return b};GetExpirationFromLink=function(a){if(a!=null&&a.indexOf("expiration=")!=-1){var d=new URI(a),c=d.getQueryParameter("expiration"),b=Date.parse(c);if(Boolean(b))return new Date(b)}return null};var zb=["<div>",STSHtmlEncode(Strings.STS.L_Sharing_ManageLink_ConfirmText),"</div>","<div class='ms-core-form-bottomButtonBox'>","<button id='js-disableLinkBtn' onclick='DismissTopDlg(1)'>",STSHtmlEncode(Strings.STS.L_Sharing_ManageLink_ConfirmButtonOK),"</button>","<button id='js-keepLinkBtn' onclick='DismissTopDlg(0)'>",STSHtmlEncode(Strings.STS.L_Sharing_ManageLink_ConfirmButtonCancel),"</button></div>"];function ob(c){var b=document.createElement("DIV");b.innerHTML=zb.join("");var d={html:b,title:Strings.STS.L_Sharing_ManageLink_ConfirmTitle,dialogReturnValueCallback:c},e=new SP.UI.ModalDialog.showModalDialog(d),a=document.getElementById("js-keepLinkBtn");if(!Boolean(a)&&Boolean(window.parent))try{a=window.parent.document.getElementById("js-keepLinkBtn")}catch(f){}Boolean(a)&&a.focus()}HandleOnCloseClick=function(){SP.QoS.WriteUserEngagement("SharingGetALinkTabCloseClick")};function x(b){if(isNaN(b)||b<0)return null;var a="";switch(b){case SharingLinkKind.Uninitialized:a="Uninitialized";break;case SharingLinkKind.Direct:a="Direct";break;case SharingLinkKind.OrganizationView:a="OrganizationView";break;case SharingLinkKind.OrganizationEdit:a="OrganizationEdit";break;case SharingLinkKind.AnonymousView:a="AnonymousView";break;case SharingLinkKind.AnonymousEdit:a="AnonymousEdit"}return a}function qb(b,c){var a=document.getElementById(b);if(Boolean(a))a.style.visibility=c?"visible":"hidden"}function V(c,d,a){var b=function(){var b;if(a!=null&&c!=null)b=document.getElementById(u+(a?"Edit":"View"));else b=document.getElementById(u+"All");if(Boolean(b))b.style.visibility="visible"};o(b)}function F(c,e,b){var a;if(b!=null&&c!=null)a=document.getElementById(u+(b?"Edit":"View"));else a=document.getElementById(u+"All");if(Boolean(a))a.style.visibility="hidden"}function r(e,k,d,c,i,g){var h="",b="",f="SharingCreate"+x(L_SelectedSharingLinkKind)+"LinkServerFailure",j=e?"SharePoint-CreateSharingLink-Error":"SharePoint-DestroySharingLink-Error";b=Boolean(g)?g:typeof c!="undefined"&&c!=null?c.getResponseHeader(j):"";if(!Boolean(b))b=e?Strings.STS.L_Sharing_ManageLink_CreateDefaultError:Strings.STS.L_Sharing_ManageLink_DefaultError;Boolean(i)&&i.UnexpectedFailure(f);SP.DebugLogger.Write(f,SP.DebugLogger.LoggingLevel.Interesting,b);h=e?Strings.STS.L_Sharing_CreateLink_ErrorTitle:Strings.STS.L_Sharing_ManageLink_ErrorTitle;if(typeof OpenPopUpPageWithTitle=="function"){var a;if(Boolean(d.contextWebUrl)){a=d.contextWebUrl;if(a.substring(a.length-1)!="/")a+="/";a+="_layouts/15/error.aspx?ErrorText="+encodeURIComponent(b)}else a=d.webUrl+"_layouts/15/error.aspx?ErrorText="+encodeURIComponent(b);OpenPopUpPageWithTitle(a,null,null,null,h);if(typeof c!="undefined"&&c!=null)c.onreadystatechange=null}else alert(b)}function p(l,k,c,b,d,m,i,h){var a=[];a.push(b.webUrl);a.push("_layouts/15/aclinv.aspx");a.push("?obj=");a.push("{");a.push(b.listId);a.push("},");a.push(b.itemId);a.push(",DOCUMENT");a.push("&List=");a.push(escapeProperly(b.listId));if(d)a.push("&command=createlink");else a.push("&command=disablelink");a.push("&readwrite=");a.push(String(c));d&&V(l,k,c);if(d&&!Boolean(m)&&enforceRequiredAnonymousLinksExpiration){m=T(String(b.requiredAnonymousLinkExpirationInDays));var p=document.getElementById("js-manageLink-expirationInput");if(Boolean(p)){p.value=String(b.requiredAnonymousLinkExpirationInDays);SP.QoS.WriteUserEngagement("SharingDialog_SetExpirationWithAdminRequirement")}}var n=function(f,e,a){r(d,c,b,f,e,a)},q=function(a,b,e){var f;if(d)if(Boolean(a)&&HasValidUrlPrefix(a)&&PageUrlValidation(a)!=""){f=Encoding.HtmlEncode(a);c?L_AnonymousEditLink=f:L_AnonymousViewLink=f;j(GetManageLinkParams(),c?SharingLinkKind.AnonymousEdit:SharingLinkKind.AnonymousView,a);typeof i=="function"&&i(e,b)}else{n(e,b);F(l,k,c,false);typeof h=="function"&&h(e,b)}else{if(c!=null)c?L_AnonymousEditLink="":L_AnonymousViewLink="";else{L_AnonymousEditLink="";L_AnonymousViewLink=""}typeof i=="function"&&i(e,b)}if(typeof window.GetManageLinkParams=="function"){var g=function(){F(l,k,c,true);if(Boolean(sharingInfo)){if(Boolean(L_AnonymousEditLink)||Boolean(L_AnonymousViewLink))sharingInfo.IsSharedWithGuest=true;else sharingInfo.IsSharedWithGuest=false;C()}};o(g)}},e=null,f=null,g=function(){};f=function(e,a,c){var b=a.CreateAnonymousLinkWithExpiration;q(Boolean(a)?Boolean(d)?b:a.DeleteAnonymousLink:null,c,e)};g=function(d,a,b){n(d,b,a);F(l,k,c,false);typeof h=="function"&&h(d,b,a)};e=function(e,f){if(d)CreateAnonymousLink(e,f,Boolean(b.contextWebUrl)?b.contextWebUrl:b.webUrl,a.join(""),c,m);else DestroyAnonymousLink(e,f,Boolean(b.contextWebUrl)?b.contextWebUrl:b.webUrl,a.join(""),c)};if(typeof SP!="undefined"&&typeof SP.QoS!="undefined")if(c)if(d)SP.QoS.ExecuteMonitoredAsync("SharingCreateEditLink","SharingCreateEditLinkStart","SharingCreateEditLinkSuccess","SharingCreateEditLinkFailure","SharingCreateEditLinkNoResult",e,f,g);else SP.QoS.ExecuteMonitoredAsync("SharingDisableEditLink","SharingDisableEditLinkStart","SharingDisableEditLinkSuccess","SharingDisableEditLinkFailure","SharingDisableEditLinkNoResult",e,f,g);else if(d)SP.QoS.ExecuteMonitoredAsync("SharingCreateViewLink","SharingCreateViewLinkStart","SharingCreateViewLinkSuccess","SharingCreateViewLinkFailure","SharingCreateViewLinkNoResult",e,f,g);else SP.QoS.ExecuteMonitoredAsync("SharingDisableViewLink","SharingDisableViewLinkStart","SharingDisableViewLinkSuccess","SharingDisableViewLinkFailure","SharingDisableViewLinkNoResult",e,f,g);else e(f,g)}function R(e,a){var k=Encoding.HtmlEncode(a?Strings.STS.L_Share_FolderLockdownMode_SiteAdminMessage:Strings.STS.L_Share_FolderLockdownMode_NonAdminMessage),h=Encoding.HtmlEncode(a?Strings.STS.L_Share_LockdownMode_ManageFeaturesButtonText:Strings.STS.L_Share_LockdownMode_ShareSiteButtonText),f=Encoding.HtmlEncode(a?Strings.STS.L_Share_LockdownMode_ShareSiteButtonText:Strings.STS.L_CloseButtonCaption),c=document.createElement("div");c.id="Share_LockdownNotificationDlg";var g=function(){NavigateParentOrSelfCore(GetLayoutsPageUrl(e,"ManageFeatures.aspx","?Scope=Site"),true);return false},d=function(){window.parent.setTimeout('DisplaySharingDialog("'+e+'");',0);DismissTopDlg(0);return false},i=function(){DismissTopDlg(0);return false},l={lockdownMessage:k,lockdownActionButtonCaption:h,lockdownAlternateActionButtonCaption:f},j="{%version 2.0}                        <div class='ms-core-form-section'>{=lockdownMessage}</div>                        <div class='ms-core-form-section'>                            <div class='ms-core-form-bottomButtonBox'>                                <input type='button' id='Share_LockdownActionBtn' onclick='{+lockdownActionButton_click}' value='{=lockdownActionButtonCaption}' class='ms-button-emphasize'></input>                                <input type='button' id='Share_LockdownAlternateActionBtn' onclick='{+lockdownAlternateActionButton_click}' value='{=lockdownAlternateActionButtonCaption}'></input>                            </div>                        </div>",b=new Renderer;b.SetTemplate("main",j);b.RegisterHandler("lockdownActionButton_click",a?g:d);b.RegisterHandler("lockdownAlternateActionButton_click",a?d:i);c.innerHTML=b.Render("main",l);return c}function L(a,e,b){if(Boolean(a)){var d=R(e,b);a.appendChild(d);c()}}RenderLockdownModeDialog=function(b,a){EnsureScriptFunc("SP.UI.Dialog.js","SP.UI.ModalDialog.showModalDialog",function(){var c=R(b,a),d={html:c,title:Strings.STS.L_Share_LockdownMode_DialogTitle,autoSize:true},e=new SP.UI.ModalDialog.showModalDialog(d)})};RenderLockdownModeInContainer=function(b,c,a){L(document.getElementById(b),c,a)};function I(b){if(window.frameElement!=null&&typeof window.frameElement.commitPopup==="function")window.frameElement.commitPopup();else{var a=window.top.g_childDialog;Boolean(a)&&a.close(b)}}function c(){if(window.frameElement!=null&&typeof window.frameElement.autoSize==="function")window.frameElement.autoSize();else{var a=window.top.g_childDialog;Boolean(a)&&a.autoSize()}}function o(a){if(window.frameElement!=null&&typeof window.frameElement.autoSizeSuppressScrollbar=="function")window.frameElement.autoSizeSuppressScrollbar(a);else{a();c()}}function xb(c){var a=document.getElementById("divMoreOptions").style.display!=="none";!a&&SP.QoS.WriteUserEngagement("SharingInviteShowOptionsClicked");a=Boolean(c)||!a;o(wb(a));var b=document.getElementById("Share_ShowHideMoreOptions");Boolean(b)&&setInnerText(b,Encoding.HtmlEncode(a?Strings.STS.L_Share_HideOptions:Strings.STS.L_Share_ShowOptions))}function wb(a){return function(){var b=document.getElementById("divMoreOptions");Cb(b,a);a&&Accessibility.FocusFirstTabStop(b)}}function Cb(a,b){if(a!=null)a.style.display=b?"":"none"}function Ab(a){return a!=null&&a.value!=null&&a.value.toLowerCase().startsWith("group:")}var g=[],v=false,t="",G="",f=[],Gb=[],Nb=[],Hb=[];function nb(){if(v)return Strings.STS.L_Share_PageWelcomeMessageNoDetails;else if(Boolean(t))return String.format(Strings.STS.L_Share_PageWelcomeMessageFormat_AddToGroupMode,t);else{var a=document.getElementById("DdlGroup");if(a!=null&&a.length>0){var d=Ab(a),c="";if(a.selectedIndex!=-1&&Boolean(f[a.selectedIndex]))c=f[a.selectedIndex].PermissionDescription;return String.format(Strings.STS.L_Share_PageWelcomeMessage,c)}else{var b=document.getElementById("DdlSimplifiedRoles");if(b!=null&&b.length>0)return Strings.STS.L_Share_PageWelcomeMessageNoDetails}}return null}function kb(){var a=document.getElementById("Label_Aclinv_PageWelcomeDescription");if(a!=null){if(!v&&!Boolean(t)&&Boolean(G))a.innerHTML=String.format(Strings.STS.L_Share_PageWelcomeDescription_WithInheritance,G);else CSSUtil.AddClass(a,"ms-hide");c()}}function W(){var c=document.getElementById("chkSendEmailv15"),d=Boolean(c)&&c.checked,b=document.getElementById("divEmailBody");b!=null&&SetChildControlsDisabledStatus(b,!d);var a=document.getElementById("chkRequireSignIn");if(a!=null)a.checked=true}var S=false,M=false,O=false,b=null;function E(b){var a=null;if(SPClientPeoplePicker!=null&&SPClientPeoplePicker.SPClientPeoplePickerDict!=null)if(b!=null)a=SPClientPeoplePicker.SPClientPeoplePickerDict[b];else for(var c in SPClientPeoplePicker.SPClientPeoplePickerDict){a=SPClientPeoplePicker.SPClientPeoplePickerDict[c];if(a!=null)break}return a}function vb(){if(Flighting.VariantConfiguration.IsExpFeatureClientEnabled(738)){var j=document.getElementById("TxtEmailBody"),e=500,i=450,f=HtmlEncodeAllowSimpleTextLength(j.value),a=document.getElementById("emailBodyCounter"),b=document.getElementById("btnShare"),d="",h=a.innerHTML.length==0,g=Boolean(a.lastChild)&&a.lastChild.className=="ms-formvalidation";if(f>e){if(!g){d=String.format(Strings.STS.L_Share_EmailBodyTooLong_Message,e.toString());a.innerHTML='<span role="alert" class="ms-formvalidation">'+STSHtmlEncode(d)+"<br/></span>";if(Boolean(b))b.disabled=true;c()}}else if(f<i){if(!h){a.innerHTML="";if(Boolean(b))b.disabled=false;c()}}else{d=f.toString()+"/"+e.toString();a.innerHTML='<span role="alert">'+STSHtmlEncode(d)+"<br/></span>";if(h||g){if(Boolean(b))b.disabled=false;c()}}}}function gb(l,a){if(b==null)b=E(l);if(b!=null){var e=document.getElementById("chkSendEmailv15");if(e!=null)if(b.HasResolvedUnverifiedEmail()){e.checked=true;e.disabled=true}else e.disabled=false;var h="peoplePicker_ValidateNoPermissionToInviteGroups",f=document.getElementById(h);if(Boolean(v)&&Boolean(f)&&Boolean(a)&&a.length>0){CSSUtil.AddClass(f,"ms-hide");g[h]=false;for(var d=0,m=a.length;d<m;d++)if(Boolean(a[d].IsResolved)){var i=a[d].EntityData.PrincipalType;if(!Boolean(i))i=a[d].EntityType;if("SharePointGroup"==i){g[h]=true;CSSUtil.RemoveClass(f,"ms-hide");break}}}var j=false;if(Flighting.VariantConfiguration.IsExpFeatureClientEnabled(305)){var k=document.getElementById("aclinv_SharingTips");j=RenderDLPLite(k,a,c)}if(S&&b.HasResolvedUnverifiedEmail()&&!j)if(O&&!M)alert(Strings.STS.L_Sharing_External_Sharing_Warning);else{b.ShowErrorMessage(Strings.STS.L_Sharing_External_Sharing_Warning);M=true}}c()}function hb(){c()}var rb="{%version 2.0}        <div id='pageStatusBar'></div>        <div class='ms-core-form ms-aclinv-dialog'                 id='mainAclinv'>            <div class='ms-core-form-section'                     id='divSharingInformation'>            </div>            <div id='sharingDialogMainContentRegion'>                <table id='tabbedControl' role='presentation'                         class='ms-aclinv-tabbedControl'>                    <tr class='ms-aclinv-tabbedCtrl-td'>                        <td id='tabsTD'                            class='ms-aclinv-tabborder ms-aclinv-tabbedControl-tabs'>                            <div class='noindex ms-core-listMenu-verticalBox'>                                <ul role='tablist' class='ms-noList ms-core-listMenu-root'>                                    <li role='tab' id='lnkShrItem'                                         class='static'>                                        <a id='lnkShrDlg'                                            aria-selected='true'                                            class='ms-aclinv-tabbedControl-tabLinks static menu-item ms-core-listMenu-item ms-displayInline ms-navedit-linkNode selected ms-core-listMenu-selected'                                            href='javascript:;'                                            onclick='{+onClickInviteTab}'>                                            {=/Strings/STS/L_SharedWithDialogInvitePeople}                                        </a>                                    </li>                                    <li role='tab' id='lnkGetLnkItem'                                         class='static'>                                        <a id='lnkGetLnkDlg'                                            class='ms-aclinv-tabbedControl-tabLinks static menu-item ms-core-listMenu-item ms-displayInline ms-navedit-linkNode'                                            href='javascript:;'                                            onclick='{+onClickGetLinksTab}'>                                            {=/Strings/STS/L_Share_GetLinks}                                        </a>                                    </li>                                    <li role='tab' id='lnkSharedWithDlgItem'                                         class='static'>                                        <a id='lnkSharedWithDlg'                                            class='ms-aclinv-tabbedControl-tabLinks static menu-item ms-core-listMenu-item ms-displayInline ms-navedit-linkNode'                                            href='javascript:;'                                            onclick='{+onClickSharedWithTab}'>                                            {=/Strings/STS/L_Share_SharedWith}                                        </a>                                    </li>                                </ul>                            </div>                        </td>                        <td class='ms-aclinv-tabbedControl-centralPadding' id='tabCenter'></td>                        <td class='ms-aclinv-tabbedControl-tabPanel'>                            <div>                                <div id='SharingDialogCore'>                                    <div id='sharingDlgDiv'>                                        <div class='ms-core-form-section'>                                            <div class='ms-core-form-subsection'                                                     id='WelcomeAreaFormSection'>                                                <span id='divWelcomeMessage'                                                     class='ms-h3 ms-soften ms-core-form-line'>                                                    <span id='Label_Aclinv_PageWelcomeMessage'></span>                                                </span>                                                <div id='divWelcomeDescription'                                                         class='ms-core-form-line'>                                                    <span id='Label_Aclinv_PageWelcomeDescription'></span>                                                </div>                                            </div>                                            <div class='ms-core-form-subsection'>                                                <div class='ms-table ms-fullWidth'>                                                    <div class='ms-tableRow'>                                                        <div class='ms-tableCell ms-fullWidth ms-aclinv-people-picker'>                                                            <div id='peoplePicker'></div>                                                            <div id='aclinv_SharingTips'></div>                                                        </div>                                                        <div id='PanelSimplifiedRoleSelector'                                                                 class='ms-tableCell ms-verticalAlignTop ms-aclinv-simplified-roles-container ms-hide'>                                                            <select id='DdlSimplifiedRoles' title='{=/Strings/STS/L_ChoosePermissionLevelAltText}'                                                                     class='ms-aclinv-simplified-roles ms-floatRight'></select>                                                        </div>                                                    </div>                                                </div>                                                <span id='peoplePicker_ValidateNoPermissionToInviteGroups'                                                      class='ms-error ms-hide' role='alert'>{=/Strings/STS/L_Share_NoPermissionToInviteGroups}</span>                                            </div>                                            <div class='ms-core-form-subsection'>                                                <div class='ms-core-form-line'                                                        id='divEmailBody'>                                                    <textarea title='{=/Strings/STS/L_Share_EmailBody_Title}'                                                                 class='ms-fullWidth ms-aclinv-message-input'                                                                 id='TxtEmailBody'                                                                 rows='6'                                                                 cols='40'                                                                 placeholder='{=/Strings/STS/L_EmailBody_HelperText}'                                                                oninput='{+onEmailBodyInput}'                                                                alwaysenablesilent='true' ></textarea>                                                    <div id='emailBodyCounter' class='ms-aclinv-emailBodyCounter'></div>                                                </div>                                                <div class='ms-core-form-line'>                                                    <div id='divRequireSignIn' class='ms-hide'>                                                        <span class='ms-aclinv-checkbox'>                                                            <input id='chkRequireSignIn'                                                                     type='checkbox'>                                                            <label for='chkRequireSignIn'>                                                                <span title='{=/Strings/STS/L_Share_RequireSignIn_TooltipDescription}'                                                                        class='ms-tooltip'>{=/Strings/STS/L_Share_RequireSignIn_Checkbox}</span>                                                            </label>                                                        </span>                                                    </div>                                                </div>                                            </div>                                        </div>                                        <div id='divPropagateAcl' class='ms-hide ms-core-form-section'>                                            <input id='chkAclPropagation'                                                    type='checkbox'                                                   id='chkAclPropagation'                                                   class = 'ms-aclinv-checkbox'>                                            <label for='chkAclPropagation'>                                                <span>{=/Strings/STS/L_Share_PropagateAcl}</span>                                            </label>                                        </div>                                        <div class='ms-core-form-section ms-aclinv-show-hide-options'>                                            <div id='PanelShowHideMoreOptions'>                                                <a href='javascript:;'                                                     id='Share_ShowHideMoreOptions'                                                    class='ms-commandLink'                                                    onclick='{+onClickShowMoreOptions}'>{=/Strings/STS/L_Share_ShowOptions}</a>                                            </div>                                        </div>                                        <div class='ms-core-form-section'>                                            <div id='divMoreOptions' style='display:none'>                                                <div class='ms-core-form-subsection ms-aclinv-checkbox ms-hide'                                                        id='divSendEmailv15'>                                                    <span class=''>                                                        <input id='chkSendEmailv15'                                                                type='checkbox'                                                                checked='checked'                                                                onclick='{+onClickChkSendEmail}' />                                                        <label for='chkSendEmailv15'>                                                            <span>{=/Strings/STS/L_SendEmailCheckboxv15}</span>                                                        </label>                                                    </span>                                                    <br />                                                </div>                                                <div id='divGivePermissions' class='ms-core-form-subsection'>                                                    <div id='headingGivePermissions' class='ms-h3 ms-soften ms-core-form-line'>{=headingGivePermissionsText}</div>                                                    <div class='ms-core-form-line'>                                                        <select id='DdlGroup'                                                                class='ms-fullWidth'                                                                onchange='{+onGroupDropDownChanged}' ></select>                                                        <br />                                                        <span id='CusValGroup'                                                                class='ms-error ms-hide'                                                                role='alert'>{=/Strings/STS/L_Share_CannotEditMembership}</span>                                                        <div id='PanelPictureLibraryNote'                                                                class='ms-hide'>                                                            <br /><br />                                                            <span class='ms-alerttext'>{=/Strings/STS/L_Share_PicLibNoteLabel}</span>                                                            {=/Strings/STS/L_Share_PicLibNote}                                                        </div>                                                    </div>                                                </div>                                            </div>                                        </div>                                        <div class='ms-core-form-section ms-core-form-bottomButtonBox'>                                            <img id='ms-share-prgBar'                                                    alt='{=/Strings/STS/L_Share_LoadingAltText}'                                                    class='ms-hide'                                                    src='{=loadingCirlceImage}'                                                    onclick='this.style.display=\"none\";' />                                            <input id='btnShare'                                                    class='ms-button-emphasize ms-aclinv-share-button'                                                    onclick='{+onClickBtnShare}'                                                    type='button'                                                    value='{=/Strings/STS/L_Share_SubmitButton_Text}'                                                    accesskey='{=/Strings/STS/L_Share_SubmitButton_AccessKey}' />                                            <input class='ms-ButtonHeightWidth ms-aclinv-cancel-button'                                                    type='button'                                                    id='BtnCancel'                                                    onclick='{+onClickBtnCancel}'                                                    value='{=/Strings/STS/L_CancelButtonCaption}'                                                    accesskey='{=/Strings/STS/L_SelectForeColorKey_TEXT}' />                                        </div>                                    </div>                                </div>                                <div id='GetLinksDialogCore'>                                    <div id='GetLinksDialog'                                         class='ms-hide' ></div>                                </div>                                <div id='SharedWithDlgCore'>                                    <div id='SharedWithDlg'                                         class='ms-hide' ></div>                                </div>                            </div>                        </td>                    </tr>                </table>            </div>        </div>",Ib;DisplayClientSharingDialog=function(m,d,i,c,h,k,a,g,j){if(!Boolean(d))return false;if(Boolean(b))b=null;var l=0,e=function(e,b){eb(b,d,i,c,k,a,j)},f=function(b,c){GetSharingSettings(b,c,typeof a!="undefined"&&Boolean(a)?a:m,d,l,g)};if(Boolean(h))EnsureScriptFunc("SP.UI.Dialog.js","SP.UI.ModalDialog.showWaitScreenWithNoClose",function(){var a=function(){DismissTopDlg(0)};SP.UI.ModalDialog.showWaitScreenWithNoClose(SP.Res.genericLoading,null,null,null);f(function(c,b){a();e(c,b)},function(d,b){a();typeof c=="function"&&c(SharingDialogReturnCode.Error,"Sharing context retrieval failed: "+b)})});else f(e,c);return true};function eb(a,cb,w,o,m,l,s){for(var r=typeof w==="undefined"||w==null,d=a.SharePointSettings,T=d.RequiredScriptFileLinks.results,e=0,M=T.length;e<M;e++){var bb=new URI(T[e]),Z=bb.getPath(),x=Z.substring(Z.lastIndexOf("/")+1),eb=x.indexOf(".debug.js");if(eb>0)x=x.substr(0,eb)+".js";RegisterSod(x,bb.getString())}var j=a.ObjectSharingInformation,K=j.CanBeShared,B=!j.CanManagePermissions&&!a.AccessRequestMode;if(!K&&(!Boolean(m)||m==SharingTabToShow.SharingDialog)){if(r)RenderLockdownModeDialog(a.WebUrl,a.IsUserSiteAdmin);else L(w,a.WebUrl,a.IsUserSiteAdmin);return}var db=a.ListId,Y=a.ItemName,Q=a.SupportsAclPropagation,jb=a.PermissionsOnlyMode,R=a.CanCurrentUserRetrieveReadonlyLink,D=R,V=d.SharedWithEnabled,X=d.txtEmailSubjectText,q=d.PickerProperties,U="MoreOptions";L_CanManageReadWriteLink=a.CanCurrentUserManageReadWriteLink||a.CanCurrentUserManageOrganizationReadWriteLink;L_CanManageReadonlyLink=a.CanCurrentUserManageReadonlyLink||a.CanCurrentUserManageOrganizationReadonlyLink;L_WebUrl=a.WebUrl;L_ContextWebUrl=l;L_ListID=db=="00000000-0000-0000-0000-000000000000"?null:db;L_ItemID=a.ItemId;L_ItemName=Y;L_ItemUrl=a.ItemUrl;L_UserDispUrl=d.UserDisplayUrl;if(!(window.OffSwitch==null||OffSwitch.IsActive("CC8E165C-7A86-43B6-AC8F-5C08125C5EE7"))){var k=a.DefaultShareLinkType;k=k===SharingLinkKind.Uninitialized?SharingLinkKind.AnonymousEdit:k;var lb=k===SharingLinkKind.AnonymousEdit||k===SharingLinkKind.AnonymousView,ib=k===SharingLinkKind.OrganizationEdit||k===SharingLinkKind.OrganizationView;if(lb)if(a.CanCurrentUserManageReadWriteLink)L_SelectedSharingLinkKind=k;else if(a.CanCurrentUserManageReadonlyLink)L_SelectedSharingLinkKind=SharingLinkKind.AnonymousView;else if(a.CanCurrentUserManageOrganizationReadWriteLink)L_SelectedSharingLinkKind=SharingLinkKind.OrganizationEdit;else if(a.CanCurrentUserManageOrganizationReadonlyLink)L_SelectedSharingLinkKind=SharingLinkKind.OrganizationView;else L_SelectedSharingLinkKind=SharingLinkKind.Direct;else if(ib)if(a.CanCurrentUserManageOrganizationReadWriteLink)L_SelectedSharingLinkKind=k;else if(a.CanCurrentUserManageOrganizationReadonlyLink)L_SelectedSharingLinkKind=SharingLinkKind.OrganizationView;else L_SelectedSharingLinkKind=SharingLinkKind.Direct;else L_SelectedSharingLinkKind=SharingLinkKind.Direct}S=a.ShowExternalSharingWarning;if(Boolean(j)&&Boolean(j.SharingLinks)){L_SharingLinks=j.SharingLinks.results;if(Boolean(L_ItemID)&&Boolean(L_SharingLinks)){L_SharingLinks=m$.filter(L_SharingLinks,function(b){if(((b.LinkKind==SharingLinkKind.OrganizationEdit||b.LinkKind==SharingLinkKind.AnonymousEdit)&&!L_CanManageReadWriteLink||(b.LinkKind==SharingLinkKind.OrganizationView||b.LinkKind==SharingLinkKind.AnonymousView)&&!L_CanManageReadonlyLink)&&(!Boolean(b.Url)||!b.IsActive))return false;!Boolean(L_SharingLinkProperties)&&n();if(L_SharingLinkProperties[b.LinkKind].SupportsExpiration)L_SharingLinkProperties[b.LinkKind].Expiration=b.Expiration;return!(b.LinkKind==SharingLinkKind.AnonymousView&&!a.CanCurrentUserRetrieveReadonlyLink)&&!(b.LinkKind==SharingLinkKind.AnonymousEdit&&!a.CanCurrentUserRetrieveReadWriteLink)});if(L_SharingLinks.length>0)D=true}}else L_SharingLinks=null;if(R&&Boolean(j)&&j.IsSharedWithGuest){L_AnonymousViewLink=j.AnonymousViewLink;L_AnonymousEditLink=j.AnonymousEditLink}else{L_AnonymousViewLink=null;L_AnonymousEditLink=null}L_RequiredAnonymousLinkExpirationInDays=a.RequiredAnonymousLinkExpirationInDays;sharingInfo={};sharingInfo.HasEditRole=a.HasEditRole;sharingInfo.HasViewRole=a.HasReadRole;J(j);var F=true,y=3;if(!D)y--;if(!V)y--;if(!K)y--;F=y>=2;v=a.AccessRequestMode;t=d.AddToGroupModeName;G=a.InheritingWebLink;f=a.SharingPermissions.results;var mb=function(){if(b==null)b=E(null);var m=function(){if(b==null)b=E(null);if(b!=null){b.Validate();c();if(!Boolean(b.HasInputError)&&!Boolean(b.HasServerError)){g.peoplePickerError=false;return true}}g.peoplePickerError=true;return false},j=0;if(m()){var p=b.GetCurrentEditorValue();if(p!=null&&p!=""){b.CloseAutoFill();b.AddUnresolvedUserFromEditor(false);g.peoplePickerError=true;b.ResolveAllUsers(function(){m()&&f()})}j=b.TotalUserCount}var d=document.getElementById("DdlSimplifiedRoles");if(d==null||d.length==0)d=document.getElementById("DdlGroup");var e="CusValGroup",i=document.getElementById(e),n="group:";if(!Boolean(g[e])&&Boolean(i)&&Boolean(d)&&Boolean(d.value)&&d.value.indexOf(n)==0){var u=d.value.substring(n.length),k=parseInt(u);if(!isNaN(k)&&k>0){var t="_api/"+(Boolean(l)?"SP.RemoteWeb(@url)/GetGroupById(@groupId)":"web/SiteGroups/GetByID(@groupId)")+"/CanCurrentUserEditMembership?@groupId="+String(k)+(Boolean(l)?"&@url='"+a.WebUrl+"'":""),s=function(b,a){if(!Boolean(a.CanCurrentUserEditMembership)){CSSUtil.RemoveClass(i,"ms-hide");g[e]=true;c()}else{CSSUtil.AddClass(i,"ms-hide");g[e]=false;c();f()}},q=function(){f()};g[e]=true;h(s,q,Boolean(l)?l:a.WebUrl,t,null)}}var f=function(){for(var v in g)if(Boolean(g[v]))return;O=true;var k=document.getElementById("btnShare");if(Boolean(k))k.disabled=true;var h=document.getElementById("ms-share-prgBar");Boolean(h)&&CSSUtil.RemoveClass(h,"ms-hide");var f=document.getElementById("chkSendEmailv15"),e=document.getElementById("chkRequireSignIn"),i=document.getElementById("TxtEmailBody"),s=document.getElementById("chkAclPropagation"),m=false;if(e!=null)m=e.checked;var u=false;if(f!=null)u=f.checked;var c="";if(d!=null){var q=d.value;switch(q){case"role:1073741827":c="Contribute";break;case"role:1073741826":c="View";break;case"role:1073741829":c="Full Control";break;case"role:1073741828":c="Design";break;case"role:1073741830":c="Edit";break;default:c=q}}var t=a.ListId=="00000000-0000-0000-0000-000000000000"&&!Boolean(a.ItemId)&&Boolean(a.SharePointSettings.PanelSimplifiedRoleSelectorVisible);if(t)SP.QoS.WriteUserEngagement("SharingDialogShareButtonClickedOnSiteSharing",{RequireSignIn:e,SendEmail:f,Users:j,Type:c});else SP.QoS.WriteUserEngagement("SharingDialogShareButtonClicked",{RequireSignIn:e,SendEmail:f,Users:j,Type:c});var p=function(f,a){if(Boolean(a)){var d=[],c=[],b=0;if(Boolean(a.UsersAddedToGroup)&&Boolean(a.UsersAddedToGroup.results)){c=a.UsersAddedToGroup.results;for(b=0;b<c.length;b++)d.push(c[b].DisplayName)}if(Boolean(a.UniquelyPermissionedUsers)&&Boolean(a.UniquelyPermissionedUsers.results)){c=a.UniquelyPermissionedUsers.results;for(b=0;b<c.length;b++)d.push(c[b].DisplayName)}var e=Boolean(a.InvitedUsers)&&d.length==0;EnsureScriptFunc("core.js","addSharingNotification",function(){addSharingNotification(a.Name,a.IconUrl,d,a.StatusCode==1,!m,e,false)})}typeof o=="function"&&o(SharingDialogReturnCode.Success);r&&I(SP.UI.DialogResult.OK)},n=function(b,a){if(Boolean(k))k.disabled=false;Boolean(h)&&CSSUtil.AddClass(h,"ms-hide");typeof o=="function"&&o(SharingDialogReturnCode.Error,"Sharing failed: "+a)};if(B)ForwardObjectLink(p,n,Boolean(l)?l:a.WebUrl,cb,b!=null?b.GetControlValueAsText():null,X,i!=null?i.value:null);else ShareObject(p,n,Boolean(l)?l:a.WebUrl,cb,b!=null?b.GetControlValueAsText():null,d!=null?d.value:null,0,s!=null&&s.checked,f!=null&&f.checked,e!=null&&!e.checked,X,i!=null?i.value:null)};f()},i=new Renderer;i.SetTemplate("main",rb);i.RegisterHandler("onClickInviteTab",function(){SP.QoS.WriteUserEngagement("SharingInviteTabClicked");A("sharingDlgDiv",true);return false});i.RegisterHandler("onClickGetLinksTab",function(){SP.QoS.WriteUserEngagement("SharingDialogGetALinkTabClicked");ab();return false});i.RegisterHandler("onClickSharedWithTab",function(){SP.QoS.WriteUserEngagement("SharingDialogSharedWithTabClicked");H();return false});i.RegisterHandler("onEmailBodyInput",function(){vb()});i.RegisterHandler("onClickShowMoreOptions",function(){xb(false)});i.RegisterHandler("onClickChkSendEmail",W);i.RegisterHandler("onGroupDropDownChanged",P);i.RegisterHandler("onClickBtnShare",mb);i.RegisterHandler("onClickBtnCancel",function(){SP.QoS.WriteUserEngagement("SharingInviteTabCloseClicked");r&&I(SP.UI.DialogResult.cancel);typeof o=="function"&&o(SharingDialogReturnCode.Cancel)});var ob={loadingCirlceImage:"/_layouts/15/images/loadingcirclests16.gif?rev=47",headingGivePermissionsText:jb?Strings.STS.L_Share_Step2Title1v15_PermissionsOnlyMode:Strings.STS.L_Share_Step2Title1v15},u=r?document.createElement("div"):w;if(Boolean(s))if(!(window.OffSwitch==null||OffSwitch.IsActive("de1c81d4-8dec-44cd-b6ef-5cc49b926583"))){ModernSharingDialogUrl=a.WebUrl+"/_layouts/15/sharedialog.aspx?clientId=sharepoint&listId={"+a.ListId+"}&listItemId="+a.ItemId+"&IsDlg=1&mode=manageAccess";u.innerHTML="                     <iframe id='dlgModernIFrame' class='ms-dlgFrame' frameborder='0' role='presentation' style='width: 320px; height: 650px;'></iframe>"}else u.innerHTML="                     <iframe id='DlgIFrame' class='ms-dlgFrame' src='"+a.WebUrl+"/_layouts/15/sharedialog.aspx?clientId=sharepoint&amp;listId={"+a.ListId+"}&amp;listItemId="+a.ItemId+"&amp;IsDlg=1&amp;mode=manageAccess' frameborder='0' role='presentation' style='width: 320px; height: 650px;'></iframe>";else u.innerHTML=i.Render("main",ob);var N=function(){registerCssLink(d.SharingCssLink);var y=q.PrincipalSource,b={};b.Required=true;b.AllowMultipleValues=true;b.VisibleSuggestions=h?5:2;b.Rows=3;b.Width="100%";b.SetFocus=true;b.PrincipalAccountType=q.PrincipalAccountType;b.AllowEmailAddresses=q.AllowEmailAddresses;b.AllowOnlyEmailAddresses=q.AllowOnlyEmailAddresses;b.SearchPrincipalSource=y;b.ResolvePrincipalSource=y;b.OnUserResolvedClientScript=gb;b.OnControlValidateClientScript=hb;b.QuerySettings=q.QuerySettings;EnsureScriptFunc("clientforms.js","SPClientPeoplePicker_InitStandaloneControlWrapper",function(){EnsureScript("clientpeoplepicker.js",typeof SPClientPeoplePicker,function(){SPClientPeoplePicker.InitializeStandalonePeoplePicker("peoplePicker",null,b);c()})});var U,l=document.getElementById("PanelSimplifiedRoleSelector");if(Boolean(l)&&d.PanelSimplifiedRoleSelectorVisible){var g=document.getElementById("DdlSimplifiedRoles");if(Boolean(g)&&!B){for(var A=a.SimplifiedRoles.results,v=d.SelectedGroup,e=0,T=A.length;e<T;e++){var i=A[e],R;if(Boolean(f[e])&&Boolean(f[e].PermissionDescription)&&i.Value==f[e].PermissionId)R=f[e].PermissionDescription;p(g,i.Key,i.Value,R);if(Boolean(v)&&i.Value==v)g.selectedIndex=g.length-1}g.length>0&&CSSUtil.RemoveClass(l,"ms-hide")}}var h=a.CanSendEmail,k=document.getElementById("DdlGroup"),M=document.getElementById("TxtEmailBody");M!=null&&h&&ElementCreator("textarea",M);var I=document.getElementById("divEmailBody");I!=null&&!h&&CSSUtil.AddClass(I,"ms-hide");if(Q){var x=document.getElementById("divPropagateAcl");x!=null&&CSSUtil.RemoveClass(x,"ms-hide");var t=document.getElementById("chkAclPropagation");if(t!=null)t.checked=true}var J=document.getElementById("divSendEmailv15");J!=null&&h&&CSSUtil.RemoveClass(J,"ms-hide");var w=document.getElementById("divRequireSignIn");Boolean(w)&&a.CanSendLink&&CSSUtil.RemoveClass(w,"ms-hide");var r=document.getElementById("divGivePermissions");if(Boolean(r))if(d.PanelGivePermissionsVisible){if(Boolean(k))if(Boolean(simpleSiteSharingFeature))fb();else z()}else CSSUtil.AddClass(r,"ms-hide");var j=document.getElementById("PanelShowHideMoreOptions");j!=null&&!h&&(k==null||k.length==0)&&CSSUtil.AddClass(j,"ms-hide");B&&CSSUtil.AddClass(j,"ms-hide");var n=document.getElementById("PanelPictureLibraryNote");Boolean(n)&&a.IsPictureLibrary&&CSSUtil.RemoveClass(n,"ms-hide");if(F){var u=document.getElementById("divWelcomeMessage");Boolean(u)&&CSSUtil.AddClass(u,"ms-hide")}else{var S=document.getElementById("tabsTD");Boolean(S)&&CSSUtil.AddClass(S,"ms-hide");var O=document.getElementById("tabCenter");Boolean(O)&&CSSUtil.AddClass(O,"ms-hide")}if(d.IsMobileView){var E=document.getElementById("mainAclinv");Boolean(E)&&CSSUtil.AddClass(E,"ms-aclinv-mobile")}C();kb();W();P();if(!K){var N=document.getElementById("lnkShrItem");Boolean(N)&&CSSUtil.AddClass(N,"ms-hide")}if(!D){var L=document.getElementById("lnkGetLnkItem");Boolean(L)&&CSSUtil.AddClass(L,"ms-hide")}else Boolean(m)&&m==SharingTabToShow.GetLinks&&!Boolean(s)&&ab();if(!V){var G=document.getElementById("lnkSharedWithDlgItem");Boolean(G)&&CSSUtil.AddClass(G,"ms-hide")}else Boolean(m)&&m==SharingTabToShow.SharedWith&&H();var o=document.getElementById("dlgModernIFrame");if(o!=null&&!(window.OffSwitch==null||OffSwitch.IsActive("de1c81d4-8dec-44cd-b6ef-5cc49b926583")))o.src=ModernSharingDialogUrl;c()};function p(d,c,e,b){if(!Boolean(d))return;var a=document.createElement("option");a.innerText=STSHtmlEncode(c);a.text=c;a.value=e;if(Boolean(b))a.title=b;d.appendChild(a)}function fb(){var a=document.getElementById("DdlGroup");if(!Boolean(a)||!Boolean(simpleSiteSharingFeature))return;var c=d.SelectedGroup;for(e=0;e<f.length;e++){var b=f[e];if(b.IsDefaultPermission){var g=Boolean(f[e].PermissionDescription)?f[e].PermissionDescription:"";p(a,b.PermissionName,b.PermissionId,g);if(Boolean(c)&&b.PermissionId==c)a.selectedIndex=a.length-1}}if(a.length>0)p(a,Strings.STS.L_SiteSharePerm_ShowMore,U);else z()}function z(){var a=document.getElementById("DdlGroup");if(!Boolean(a))return;var c=d.SelectedGroup,h;a.length=0;for(e=0,M=f.length;e<M;e++){var b=f[e],g="";if(Boolean(b)&&Boolean(b.IsDefaultPermission))g=b.PermissionDescription;p(a,b.PermissionName,b.PermissionId,g);if(Boolean(c)&&b.PermissionId==c)a.selectedIndex=a.length-1}a.length==0&&p(a,Strings.STS.L_LookupFieldNoneOption,"")}function P(){var a=document.getElementById("DdlGroup");if(Boolean(simpleSiteSharingFeature)&&Boolean(a)&&a.selectedIndex!=-1&&a.options[a.selectedIndex].value==U){z();SP.QoS.WriteUserEngagement("SimpleSiteSharing_AdvancedPermission_ShowMoreOptionsClicked")}var d=document.getElementById("Label_Aclinv_PageWelcomeMessage");if(Boolean(d))d.innerHTML=nb();var e="CusValGroup",b=document.getElementById("CusValGroup");if(Boolean(b)){CSSUtil.AddClass(b,"ms-hide");g[e]=false}c()}var pb=null;if(r)EnsureScriptFunc("SP.UI.Dialog.js","SP.UI.ModalDialog.showModalDialog",function(){var b=s?320:F?595:450,a=s?Strings.STS.L_Share_PageTitleFormat_withAclPropagation_ModernUI:Strings.STS.L_Share_PageTitleFormat_withAclPropagation,d=s?Strings.STS.L_Share_PageTitleFormat_ModernUI:Strings.STS.L_Share_PageTitleFormat,c={html:u,title:String.format(Q?a:d,Y),allowMaximize:false,includeScrollBarPadding:false,autoSizeStartWidth:b};pb=SP.UI.ModalDialog.showModalDialog(c);N()});else N()}function e(b){var c=b;if(Boolean(b)){var a=document.createElement("A");a.style.display="none";a.href=b;document.body.appendChild(a);c=a.href}return c}function Bb(){var a=document.getElementById("BtnCancel");Boolean(a)&&a.focus()}function A(d,e){var a=[];a.sharingDlgDiv="lnkShrDlg";a.GetLinksDialog="lnkGetLnkDlg";a.SharedWithDlg="lnkSharedWithDlg";var b=function(){for(var h in a){var b=document.getElementById(h);if(Boolean(b)){AddCssClassToElement(b,"ms-hide");b.style.opacity=0}b=document.getElementById(a[h]);if(Boolean(b)){RemoveCssClassFromElement(b,"selected");RemoveCssClassFromElement(b,"ms-core-listMenu-selected");b.setAttribute("aria-selected","false")}}var e=document.getElementById(d);if(Boolean(e)){RemoveCssClassFromElement(e,"ms-hide");AddCssClassToElement(e,"ms-aclinv-tabbedControl-fadingEnabled");e.style.opacity=1;DOM.AddEventHandler(e,"webkitTransitionEnd",c);DOM.AddEventHandler(e,"transitionEnd",c);var g=a[d];if(Boolean(g)){var f=document.getElementById(g);if(Boolean(f)){AddCssClassToElement(f,"selected");AddCssClassToElement(f,"ms-core-listMenu-selected");Boolean(f.setAttribute)&&f.setAttribute("aria-selected","true")}}Accessibility.FocusFirstTabStop(e)}};if(e)o(b);else b()}function ab(){EnsureScriptFunc("SP.UI.Dialog.js","SP.UI.ModalDialog.showModalDialog",function(){Eb()})}function H(){EnsureScriptFunc("SP.UI.Dialog.js","SP.UI.ModalDialog.showModalDialog",function(){A("SharedWithDlg",false);DisplaySharedWithDialog(L_WebUrl,L_ListID,L_ItemID,false,false,L_ContextWebUrl)})}GetManageLinkParams=function(){return new ManageLinkParams(L_WebUrl,L_ListID,L_ItemID,!Boolean(L_AnonymousEditLink)||L_AnonymousEditLink==""?null:L_AnonymousEditLink,!Boolean(L_AnonymousViewLink)||L_AnonymousViewLink==""?null:L_AnonymousViewLink,L_CanManageReadWriteLink||L_CanManageReadonlyLink,Db,L_ContextWebUrl,L_SharingLinks,L_RequiredAnonymousLinkExpirationInDays)};function Eb(){EnsureScriptFunc("SP.UI.Dialog.js","SP.UI.ModalDialog.showModalDialog",function(){DisplayManageLinkDialog(GetManageLinkParams())})}function Db(g,b){var a=document.getElementById("js-sharingdlg-guestLink");if(!Boolean(b)){Boolean(a)&&a.focus();return}var e=Boolean(b.editLinkDisabled),f=Boolean(b.viewLinkDisabled);if(e)L_AnonymousEditLink=null;if(f)L_AnonymousViewLink=null;if(!Boolean(L_AnonymousViewLink)&&!Boolean(L_AnonymousEditLink)){var d=document.getElementById("js-sharingdlg-guestLinkDiv");if(d!=null)d.style.display="none";Bb();c()}else Boolean(a)&&a.focus()}function ub(a){ApplySharingListStyles(a);m$(a).find(".js-sharingdlg-sharedWithLink").click(function(){var a=false,c=typeof window.top.g_childDialog!="undefined"?window.top.g_childDialog:undefined;if(Boolean(c)){var b=c.get_args();if(b!=null&&Boolean(b.LaunchedWithCallback))a=true}var d=Flighting.VariantConfiguration.IsExpFeatureClientEnabled(17);if(d)H();else if(a)EnsureScriptFunc("SP.UI.Dialog.js","SP.UI.ModalDialog.commonModalDialogClose",function(){SP.UI.ModalDialog.commonModalDialogClose(100,null)});else DisplaySharedWithDialog(L_WebUrl,L_ListID,L_ItemID,false,false,L_ContextWebUrl);return false})}function C(){var a=document.getElementById("divSharingInformation");if(Boolean(a)){var b,c;a.innerHTML=GetSharingStatusHtml(sharingInfo.SharedUsers,sharingInfo.IsSharedWithMany,sharingInfo.IsSharedWithSecurityGroup,sharingInfo.IsSharedWithGuest,true,L_UserDispUrl,L_ItemName,b,b,b,c,sharingInfo.IsFolder,sharingInfo.TotalFileCount);a.innerHTML.length>0&&ub(a)}}function mb(){GetListItemSharingInformation(b,a,L_WebUrl,L_ListID,L_ItemID,true,false,true,true,false,false,false);function b(b,a){J(a);C()}function a(){}}var m={};RenderDLPLite=function(y,a,x){var l=false,s="aclInv_listOfGroups_memberCount",i=0;if(Flighting.VariantConfiguration.IsExpFeatureClientEnabled(305))if(Boolean(y)){var c=[];if(Boolean(a)&&a.length>0){var g=[],e=[];i=0;for(var b=0,D=a.length;b<D;b++)if(Boolean(a[b].IsResolved)){var q=A(a[b]),f=a[b].EntityData.PrincipalType;if(!Boolean(f))f=a[b].EntityType;switch(f){case SPClientPeoplePicker.PrincipalTypeGuestUser:case SPClientPeoplePicker.UnvalidatedEmailAddressKey:g.push(q);break;case"SecGroup":case"SharePointGroup":case"FormsRole":var d="groupMemberCount_"+String(b)+"_",j=0,o="";if(oversharingMitigation){if((f==="SecGroup"||f==="FormsRole")&&Boolean(a[b].EntityData.Email)){d+=a[b].EntityData.Email;if(typeof m[a[b].EntityData.Email]==="undefined")v(d,a[b].EntityData.Email,SP.Utilities.PrincipalType.securityGroup,a[b].Key);else j=m[a[b].EntityData.Email]}else if(f==="SharePointGroup"){d+=a[b].EntityData.SPGroupID;if(typeof m[a[b].EntityData.SPGroupID]==="undefined")v(d,a[b].EntityData.SPGroupID,SP.Utilities.PrincipalType.sharePointGroup,a[b].Key);else j=m[a[b].EntityData.SPGroupID]}i+=j;o=w(d,j,false)}if(Boolean(a[b].EntityData.Email))e.push(q+o);else e.push(String.format(Encoding.HtmlEncode(Strings.STS.L_DLPLite_SharingPage_GroupNotEmailEnabledText),q)+o)}}var n="aclInv_listOfExternalUsers",p="aclInv_listOfGroups";if(g.length>0){c.push("<div class='ms-aclinv-sharingTips-section'>");if(g.length==1)c.push(String.format(Encoding.HtmlEncode(Strings.STS.L_DLPLite_SharingPage_SingleExternalUserText),g[0]));else{c.push(Encoding.HtmlEncode(Strings.STS.L_DLPLite_SharingPage_MultipleExternalUsersText));r(c,n,g.join(", "))}c.push("</div>")}if(e.length>0){var C=SP.Utilities.LocUtility.getLocalizedCountValue(Encoding.HtmlEncode(Strings.STS.L_DLPLite_SharingPage_NumberOfGroupsShared),Encoding.HtmlEncode(Strings.STS.L_DLPLite_SharingPage_NumberOfGroupsSharedIntervals),e.length);c.push("<div class='ms-aclinv-sharingTips-section'>");c.push(String.format(C,e.length));if(oversharingMitigation){var B=w(s,i,true);c.push(B)}r(c,p,e.join(", "));c.push("</div>")}}y.innerHTML=c.join("");u(n+"_ShowHide","onclick",function(){t(this,n)});u(p+"_ShowHide","onclick",function(){t(this,p)});l=c.length>0;l&&x!=null&&x()}return l;function r(a,c,e){var d=document.getElementById(c),b=false;if(Boolean(d)&&!Sys.UI.DomElement.containsCssClass(d,"ms-hide"))b=true;a.push("&nbsp;<a id="+StAttrQuote(c+"_ShowHide")+" href='javascript:;' >");a.push(Encoding.HtmlEncode(b?Strings.STS.L_DLPLite_SharingPage_HideDetailsLinkText:Strings.STS.L_DLPLite_SharingPage_ShowDetailsLinkText));a.push("</a>");a.push("<div id="+StAttrQuote(c)+" class="+StAttrQuote(b?"":"ms-hide")+">");a.push(e);a.push("</div>")}function A(a){return Boolean(a)&&Boolean(a.DisplayText)?"<span class='ms-entity-resolved'>"+Encoding.HtmlEncode(a.DisplayText)+"</span>":""}function t(c,d){var b=document.getElementById(d);Boolean(b)&&Sys.UI.DomElement.toggleCssClass(b,"ms-hide");if(Sys.UI.DomElement.containsCssClass(b,"ms-hide"))c.innerHTML=Encoding.HtmlEncode(Strings.STS.L_DLPLite_SharingPage_ShowDetailsLinkText);else c.innerHTML=Encoding.HtmlEncode(Strings.STS.L_DLPLite_SharingPage_HideDetailsLinkText);var a=window.frameElement;if(a==null)a=SP.UI.ModalDialog.get_childDialog();a!=null&&typeof a.autoSize==="function"&&a.autoSize()}function u(b,c,d){var a=document.getElementById(b);a!=null&&DOM.AddEventHandler(a,c,d,false)}function k(a,b){return a==1?Encoding.HtmlEncode(b?Strings.STS.L_Sharing_GroupOneMember:Strings.STS.L_Sharing_GroupOneMember2):a>1&&a<1e3?String.format(Encoding.HtmlEncode(b?Strings.STS.L_Sharing_GroupMemberCount:Strings.STS.L_Sharing_GroupMemberCount2),String(a)):a>=1e3?Encoding.HtmlEncode(b?Strings.STS.L_Sharing_GroupMemberCountMoreThan1000:Strings.STS.L_Sharing_GroupMemberCountMoreThan1000_2):""}function w(d,a,b){return String.format(" <span id='{0}' {1}>{2}</span>",d,a>0?"":"style='display:none'",k(a,b))}function z(b){var a=document.getElementById(s);if(Boolean(a))if(b>0){a.innerHTML=k(b,true);a.style.display=""}else a.style.display="none"}function v(l,b,a,j){var f=function(c,a,b){if(!Boolean(b)){typeof a=="function"&&a();return}var d={entityInformationRequest:b},f=window._spPageContextInfo,i=f.webAbsoluteUrl,g="_api/SP.UI.ApplicationPages.ClientPeoplePickerWebServiceInterface.getPickerEntityInformation",e=JSON.stringify(d);h(c,a,i,g,e)},c=function(e,a){if(Boolean(a)&&Boolean(a.Entity)){var b=Number(a.TotalMemberCount),c=document.getElementById(d);if(Boolean(c)&&b>0){c.innerHTML=k(b,false);c.style.display=""}if(a.Entity.PrincipalType===SP.Utilities.PrincipalType.securityGroup)m[a.Entity.EmailAddress]=b;else m[a.Entity.GroupId]=b;i+=b;z(i)}},e=function(){},g={PrincipalType:a,EmailAddress:a===SP.Utilities.PrincipalType.securityGroup?b:"",GroupId:a===SP.Utilities.PrincipalType.sharePointGroup?Number(b):0,Key:j};f(c,e,g)}};FormatUserEntriesForSharing=function(d){var b=d.split(","),a="";if(b.length==0)return a;a+="[";for(var c=0;c<b.length;c++){var e=b[c];a+=String.format('{{"ResolveText":"{0}","IsResolved":"false","AutoFillKey":"{0}","Key":"{0}","AutoFillDisplayText":"{0}","DisplayText":"{0}"}}',e);if(c<b.length-1)a+=","}a+="]";return a};GetWebSharingInformation=function(i,h,j,f,g,e,d,b,c,a){GetObjectSharingInformation(i,h,j,"_api/web",f,g,e,d,b,c,a)};GetListSharingInformation=function(j,a,k,b,h,i,g,f,d,e,c){if(!Boolean(b)){typeof a=="function"&&a("Invalid sharing arguments.");return}GetObjectSharingInformation(j,a,k,"_api/web/Lists/GetById(id='"+b+"')",h,i,g,f,d,e,c)};GetListItemSharingInformation=function(k,a,l,c,b,i,j,h,g,e,f,d){if(!Boolean(c)||!Boolean(b)){typeof a=="function"&&a("Invalid sharing arguments.");return}GetObjectSharingInformation(k,a,l,"_api/web/Lists/GetById(id='"+c+"')/GetItemById(id='"+b+"')",i,j,h,g,e,f,d)};GetObjectSharingInformation=function(n,c,e,d,l,m,k,j,g,i,f){if(!Boolean(e)||!Boolean(d)){typeof c=="function"&&c("Invalid sharing arguments.");return}var a=new URI(d);a.setPath(a.getPath()+"/GetObjectSharingInformation");var b=a.getQuery();b=(Boolean(b)?b+"&":"?")+"$expand=SharedWithUsersCollection";a.setQuery(b);var o=JSON.stringify({excludeCurrentUser:l,excludeSiteAdmin:m,excludeSecurityGroups:k,retrieveAnonymousLinks:j,retrieveUserInfoDetails:g,checkForAccessRequests:i,retrievePermissionLevels:f});h(n,c,e,a.getString(),o)};GetObjectSharingInformationByUrl=function(n,b,c,a,k,m,j,i,f,g,d){if(!Boolean(c)||!Boolean(a)){typeof b=="function"&&b("Invalid sharing arguments.");return}var o=new URI(a),l=Boolean(o.getScheme())?a:e(a),q="_api/SP.ObjectSharingInformation.GetObjectSharingInformationByUrl?$expand=SharedWithUsersCollection",p=JSON.stringify({objectUrl:l,excludeCurrentUser:k,excludeSiteAdmin:m,excludeSecurityGroups:j,retrieveAnonymousLinks:i,retrieveUserInfoDetails:f,checkForAccessRequests:g,retrievePermissionLevels:d});h(n,b,c,q,p)};UpdateDocumentSharingInfo=function(k,c,d,a,b,i,l,g,q,f,m){if(!Boolean(d)||!Boolean(a)||!Boolean(b)||b.length<1){typeof c=="function"&&c("Invalid sharing arguments.");return}var n=new URI(a),j=Boolean(n.getScheme())?a:e(a),p="_api/SP.Sharing.DocumentSharingManager.UpdateDocumentSharingInfo",o=JSON.stringify({resourceAddress:j,userRoleAssignments:b,validateExistingPermissions:i,additiveMode:l,sendServerManagedNotification:g,customMessage:null,includeAnonymousLinksInNotification:f,propagateAcl:m});h(k,c,d,p,o)};CreateAnonymousLink=function(b,a,f,d,c,e){P(b,a,f,d,c,true,e)};DestroyAnonymousLink=function(b,a,e,d,c){P(b,a,e,d,c,false,null)};CreateOrganizationSharingLink=function(b,a,e,d,c){K(b,a,e,d,c,true)};DestroyOrganizationSharingLink=function(b,a,e,d,c){K(b,a,e,d,c,false)};GetSharingSettings=function(l,c,i,a,g,b){if(!Boolean(i)||!Boolean(a)){typeof c=="function"&&c("Invalid sharing arguments.");return}var f=new URI(a),k=Boolean(f.getScheme())?a:e(a),n="_api/SP.Web.GetObjectSharingSettings?$expand=ObjectSharingInformation,ObjectSharingInformation/SharedWithUsersCollection,SharePointSettings,SharePointSettings/PickerProperties,SharingPermissions",d=f.getQuery(),j=Boolean(b)||(typeof b!="boolean"||b==null)&&Boolean(d)&&d.indexOf("forSharing=1")!=-1,m=JSON.stringify({objectUrl:k,groupId:isNaN(g)?0:g,useSimplifiedRoles:j});h(l,c,i,n,m)};ShareObject=function(n,b,k,a,m,p,j,f,i,c,d,g){if(!Boolean(k)||!Boolean(a)){typeof b=="function"&&b("Invalid sharing arguments.");return}var o=new URI(a),l=Boolean(o.getScheme())?a:e(a),r="_api/SP.Web.ShareObject?$expand=UsersWithAccessRequests,GroupsSharedWith",q=JSON.stringify({url:l,peoplePickerInput:m,roleValue:p,groupId:isNaN(j)?0:j,propagateAcl:Boolean(f)?f:false,sendEmail:Boolean(i)?i:false,includeAnonymousLinkInEmail:Boolean(c)?c:false,emailSubject:Boolean(d)?d:null,emailBody:Boolean(g)?g:null});h(n,b,k,r,q)};UnshareObject=function(d,c,b,i,e){var g="_api/SP.Web.UnshareObject",a={};a.url=z(b,i,e);var f=JSON.stringify(a);h(d,c,b,g,f)};ForwardObjectLink=function(j,b,f,a,i,c,d){if(!Boolean(f)||!Boolean(a)){typeof b=="function"&&b("Invalid sharing arguments.");return}var k=new URI(a),g=Boolean(k.getScheme())?a:e(a),m="_api/SP.Web.ForwardObjectLink",l=JSON.stringify({url:g,peoplePickerInput:i,emailSubject:Boolean(c)?c:null,emailBody:Boolean(d)?d:null});h(j,b,f,m,l)};function P(k,f,j,c,b,g,p){if(!Boolean(j)||!Boolean(c)){typeof f=="function"&&f("Invalid sharing arguments.");return}var n=new URI(c),d=Boolean(n.getScheme())?c:e(c),m="_api/SP.Web.CreateAnonymousLinkWithExpiration",l=b==null?"_api/SP.Web.DeleteAllAnonymousLinksForObject":"_api/SP.Web.DeleteAnonymousLinkForObject",o=g?m:l,i="",a;if(g)a={url:d,isEditLink:b,expirationString:p};else if(b==null)a={url:d};else a={url:d,isEditLink:b};if(!g)a.removeAssociatedSharingLinkGroup=true;i=JSON.stringify(a);h(k,f,j,o,i)}function K(c,a,i,d,g,f){if(!Boolean(i)||!Boolean(d)){typeof a=="function"&&a("Invalid sharing arguments.");return}var b=function(k,l){var j=new URI(d),c=Boolean(j.getScheme())?d:e(d),m=f?"_api/SP.Web.CreateOrganizationSharingLink":"_api/SP.Web.DestroyOrganizationSharingLink",b="",a={url:c,isEditLink:g};if(!f)a.removeAssociatedSharingLinkGroup=true;b=JSON.stringify(a);h(k,l,i,m,b)};if(typeof SP!="undefined"&&typeof SP.QoS!="undefined")if(g)if(f)SP.QoS.ExecuteMonitoredAsync("SharingCreateEditLink","SharingCreateEditLinkStart","SharingCreateEditLinkSuccess","SharingCreateEditLinkFailure","SharingCreateEditLinkNoResult",b,c,a);else SP.QoS.ExecuteMonitoredAsync("SharingDisableEditLink","SharingDisableEditLinkStart","SharingDisableEditLinkSuccess","SharingDisableEditLinkFailure","SharingDisableEditLinkNoResult",b,c,a);else if(f)SP.QoS.ExecuteMonitoredAsync("SharingCreateViewLink","SharingCreateViewLinkStart","SharingCreateViewLinkSuccess","SharingCreateViewLinkFailure","SharingCreateViewLinkNoResult",b,c,a);else SP.QoS.ExecuteMonitoredAsync("SharingDisableViewLink","SharingDisableViewLinkStart","SharingDisableViewLinkSuccess","SharingDisableViewLinkFailure","SharingDisableViewLinkNoResult",b,c,a);else b(c,a)}function h(g,b,c,d,f){if(!Boolean(c)||!Boolean(d)){typeof b=="function"&&b("Invalid sharing arguments.");return}if(!Boolean(f))f=null;var i=new URI(c),a=Boolean(i.getScheme())?c:e(c),h=function(e){if(a.substring(a.length-1)=="/")a=a.substring(0,a.length-1);var h=a+(d.charAt(0)!="/"?"/":"")+d,c=new XMLHttpRequest;c.open("POST",h,true);c.setRequestHeader("Content-type","application/json;odata=verbose");c.setRequestHeader("x-requestdigest",e);c.setRequestHeader("x-requested-with","XMLHttpRequest");c.setRequestHeader("accept","application/json; odata=verbose");c.onreadystatechange=function(){if(IsXhrReady(c)){var a=null,d=null;try{a=JSON.parse(c.responseText)}catch(e){d=e}if(Boolean(a))if(Boolean(a.d)&&Boolean(a.d.ErrorMessage))d=a.d.ErrorMessage;else if(Boolean(a.error)){d="";if(Boolean(a.error.message))d=a.error.message.value}if(typeof d!="undefined"&&d!=null||!Boolean(a)||!Boolean(a.d))typeof b=="function"&&b(c,d);else typeof g=="function"&&g(c,a.d)}};c.send(f)};EnsureScript("core.js","GetRequestDigest",function(){var b=GetRequestDigest(a,h);Boolean(b)&&h(b)})}function z(b,d,f,g,h){var a=b;if(!b.endsWith("/"))b+="/";if(b.charAt(0)=="/")b=e(b);if(!(a.length>"_layouts/15/aclinv.aspx".length&&a.indexOf("_layouts/15/aclinv.aspx")>0)){var c=[b,"_layouts/15/aclinv.aspx","?forSharing=1&mbypass=1"];if(m$.isDefinedAndNotNull(d)&&d.length>0){c.push("&List=",escapeProperly(d));m$.isDefinedAndNotNull(f)&&f.length>0&&c.push("&obj=",d,",",f,",DOCUMENT")}Boolean(g)&&c.push("&tts=",g);Boolean(h)&&c.push("&ThemeOverride=","none");a=c.join("")}else if(a.charAt(0)=="/")a=e(a);return a}m$.isDefinedAndNotNull(Sys)&&m$.isDefinedAndNotNull(Sys.Application)&&Sys.Application.notifyScriptLoaded();m$.isFunction(NotifyScriptLoadedAndExecuteWaitingJobs)&&NotifyScriptLoadedAndExecuteWaitingJobs("sharing.js");function w(d,c){var a=m$,b=document;if(IsInIframe()&&Boolean(window.parent.m$)){a=window.parent.m$;b=window.parent.document}Boolean(a)&&Boolean(d)&&Boolean(c)&&a(b).trigger("SharingEvents.SharingModified",d,c)}function J(a){if(!Boolean(sharingInfo))sharingInfo={};sharingInfo.IsSharedWithMany=a.IsSharedWithMany;sharingInfo.IsSharedWithSecurityGroup=a.IsSharedWithSecurityGroup;sharingInfo.IsSharedWithGuest=a.IsSharedWithGuest;sharingInfo.IsFolder=a.IsFolder;sharingInfo.TotalFileCount=a.TotalFileCount;sharingInfo.SharedUsers=[];for(var e=a.SharedWithUsersCollection.results,d=0,f=e.length;d<f;d++){var c=e[d],b={};b.id=c.Id;b.title=c.Name;b.email=c.Email;sharingInfo.SharedUsers.push(b)}}})();typeof spWriteProfilerMark=="function"&&spWriteProfilerMark("perfMarkEnd_sharing.js")}var HtmlStrings;function HtmlEncodeAllowSimpleTextLength(c){if(null==c||0==c.length)return 0;var e=false,f=0,d=0,g=c.length;while(d<g){var a=null,b=c[d];if(b==" ")if(d+1<g&&c[d+1]==" "||e)a=HtmlStrings.Nbsp;else a=" ";else if(b=="\n"){a=HtmlStrings.Br;e=true}else{if(b=='"')a=HtmlStrings.Quot;else if(b=="&")a=HtmlStrings.Amp;else if(b=="'")a=HtmlStrings.Apostrophe;else if(b=="<")a=HtmlStrings.Lt;else if(b==">")a=HtmlStrings.Gt;else if(b=="\r")a=HtmlStrings.Space;e=false}if(a!=null)f+=a.length;else f+=1;d++}return f}var GetSharingStatusHtml,ApplySharingListStyles,DisplayClientSharingDialog,DisplaySharingDialog,DisplayUnthemedSharingDialog,RenderSharingDialogByUrl,NavigateToRootLibraryWithoutQueryString,DisplaySharedWithDialog,DisplaySharedWithDialogCore,SetSelectedPermission,CheckPermissionsFor,FormatUserEntriesForSharing,GetWebSharingInformation,GetListSharingInformation,GetListItemSharingInformation,GetObjectSharingInformation,GetObjectSharingInformationByUrl,UpdateDocumentSharingInfo,CreateAnonymousLink,DestroyAnonymousLink,CreateOrganizationSharingLink,DestroyOrganizationSharingLink,GetSharingSettings,ShareObject,UnshareObject,ForwardObjectLink,ConfigEmailLinkHelper,GetReversedSharedWithUsers,GetBestCsomSharingLink,GetSharingLabelFromType,ManageLinkParams,GetManageLinkParams,DisplayManageLinkDialog,OnDisableLink,OnCreateLink,SetExpirationDropdownItem,OnDropdownClick,GenerateExpiryTextHTML,GetExpirationFromLink,OnSharingLinksMenuChanged,OnCopyLink,DismissTopDlg,DismissTopDlgAndLog,HandleOnCloseClick,SelectOnFocus,RenderDLPLite,RenderLockdownModeDialog,RenderLockdownModeInContainer,simpleSiteSharingFeature,oversharingMitigation,enforceRequiredAnonymousLinksExpiration,ModernSharingDialogUrl,SharingTabToShow,SharingDialogReturnCode,SharingRole,SharingLinkKind,SharingLinkExpirationValues,L_WebUrl,L_ContextWebUrl,L_ListID,L_ItemID,L_ItemName,L_ItemUrl,L_AnonymousViewLink,L_AnonymousEditLink,L_SharingLinks,L_SharingLinkProperties,L_SelectedSharingLinkKind,L_CanManageReadWriteLink,L_CanManageReadonlyLink,L_UserDispUrl,L_RequiredAnonymousLinkExpirationInDays;$_global_sharing();