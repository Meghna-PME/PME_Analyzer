function RenderSuiteLinksFromShellData(e,a,o,l,q){var B=window.OffSwitch&&window.OffSwitch.IsActive("fdbaaf48-4f49-439b-b4ea-c3fa86f8c2bb","04/15/2019","Disable SuiteNav Render For Magellan");if(!B&&(navigator.userAgent.indexOf("SharePointDesktop")>-1||navigator.userAgent.indexOf("Magellan")>-1)){document.getElementById(e).style.height="0px";return}var M="ShellDocuments",W="ShellSites",X="ShellSharepoint",k=4e3,h=false,i=false,Y="javascript:",n="SPSuiteThemeInfo",H=54,E=21,G=16,O=64;if(typeof a!="number"||a<1)if(window.OffSwitch&&!window.OffSwitch.IsActive("340D2476-F901-4464-B65F-B5E86320DAF0","08/17/2020","Suite nav defaults to v2"))a=2;else a=1;function m(a){if(typeof BrowserStorage!="undefined")return BrowserStorage.local.getItem(a);try{return localStorage[a]}catch(b){return null}}function u(b,a){if(typeof BrowserStorage!="undefined"){BrowserStorage.local.setItem(b,a);return}try{localStorage[b]=a}catch(c){}}function F(a){BrowserStorage.local.removeItem(a)}function p(a){window.console!=null&&console.warn!=null&&console.warn(a)}function V(a){SP.QoS.WriteStart(a,null,SP.QoS.LogType.Diagnostic)}function A(a){SP.QoS.WriteSuccess(a,null,SP.QoS.LogType.Diagnostic)}function b(b){var a=typeof Flighting!=="undefined"&&Flighting.VariantConfiguration!=null&&Flighting.VariantConfiguration.IsExpFeatureClientEnabled!=null&&Flighting.VariantConfiguration.IsExpFeatureClientEnabled(b);return a}function z(){return SuiteNavRendering.GetWebTemplate()}function r(d,c){for(var b=0;b<d.length;b++){var a=d[b];if(Boolean(a))if(c!=null&&a.Id==M)a.Url=c}}function L(){try{var a=JSON.parse(m("SPMySiteLinks")),b=Date.parse(a.CacheDate);if(b>0&&(new Date).getTime()-b<24*60*60*1e3&&GetCurrentUserKey()==a.UserKey)return a}catch(c){}return null}function Q(d,b){var a=null,c=null;function f(b,c,d){var a={};a.AllDocumentsLink=c;a.AllSitesLink=d;b(JSON.stringify(a))}function h(b){var c=_spPageContextInfo.webServerRelativeUrl=="/"?"":_spPageContextInfo.webServerRelativeUrl,d=escapeUrlForCallback(c)+"/_api/Microsoft.SharePoint.Portal.UserProfiles.MySiteLinks.GetMySiteLinks",a=new XMLHttpRequest;a.open("GET",d,true);a.setRequestHeader("Content-Type","application/x-www-form-urlencoded");a.setRequestHeader("ACCEPT","application/json; odata=verbose");a.onreadystatechange=function(){if(a.readyState==4){if(a.status==200){var c=null;try{c=JSON.parse(a.responseText)}catch(g){if(typeof Sys!=="undefined"&&typeof Sys.Debug!=="undefined");}if(Boolean(c)&&Boolean(c.d)&&(Boolean(c.d.AllDocumentsLink)||Boolean(c.d.AllSitesLink))){var e=Boolean(c.d.AllDocumentsLinkHref)?c.d.AllDocumentsLinkHref:c.d.AllDocumentsLink,d=Boolean(c.d.AllSitesLinkHref)?c.d.AllSitesLinkHref:c.d.AllSitesLink;f(b,e,d);return}}f(b,null,null)}};a.send()}function i(g){if(!Boolean(g)){if(typeof Sys!=="undefined"&&typeof Sys.Debug!=="undefined");b(d);return}var e=JSON.parse(g);if(e!=null){var f=e.AllDocumentsLink,h=e.AllSitesLink;try{u("SPMySiteLinks",JSON.stringify({Docs:f,Sites:h,CacheDate:new Date,UserKey:GetCurrentUserKey()}))}catch(j){}r(c,f,h)}var i=JSON.stringify(a);b(i)}try{a=JSON.parse(d)}catch(j){if(typeof Sys!=="undefined"&&typeof Sys.Debug!=="undefined");}if(a!=null){var g=ExtractSuiteNavBarData(a);c=g!=null?g.WorkloadLinks:a.WorkloadLinks}var e=L();if(c==null)b(d);else if(e!=null){r(c,e.Docs,e.Sites);b(JSON.stringify(a))}else h(i)}function g(d){if(window.XMLHttpRequest==null)return;function e(){if(k<30*60*1e3){var a=setTimeout(function(){g(d)},k);AddEvtHandler(window,"onunload",function(){clearTimeout(a)});k=k*2}}if(i)return;i=true;var f=_spPageContextInfo.webServerRelativeUrl=="/"?"":_spPageContextInfo.webServerRelativeUrl,b=new XMLHttpRequest;b.onreadystatechange=function(){if(b.readyState!=4)return;i=false;if(h)return;if(b.status==200){h=true;var c=false;if(a>=2&&!Boolean(l)){var f=b.getResponseHeader("Content-Type");if(f==null&&f.indexOf("application/json")<0){p("SuiteNav: Invalid Shell data recieved.");c=true}}!c&&Q(b.responseText,d)}else e()};b.ontimeout=e;var c="/_layouts/online/handlers/SpoSuiteLinks.ashx";c=escapeUrlForCallback(f)+(typeof ajaxNavigate!=="undefined"?ajaxNavigate._fixLayoutsUrl(c):typeof FixLayoutsUrl!=="undefined"?FixLayoutsUrl(c):c);b.open("POST",c+"?Locale="+escapeUrlForCallback(_spPageContextInfo.currentUICultureName)+"&v="+String(a)+"&mobilereq="+String(l===true?1:0),true);b.send("");return null}function v(a){SuiteNavRendering.UpdateActiveLink(a)}function w(a){if(typeof a!="string"||a=="")return false;return true}function J(a){SuiteNavRendering.AddMenuItemsFromDOM(a)}function U(a){SuiteNavRendering.UpdateHelpLink(a)}function N(a){var c=window.OffSwitch&&window.OffSwitch.IsActive("82F8C6A5-2C13-4635-BC09-7E84C16105E4","03/05/2017","Disable Feedback When it is not supported.");if(b(952)&&(c||typeof window._TenantAdminUserVoice!==typeof undefined)){a.FeedbackLink.TargetWindow="_self";a.FeedbackLink.Url="javascript:_TenantAdminUserVoice.openWidget()"}else a.FeedbackLink=null}function I(){var a=O365Shell.Host.OnContextMenuPopup(function(a){a&&MenuHtc_hide()});O365Shell.OnDataChanged&&O365Shell.OnDataChanged(R);AddEvtHandler(window,"onunload",function(){O365Shell.Host.RemoveOnContextMenuPopup(a);O365Shell.Host.FlushTaskRunnerQueue()})}function y(){try{var a=m("SPSuiteNavHeight");if(a!=null)document.getElementById(e).style.height=a}catch(b){}}function T(){var b=m(n);if(b!=null){if(SPThemeUtils.UseClientSideTheming()){F(n);return []}for(var c=JSON.parse(b),a=0;a<document.styleSheets.length;a++){var d=document.styleSheets[a];if(c.Url==d.href)return c.Colors}}return []}function S(){var a=z(),b=a==H||a==E||a==O;return b}function P(s){var f=ExtractSuiteNavBarData(s),K=S();if(f==null)return;if(!K)f.UseSPOBehaviors=true;if(RenderSuiteLinksFromShellData.ShouldUseSuiteTheme(s)||K&&Boolean(f.HasTenantBranding)||z()==G)return;if(b(516)){if(Boolean(f.HasTenantBranding)&&(s.TenantPrimaryColorShades!=null||f.TenantLogoUrl!=null))return}else if(Boolean(f.HasTenantBranding)&&typeof SPThemeUtils!=="undefined"&&!SPThemeUtils.IsSiteThemed())return;var a=T();if(a==null||a.length==0)a=[];else{f.ThemeColors=a;return}function N(b,c){if(b>=0)a[b]=c}function h(e,c){var a=c.backgroundColor,d=Boolean(a);if(d){if(a.toLowerCase()=="transparent"&&c.filter!=null){var b=/startColorstr=(#[0-9A-F]*),/ig.exec(c.filter);if(b!=null&&b.length>1)a="#"+b[1].substr(3)}N(e,a)}return d}function i(c,b){var a=Boolean(b.color);a&&N(c,b.color);return a}var q={},r=0;function e(b,c){for(var a=0;a<b.length;a++)q[b[a]]=c;r++}var R=browseris.ie8down,g=R?".ms-core-neediefilter ":"",M=f.Dimensions==null||f.Dimensions.Top<40,W=[2,-1,4,9,5,6,7,1,8,10,3,-1];function d(a){return M?a:W[a]}var j=d(0),C=d(1),x=d(2),y=d(3),p=d(4),H=d(5),A=d(6),I=d(7),J=d(8),E=d(9),F=d(10),B=d(11);function L(){if(!M&&a[j]!=null)a[0]=a[j];f.ThemeColors=a}if(SPThemeUtils.UseClientSideTheming()){var c=SPThemeUtils.GetThemeColor,O=1,l=R?O:void 0,Y=a[j]=c("SuiteBarBackground",l);if(Y==null)return;a[C]=c("SuiteBarHoverBackground",l);var D=c("SuiteBarHoverText"),V="#92c0e0";a[x]=D==null?V:D;a[y]=c("HoverBackground",l);a[p]=c("TopBarBackground",l);a[H]=c("TopBarText");a[A]=c("TopBarHoverText");a[I]=c("BodyText");a[J]=c("BackgroundOverlay",O);a[E]=c("DialogBorder");a[F]=c("SuiteBarText");a[B]=c("SubtleLines");L();return}e(["#suitebarleft"],function(a){g===""&&h(j,a);return i(F,a)});g!==""&&e([g+"#suitebarleft"],function(a){return h(j,a)});e([g+".ms-core-suitelink-a:hover"],function(a){return h(C,a)});e(["a.ms-core-suitelink-disabled, a.ms-core-suitelink-disabled:hover","a.ms-core-suitelink-disabled"],function(a){return !Boolean(a.padding)&&i(x,a)});e([g+".ms-core-menu-item:hover, "+g+".ms-core-menu-itemselected",g+".ms-core-menu-item:hover"],function(a){return h(y,a)});g!==""&&e([g+"#suitebarright"],function(a){return h(p,a)});e(["#suitebarright"],function(a){g===""&&h(p,a);return i(H,a)});e(["a.ms-core-menu-link"],function(a){return i(I,a)});e(["a.ms-core-suitelink-active, a.ms-core-suitelink-active:hover, .ms-core-neediefilter a.ms-core-suitelink-active, .ms-core-neediefilter a.ms-core-suitelink-active:hover","a.ms-core-suitelink-active"],function(b){var c=b.borderRightColor;a[E]=c!=null&&c!=""?c:b.borderLeftColor;i(A,b);return h(J,b)});e([".ms-core-menu-separatorhr"],function(a){return i(B,a)});for(var k=0,P="",t=0;t<document.styleSheets.length&&k<r;t++){k=0;var m=document.styleSheets[t];P=m.href;var v=m.rules!=null?m.rules:m.cssRules;if(!Boolean(v))continue;for(var w=v.length-1;w>0&&k<r;w--){var o=v[w];if(o.style!=null&&o.selectorText!=null){var U=o.selectorText.toLowerCase(),Q=q[U];if(Q!=null&&Q(o.style)){q[U]=null;k++}}}}if(k>0){L();var X={Url:P,Colors:a};u(n,JSON.stringify(X))}}function C(a){var b="display";while(a!=null){if(IE8Support.getComputedStyle(a,b,b)==="none")return true;if(a.nodeName.toLowerCase()==="body")break;a=a.parentNode}return false}function s(b){var a=null;try{if(b!=null)a=ExtractSuiteMetadata(b)}catch(c){}return a}var d=false,f=false,c=false,j=null;function x(b){if(c&&h)j=function(){x(b)};if(e==null||f||c)return;var a=s(b);if(Boolean(RenderSuiteLinksFromShellData.ShellJson)&&Boolean(RenderSuiteLinksFromShellData.ShellJsUrl)&&RenderSuiteLinksFromShellData.ShellJsUrl!==a.JsUrl)a=s(RenderSuiteLinksFromShellData.ShellJson);if(a==null||!w(a.CssUrl)||!w(a.JsUrl))p("SuiteNav: Valid JsUrl and CssUrl not found.");else D(a)}function D(s){if(f||c)return;try{var gb=JSON.stringify(s),n=ExtractSuiteNavBarData(s);if(n==null)return;v(n);var hb=s.CssUrl,S=s.JsUrl;registerCssLink(hb,null,true);var db=10,cb=50,R=0,m;function O(){c=false;if(f||typeof O365Shell!="undefined")return;if(typeof O365Shell=="undefined"&&R<db){R++;c=true;setTimeout(G,cb);return}if(!d&&!h){d=true;if(!i){ClearSuiteLinksCache();t()}}else if(!d&&j!=null){d=true;j();j=null}else{d=true;p("SuiteNav: Unable to load Shell scripts.")}}function Q(){try{y();J(n);U(n);N(n);P(s)}catch(a){}}function G(){c=false;if(f)return;if(typeof O365Shell=="undefined"){O();return}else d=false;RenderSuiteLinksFromShellData.ShellJson=gb;if(!Boolean(RenderSuiteLinksFromShellData.ShellJsUrl))RenderSuiteLinksFromShellData.ShellJsUrl=S;function a(){Q();var c=document.getElementById(e);c!=null&&typeof RemoveCssClassFromElement!="undefined"&&RemoveCssClassFromElement(c,"ms-TopBarBackground-bgColor");O365Shell.SetData(n);var a={top:e,disableDelayLoad:true,disableShellPlus:true,layout:"Mouse"};if(q){a.shellAuthProviderConfig=q;var f=window.OffSwitch&&window.OffSwitch.IsActive("8FE233B6-3394-4918-A449-B5808E8B40BD","9/8/20","Dead tab detection");a.shellDataOverrides=!f?{AccountSwitchingEnabled:true,DisableMASTPopup:true}:{AccountSwitchingEnabled:true};if(n&&n.SignOutLink)q.appSignOutUrl=n.SignOutLink.Url}a.isThinHeader=true;if(g_SpoSuiteNavSettings&&g_SpoSuiteNavSettings.enableSearchUX){a.enableSearchUX=true;a.initialSearchUXPlaceholderText=Y();a.GetTokenRequestDictionary=bb;m=V();a.searchBoxInstrumenter=m;a.enableLegacyResponsiveBehavior=false}var g=b(639);if(g)a.enableLegacyResponsiveBehavior=false;if(!C(c)){var d=window.OffSwitch&&window.OffSwitch.IsActive("5BE31C31-56EB-4EDD-801A-EC36F75169DF","11/28/2018","Render Suite Nav with RenderAsync if defined");if(d||O365Shell.RenderAsync!=null){O365Shell.RenderAsync(a,Z,L);F()}else{O365Shell.Render(a,L);F();setTimeout(function(){O365Shell.LoadShellPlus!=null&&O365Shell.LoadShellPlus()},2e3)}}else A("SuiteNav_SuccessRender")}SPThemeUtils.WhenThemeReady(a);f=true}function Z(){setTimeout(function(){O365Shell.LoadShellPlus!=null&&O365Shell.LoadShellPlus()},2e3)}function L(){I();SP.SOD.notifyEventAndExecuteWaitingJobs("SPShellPlusLoaded",[n])}function F(){A("SuiteNav_SuccessRender");SP.SOD.notifyEventAndExecuteWaitingJobs("SPSuiteLinksRendered",[n]);RenderSuiteLinksFromShellData.ShouldUseSuiteTheme(s)&&SPThemeUtils.GetCurrentThemeCacheToken()!=s.ShellRequestId&&setTimeout(SPThemeUtils.ApplyCurrentTheme,0);g_SpoSuiteNavSettings&&g_SpoSuiteNavSettings.enableSearchUX&&ab();SuiteNavRendering.ConfigureMast()}function Y(){if(_spPageContextInfo.searchBoxPlaceholderText)return _spPageContextInfo.searchBoxPlaceholderText;else if(x&&g_SpoSuiteNavSettings.searchStringsEncoded)return w(k)?g_SpoSuiteNavSettings.searchStringsEncoded.tenantPlaceholder:g_SpoSuiteNavSettings.searchStringsEncoded.searchPlaceholder;else if(g_SpoSuiteNavSettings.searchStringsEncoded)if(!r){if(H(k))return g_SpoSuiteNavSettings.searchStringsEncoded.sitePlaceholder;else if(u(k))return g_SpoSuiteNavSettings.searchStringsEncoded.hubPlaceholder;else if(w(k))return g_SpoSuiteNavSettings.searchStringsEncoded.tenantPlaceholder}else switch(k){case a.SITE:return g_SpoSuiteNavSettings.searchStringsEncoded.sitePlaceholder;case a.HUB:return g_SpoSuiteNavSettings.searchStringsEncoded.hubPlaceholder;case a.TENANT:return g_SpoSuiteNavSettings.searchStringsEncoded.tenantPlaceholder}}function bb(){return {Substrate:c,Loki:e,SharePointSites:b};function c(){return new Promise(function(b){a("https://outlook.office365.com/search",function(a){b(a)})})}function e(){return new Promise(function(b){a("https://loki.delve.office.com",function(a){b(a)})})}function b(){return new Promise(function(a){d(function(b){a(b)})})}function a(c,b){var a=$get("__REQUESTDIGEST").value,d=[["Content-type","application/json;odata=verbose"],["x-requestdigest",a]],e={resource:c};z("POST",_spPageContextInfo.webServerRelativeUrl+"/_api/SP.OAuth.Token/Acquire()",d,JSON.stringify(e),function(d){var e=new DOMParser,a=e.parseFromString(d,"text/xml"),c="";if(a&&a.documentElement&&a.documentElement.getElementsByTagNameNS("*","access_token").length&&a.documentElement.getElementsByTagNameNS("*","access_token")[0].childNodes.length){c=a.documentElement.getElementsByTagNameNS("*","access_token")[0].childNodes[0].nodeValue;b(c)}})}function d(a){var b=[["Accept","application/json"],["SPHome-ClientType","Web"]];z("GET",_spPageContextInfo.webServerRelativeUrl+"/_api/sphomeservice/context?$expand=Token,Payload",b,null,function(c){var b=JSON.parse(c);if(O365Shell.Search&&b.Token){O365Shell.Search.SetSharePointHomeApiRequestInfo({url:b.Token.resource+"/api/v1",context:JSON.parse(b.Payload)});a(b.Token.access_token)}})}}var a={DEFAULT:0,TENANT:1,HUB:2,SITE:3},g={Org:"org",SiteScopeForSite:"spSiteSite",HubScopeForSite:"spSiteHub",SiteScopeForHub:"spHubSite",HubScopeForHub:"spHubHub"},x=b(1534),D=_spPageContextInfo.isHubSite,k=E(),r=window.OffSwitch&&window.OffSwitch.IsActive("3E0FA191-F3B5-46E9-8AF5-BAFA5E8F063D","12/4/2020","site search in hub site"),W=window.OffSwitch&&window.OffSwitch.IsActive("293a8b48-241b-4262-b25e-f33cfd374e12","05/28/2021","appendScopeQueryParamSearchWithSiteScope");function E(){if(!r){if(M())return g.Org;switch(_spPageContextInfo.searchScope){case a.TENANT:return g.Org;case a.SITE:return D?g.SiteScopeForHub:g.SiteScopeForSite;case a.HUB:return D?g.HubScopeForHub:g.HubScopeForSite;default:return D?g.HubScopeForHub:g.SiteScopeForSite}}else{if(M())return a.TENANT;if(_spPageContextInfo.searchScope===a.DEFAULT&&D)return a.HUB;else if(_spPageContextInfo.searchScope===a.DEFAULT)return a.SITE;else if(_spPageContextInfo.searchScope===a.HUB&&!_spPageContextInfo.hubSiteId)return a.SITE;else return _spPageContextInfo.searchScope}}var B,l=!r?{siteScopeForSite:{id:g.SiteScopeForSite,name:g_SpoSuiteNavSettings.searchStringsEncoded?g_SpoSuiteNavSettings.searchStringsEncoded.siteScope:"",external:false},hubScopeForSite:{id:g.HubScopeForSite,name:g_SpoSuiteNavSettings.searchStringsEncoded?g_SpoSuiteNavSettings.searchStringsEncoded.hubScope:"",external:false},orgScope:{id:g.Org,name:g_SpoSuiteNavSettings.searchStringsEncoded?g_SpoSuiteNavSettings.searchStringsEncoded.tenantScope:"",external:false},siteScopeForHub:{id:g.SiteScopeForHub,name:g_SpoSuiteNavSettings.searchStringsEncoded?g_SpoSuiteNavSettings.searchStringsEncoded.currentHubScope:"",external:false},hubScopeForHub:{id:g.HubScopeForHub,name:g_SpoSuiteNavSettings.searchStringsEncoded?g_SpoSuiteNavSettings.searchStringsEncoded.hubAndSitesScope:"",external:false}}:{siteScope:{id:a.SITE,name:g_SpoSuiteNavSettings.searchStringsEncoded?g_SpoSuiteNavSettings.searchStringsEncoded.siteScope:"",external:false},hubScope:{id:a.HUB,name:g_SpoSuiteNavSettings.searchStringsEncoded?g_SpoSuiteNavSettings.searchStringsEncoded.hubScope:"",external:false},orgScope:{id:a.TENANT,name:g_SpoSuiteNavSettings.searchStringsEncoded?g_SpoSuiteNavSettings.searchStringsEncoded.tenantScope:"",external:false}};function w(b){return !r?b===g.Org:b===a.TENANT}function u(b){return !r?b===g.HubScopeForHub||b===g.HubScopeForSite:b===a.HUB}function H(b){return !r?b===g.SiteScopeForHub||b===g.SiteScopeForSite:b===a.SITE}function X(){if(!r)switch(E()){case g.SiteScopeForSite:case g.HubScopeForSite:return _spPageContextInfo.hubSiteId?[l.siteScopeForSite,l.hubScopeForSite,l.orgScope]:[l.siteScopeForSite,l.orgScope];case g.HubScopeForHub:case g.SiteScopeForHub:return [l.siteScopeForHub,l.hubScopeForHub,l.orgScope];case g.Org:return [l.orgScope];default:return []}else switch(E()){case a.SITE:return _spPageContextInfo.hubSiteId?[l.siteScope,l.hubScope,l.orgScope]:[l.siteScope,l.orgScope];case a.HUB:return [l.hubScope,l.orgScope];case a.TENANT:return [l.orgScope];default:return []}}function eb(){setTimeout(function(){O365Shell.Search.FocusSearchBox()},0)}var T=b(60652);function M(){if(T)return _spPageContextInfo.isCurrentSiteAHomeSite&&_spPageContextInfo.searchScope===a.DEFAULT;else{var b=_spPageContextInfo.companyPortalReference,c=o(_spPageContextInfo.siteId),d=o(_spPageContextInfo.webId);return b&&b.SiteId===c&&b.WebId===d&&_spPageContextInfo.searchScope===a.DEFAULT}}function o(a){if(!a)return null;var d=36,c=38,b=/^Guid\((.*)\)/i.exec(a);if(b)a=b[1];if(a.length===c)a=a.substr(1,d);return a.toLowerCase()}function V(){i();var d=h(),b=["markAppBoot","markHeaderBoot","markSbInteractive","markSbReady","markZeroQueryReady"],c="TeamSiteSearch",a={perf:o(),markAppBoot:function(){},markSbInteractive:function(){},markHeaderBoot:function(){},markZeroQueryReady:function(){},markSbReady:function(){},register:function(){},scenario:c,hostAppInfo:{id:c,version:_spPageContextInfo.siteClientTag,userRing:j(d),scopeId:w(k)?"global":undefined},hostAppId:c,hostAppVersion:_spPageContextInfo.siteClientTag,hostAppEnvironment:_spPageContextInfo.env,spSiteSubscriptionId:_spPageContextInfo.siteSubscriptionId,spEnvironment:d},f={},n=b.reduce(function(e,c,d){e[c]=function(){if(!f[c]){f[c]=true;a.perf.mark(c)}if(d)try{a.perf.measure(b[d-1]+"-"+c,b[d-1],c)}catch(e){}};return e},{});b.push(["markSearchLayoutMount","markSearchLayoutRenderStart"]);var m={markAppBoot:[],markHeaderBoot:["markAppBoot"],markSbInteractive:["markHeaderBoot"],markSbReady:["markSbInteractive"],markZeroQueryReady:["markSbReady"],SbQuerySubmitted:["markSbReady"],SerpRouteChange:[],SerpStartQuery:["SbQuerySubmitted"],SerpFetchStart:["SbQuerySubmitted","SerpStartQuery"],SerpAnswerFetchDone:["SerpFetchStart"],SerpFetchDone:["SerpFetchStart"],SerpAnswersRenderDone:["markAppBoot","SbQuerySubmitted","SerpRouteChange","SerpFetchStart","SerpAnswerFetchDone"],SerpDataReady:["SerpFetchStart","SerpFetchDone"],SerpRenderDone:["markAppBoot","SbQuerySubmitted","markSearchLayoutMount","markSearchLayoutRenderStart","SerpPrefetchStart","SerpPrefetchDone","SerpConfigStart","SerpConfigDone","SerpRouteChange","SerpStartQuery","SerpFetchStart","SerpDataReady","SerpFetchDone","SerpFullPageLoad","SerpInPlaceNavigation","RouterHistoryChange"],ProcessVerticalsConfigStart:[],FetchVerticalsConfigStart:[],FetchVerticalsConfigDone:[],VerticalsRegisterDone:[],VerticalsRenderDone:["markAppBoot","SbQuerySubmitted","SerpRouteChange","RouterHistoryChange","SerpPrefetchStart","SerpPrefetchDone","SerpConfigStart","SerpConfigDone","ProcessVerticalsConfigStart","FetchVerticalsConfigStart","FetchVerticalsConfigDone","VerticalsRegisterDone"],markSearchLayoutMount:["SbQuerySubmitted"],markSearchLayoutRenderStart:["SbQuerySubmitted","markSearchLayoutMount"],SerpPrefetchStart:[],SerpPrefetchDone:["SerpPrefetchStart"],SerpConfigStart:[],SerpConfigDone:["SerpConfigStart"],SerpFullPageLoad:[],SerpInPlaceNavigation:[],RouterHistoryChange:[],SetRefinersFromDeepLinkQueryStart:[],SetRefinersFromDeepLinkQueryDone:[],CreateCustomAggregationsStart:[],CreateCustomAggregationsDone:[],UpdateAvailableRefinersStart:[],UpdateAvailableRefinersDone:[],UpdateRefinersStart:[],ClearRefinersStart:[],SerpOldRefinerButtonClick:[],SerpRefinersCheck:["UpdateAvailableRefinersStart"],SerpRefinersRenderDone:["SerpConfigStart","SerpConfigDone","SerpFetchStart","SerpRouteChange","SerpDataReady","SerpFetchDone","UpdateRefinersStart","ClearRefinersStart","SetRefinersFromDeepLinkQueryStart","SetRefinersFromDeepLinkQueryDone","CreateCustomAggregationsStart","CreateCustomAggregationsDone","UpdateAvailableRefinersStart","UpdateAvailableRefinersDone","SerpOldRefinerButtonClick"],ContactDataFetchStart:[],ContactDataFetchEnd:["ContactDataFetchStart"],OrganizationChartDataFetchStart:[],OrganizationChartDataFetchEnd:["OrganizationChartDataFetchStart"],LPCContactPanelDataFetchStart:[],LPCContactPanelDataFetchEnd:["LPCContactPanelDataFetchStart"],LPCOrganizationPanelDataFetchStart:[],LPCOrganizationPanelDataFetchEnd:["LPCOrganizationPanelDataFetchStart"]};return Object.assign({},l(),n,{conversationManager:g(),props:a,setProps:function(b){this.props=a=Object.assign({},this.props,b);this.dispatch(b);return a},mark:function(b){var h=[];a.perf.mark(b);for(var e=m[b]||[],d=0;d<e.length;d++){var g=e[d];try{var f=g+"-"+b;a.perf.measure(f,g,b);var c=a.perf.getEntriesByName(f).pop();if(c)c.startTime>(startTimeTracker[b]||0)&&h.push(c)}catch(i){}}}});function o(){var c=(new Date).valueOf(),b={},g=[],a=function(a){return window.performance&&window.performance[a]},f=function(b,c,d){try{window.performance.measure(b,c,d)}catch(e){return null}var a=window.performance.getEntriesByName(b,"measure");if(a.length>0)return a[a.length-1];return null},d=function(f,e,d){var a=b[e],c=d?b[d]:now();if(a&&c)return {duration:c-a,entryType:"measure",name:f,startTime:a,toJSON:function(){return null}}},e=function(a){g.push({entryType:"mark",name:a,startTime:c,duration:0,toJSON:function(){return null}});b[a]=now()};return {now:a("now")?performance.now.bind(window.performance):function(){return (new Date).valueOf()-c},measure:a("measure")?f:d,mark:a("mark")?window.performance.mark.bind(window.performance):e,getEntriesByType:a("getEntriesByType")?window.performance.getEntriesByType:function(){return []},getEntriesByName:a("getEntriesByName")?window.performance.getEntriesByName:function(){return []}}}function e(){var a="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx";return a.replace(/[xy]/g,function(c){var a;if(window.crypto){var b=new Uint8Array(1);window.crypto.getRandomValues(b);a=b[0]}else a=Math.floor(Math.random()*16);var d=c==="x"?a%16:a%4+8;return d.toString(16)})}function g(){var a,b,d=function(){var b={},a=undefined,d=false,c=function(d){var c;if(d==="serp"&&a){c=a;a=undefined}else c=e();b[d]=c;if(d==="early-serp"){a=c;b["serp"]=c}return c};return {conversationId:e(),creationTime:Date.now(),getSubmittedState:function(){return d},submit:function(){d=true},createLogicalSearchId:c,getLogicalSearchId:function(a){return b[a]||c(a)}}},c=function(){if(a&&a.getSubmittedState())b=a;var c=d();a=c;return c};return {startConversation:c,getActiveConversation:function(){if(!a||a.getSubmittedState())return c();return a},getLastSubmittedConversation:function(){if(a&&a.getSubmittedState())return a;if(!b){var c=d();c.submit();b=c}return b}}}function l(){var a=[];return {register:function(b){return ""+(a.push(b)-1)},unregister:function(b){a[parseInt(b,10)]=0},dispatch:function(b){a.forEach(function(a){return a&&a(b)})}}}function h(){var b=_spPageContextInfo.env,a=_spPageContextInfo.webAbsoluteUrl;return b&&b==="prodbubble"&&a&&(a.toLowerCase().indexOf("microsoft.sharepoint-df.com")>-1||a.toLowerCase().indexOf("microsoft-my.sharepoint-df.com")>-1)?"spdf":b}function j(a){if(a==="spdf"||a==="edog")return "inner";else if(a==="prodbubble")return "outer";else return "generalAudience"}function i(){typeof Object.assign!=="function"&&Object.defineProperty(Object,"assign",{value:function(c){"use strict";if(c===null||c===undefined)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(c),d=1;d<arguments.length;d++){var a=arguments[d];if(a!==null&&a!==undefined)for(var b in a)if(Object.prototype.hasOwnProperty.call(a,b))e[b]=a[b]}return e},writable:true,configurable:true})}}function ab(){if(O365Shell.Search){I();b(1613)&&C();c(false);A()}function a(a){history.pushState({returnUrl:window.location.href,conversationId:s(),referringExperience:"classicPage"},undefined,a);window.location.href=a}function s(){if(m&&m.conversationManager&&m.conversationManager.getLastSubmittedConversation&&m.conversationManager.getLastSubmittedConversation())return m.conversationManager.getLastSubmittedConversation().conversationId;else return null}function I(){var b=_spPageContextInfo.webServerRelativeUrl;O365Shell.Search.OnSubmitSearch(function(c){if(!c)return;if(window.OffSwitch&&!window.OffSwitch.IsActive("C6B37DC2-CF5E-404D-9258-A7118F3C2F53","12/4/2020","uri encode search text"))c=encodeURIComponent(c);if(x)j(b,c,false);else e(b,c,function(b){a(b)},function(){j(b,c,true)})})}function C(){var a=O365Shell.Search.OnSearchBoxActivated(function(){c(true);O365Shell.Search.RemoveOnSearchBoxActivated(a)})}function j(a,b,c){if(w(k))n(a,b);else if(!r&&D)g(a,a,b,H(k));else if(!r&&u(k))t(a,b);else if(u(k)&&_spPageContextInfo.hubSiteId)F(a,b);else if(c)i(a,b);else d(a,b,"site")}function t(a,b){q(a,function(c){g(a,c,b,false)},function(){f(a,hubSiteUrl,b,false)})}function g(d,b,c,g){e(b,c,function(b){a(b)},function(){f(d,b,c,g)})}function f(b,c,d,f){if(!B){var g=c?c:b;a(g+"/_layouts/15/search.aspx/siteall?q="+d)}else{var e=f?"&scope=site":"&scope=hub";a(b+"/_layouts/15/search.aspx/siteall?q="+d+"&s="+B.id+"&sid="+B.siteId+e)}}function F(a,b){q(a,function(a){d(a,b)},function(){d(a,b)})}function d(c,b){e(c,b,function(b){a(b)},function(){i(c,b)})}function i(b,c){if(!b||b==="/")n(b,c);else if(!W&&x){var e=H(k),d=e?"&scope=site":"&scope=hub";a(b+"/_layouts/15/search.aspx/siteall?q="+c+d)}else a(b+"/_layouts/15/search.aspx/siteall?q="+c)}function n(b,d){var c="/_layouts/15/search.aspx?q="+d;a(b&&b!=="/"?b+c:c)}function q(a,e,c){var b="/_api/HubSites/GetById?hubSiteId='"+_spPageContextInfo.hubSiteId+"'",d=a&&a!=="/"?a+b:b;z("GET",d,[["Accept","application/json;odata=verbose"]],null,function(b){var a=b?JSON.parse(b):null;if(a&&a.d&&a.d.SiteUrl)e(a.d.SiteUrl);else c()},function(){c()})}function e(b,a,f,d){var c="/_api/search/resultspageaddress",e=b&&b!=="/"?b+c:c;z("GET",e,[["Accept","application/json;odata=verbose"]],null,function(e){var b=e?JSON.parse(e):null;if(b&&b.d&&b.d.resultspageaddress){var c;if(window.OffSwitch&&!window.OffSwitch.IsActive("1284BCA1-708B-4034-AE6C-C9610AEA86ED","06/08/2021","Add both q and k query params on custom search pages"))c=b.d.resultspageaddress.indexOf("?")===-1?"?q="+a+"&k="+a:"&q="+a+"&k="+a;else c=b.d.resultspageaddress.indexOf("?")===-1?"?q="+a:"&q="+a;f(b.d.resultspageaddress+c)}else d()},function(){d()})}function A(){if(x){var c=window.OffSwitch&&window.OffSwitch.IsActive("e9ddd618-0928-413c-becf-5c5c054753b2","01/04/2020","Show scoping control on small screens"),b=1024,a=c?window.innerWidth>=b:true;a&&p();c&&window.addEventListener("resize",function(){if(window.innerWidth<b&&a){G();a=false}else if(window.innerWidth>=b&&!a){p();a=true}})}}function p(){m.setProps({scopingControl:v()})}function G(){m.setProps({scopingControl:{}})}var h=window.OffSwitch&&window.OffSwitch.IsActive("cb0b4c57-db27-4bd3-8150-54d8c908a330","01/27/2021","Enable suggestions for whole org scope");function v(){return {scopes:X(),activeScopeId:E(),onChange:function(b,a){k=a.id;h&&y();c(true);eb()}}}function y(){var a=[];w(k)&&a.push({id:"tenantSuggestionUpdater",groupUpdaters:[{groupId:"file",createUpdater:l},{groupId:"news",createUpdater:l}]});O365Shell.Search.SetProviderConfigUpdaters(a)}function l(){return {providers:function(){return []}}}function c(l){var c=o(_spPageContextInfo.webId),a=o(_spPageContextInfo.siteId),e=_spPageContextInfo.hubSiteId?o(_spPageContextInfo.hubSiteId):null,n=e&&u(k)?i(e,a):g(c,a),p=_spPageContextInfo.webAbsoluteUrl+"/_api/search/query?QueryText='"+n+"'&QueryTemplate='{searchterms} (contentclass=STS_Site OR contentclass=STS_Web)'&SelectProperties='SiteId,WebId,Path,DepartmentId,Title,IsHubSite,RelatedHubSites'&EnableQueryRules=false&RowLimit=100&Properties='EnableDynamicGroups:true,EnableMultiGeoSearch:true'&ClientType='SpClient'";if(b(1613)&&!l)d(undefined,undefined,c,a);else z("GET",p,[["Accept","application/json;odata=verbose"]],null,function(e){var b=f(e);B=b.defaultSite;d(B,b.sites,c,a)});function g(b,a){return "((WebId:"+b+" AND SiteId:"+a+") OR (WebId:{"+b+"} AND SiteId:{"+a+"}))"}function d(f,c,e,d){var b={scenarioContext:{site:f,siteAssociation:c,warmupSubstrateSearchContextOptions:{queryStringParameters:{scenario:"TeamSiteSearch",userContextUrl:_spPageContextInfo.webAbsoluteUrl,webId:e,siteId:d},postAction:"init"}}};if(!h){var a=m.props&&m.props.hostAppInfo;if(a){a.scopeId=w(k)?"global":undefined;b.hostAppInfo=a}}m.setProps(b)}function i(b,a){if(b===""&&!a)return "";var c="";if(b)c="((DepartmentId:"+b+") OR (DepartmentId:{"+b+"}))";if(!a)return c;var e="",d="";if(a){e="XRANK(cb=1000)";d="((SiteID:"+a+") OR (SiteID:{"+a+"}))"}return c+e+d}function f(b){var h=[],g;b=JSON.parse(b);if(b&&b.d&&b.d.query&&b.d.query.PrimaryQueryResult&&b.d.query.PrimaryQueryResult.RelevantResults&&b.d.query.PrimaryQueryResult.RelevantResults.Table&&b.d.query.PrimaryQueryResult.RelevantResults.Table.Rows&&b.d.query.PrimaryQueryResult.RelevantResults.Table.Rows.results&&b.d.query.PrimaryQueryResult.RelevantResults.Table.Rows.results.length>0)for(var i=b.d.query.PrimaryQueryResult.RelevantResults.Table.Rows.results,f=0;f<i.length;f++){for(var e=i[f].Cells.results,a={},d=0;d<e.length;d++){var c=e[d].Value;switch(e[d].Key){case "SiteId":a.siteId=c;break;case "WebId":a.webId=c;break;case "DocId":a.id=c;break;case "Path":a.url=c;a.sitePath=c;break;case "Title":a.title=c;a.name=c;break;case "DepartmentId":a.departmentId=c;break;case "IsHubSite":a.isHubSite=!!c}}a.isDefaultSite=j(a);if(a.isDefaultSite)g=a;a.isHubSite=a.isDefaultSite&&u(k);h.push(a)}return {sites:h,defaultSite:g}}function j(a){var d=o(_spPageContextInfo.webId),c=o(_spPageContextInfo.siteId),b=o(_spPageContextInfo.hubSiteId);if(!r&&x&&u(k))return b===o(a.siteId);else return c===o(a.siteId)&&d===o(a.webId)}}}function z(h,i,e,g,f,d){var a=new XMLHttpRequest;a.onreadystatechange=function(){if(a.readyState===4&&a.status===200)f(a.response);else a.readyState===4&&d&&d()};a.open(h,i,true);for(var c=0;c<e.length;c++){var b=e[c];b&&Array.isArray(b)&&b.length>=2&&a.setRequestHeader(b[0],b[1])}a.send(g)}var fb=navigator.userAgent.indexOf("SharePointDesktop")>-1||navigator.userAgent.indexOf("Magellan")>-1||typeof GetUrlKeyValue=="function"&&Boolean(GetUrlKeyValue("unsuitened"));if(fb){Q();F()}else if(typeof O365Shell=="undefined"){if(typeof RenderSuiteLinksFromShellData.JsVer=="undefined")RenderSuiteLinksFromShellData.JsVer=0;var K="o365shell_js"+RenderSuiteLinksFromShellData.JsVer++;if(s.JsKey==null)SP.SOD.registerSod(K,S);else K=s.JsKey;c=true;SP.SOD.executeFunc(K,"O365Shell",G,O)}else G();SP.SOD.execute("core.js","UpdateCompanyDisplayName",n)}catch(ib){}}function K(){h=false;i=false}function R(){K();GetSuiteLinks(g,null,a,false,true)}function t(){GetSuiteLinks(g,Boolean(o)?o:x,a,l)}if(a<2)if(typeof EnsureScriptParams!=="undefined")EnsureScriptParams("suitelinks.js","RenderSuiteLinks",e,g,v);else typeof GetSuiteLinks!=="undefined"&&GetSuiteLinks(g,o);else{!l&&V("SuiteNav_StartRender");y();t()}}function RetrieveAndProcessSuiteNavData(a,b){RenderSuiteLinksFromShellData(null,b,a,true)}(function(){RenderSuiteLinksFromShellData.ShouldUseSuiteTheme=e;var d=54,c=21;function f(){return SuiteNavRendering.GetWebTemplate()}function e(b){return typeof SPThemeUtils!="undefined"&&SPThemeUtils!=null&&SPThemeUtils.UseShellThemes()&&!SPThemeUtils.IsSiteThemed()&&a(b)!=null}function b(h,b){if(b==null||b.length<7)return;for(var f=[["HyperlinkActive","CommandLinksPressed","NavigationPressed","EmphasisHoverBorder","TopBarPressedText","HeaderNavigationPressedText","Hyperlinkfollowed"],["EmphasisHoverBackground","EmphasisBorder"],["AccentText","CommandLinksHover","RowAccent","NavigationAccent","NavigationHover","EmphasisBackground","HeaderNavigationHoverText","HeaderNavigationSelectedText","SuiteBarBackground","Hyperlink","ContentAccent1"],["AccentLines","HeaderAccentLines","ButtonPressedBorder"],["SuiteBarHoverBackground"],["StrongLines","HeaderStrongLines","SuiteBarHoverText","ButtonPressedBackground","ButtonHoverBorder"],["ButtonHoverBackground"],["SelectionBackground"],["HoverBackground","NavigationHoverBackground"]],d,g,c,i=f.length,a=0;a<i;a++){if(a==7)c="#7F"+b[5];else if(a==8)c="#7F"+b[6];else c="#"+b[a];d=f[a];g=d.length;for(var e=0;e<g;e++)h.SetColor(d[e],c)}}function a(a){var b=null;if(a!=null&&Boolean(a.ThemeVersion)){var h=a.TenantPrimaryColorShades!=null,i=a.UserThemePrimaryColorShades!=null,g=Boolean(a.UserPersonalizationAllowed),e=f(),j=e==d||e==c;if(j&&(!h||g&&i))b=a.UserThemePrimaryColorShades;else b=a.TenantPrimaryColorShades;if(b==null||b.length<6)b=null}return b}function g(c){if(!SPThemeUtils.UseShellThemes()||SPThemeUtils.IsSiteThemed())SPThemeUtils.WithSiteTheme(c);else GetSuiteLinks(null,d,2);function d(f){var e=f!=null?ExtractSuiteMetadata(f):null,d=null;if(e!=null&&e.ShellRequestId!=null)d=a(e);function g(a){var f=null;if(d!=null&&a!=null){b(a,d);a.CacheToken=e.ShellRequestId;a.IsDefault=false;a.NoImageRecoloring=false}c(a)}d!=null&&SPThemeUtils.LoadThemableResources();SPThemeUtils.WithSiteTheme(g)}}typeof SPThemeUtils!="undefined"&&SPThemeUtils!=null&&SPThemeUtils.SetThemeRetriever(g)})();typeof NotifyScriptLoadedAndExecuteWaitingJobs!=="undefined"&&NotifyScriptLoadedAndExecuteWaitingJobs("SpoSuiteNav.js")